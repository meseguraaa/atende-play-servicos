{"version":3,"sources":["turbopack:///[project]/node_modules/.pnpm/next@16.0.1_@babel+core@7.28.6_react-dom@19.2.0_react@19.2.0__react@19.2.0/node_modules/next/src/client/components/redirect-status-code.ts","turbopack:///[project]/node_modules/.pnpm/next@16.0.1_@babel+core@7.28.6_react-dom@19.2.0_react@19.2.0__react@19.2.0/node_modules/next/src/client/components/redirect-error.ts","turbopack:///[project]/node_modules/.pnpm/next@16.0.1_@babel+core@7.28.6_react-dom@19.2.0_react@19.2.0__react@19.2.0/node_modules/next/src/client/components/readonly-url-search-params.ts","turbopack:///[project]/node_modules/.pnpm/next@16.0.1_@babel+core@7.28.6_react-dom@19.2.0_react@19.2.0__react@19.2.0/node_modules/next/src/client/components/redirect.ts","turbopack:///[project]/node_modules/.pnpm/next@16.0.1_@babel+core@7.28.6_react-dom@19.2.0_react@19.2.0__react@19.2.0/node_modules/next/src/client/components/http-access-fallback/http-access-fallback.ts","turbopack:///[project]/node_modules/.pnpm/next@16.0.1_@babel+core@7.28.6_react-dom@19.2.0_react@19.2.0__react@19.2.0/node_modules/next/src/client/components/not-found.ts","turbopack:///[project]/node_modules/.pnpm/next@16.0.1_@babel+core@7.28.6_react-dom@19.2.0_react@19.2.0__react@19.2.0/node_modules/next/src/client/components/forbidden.ts","turbopack:///[project]/node_modules/.pnpm/next@16.0.1_@babel+core@7.28.6_react-dom@19.2.0_react@19.2.0__react@19.2.0/node_modules/next/src/client/components/unauthorized.ts","turbopack:///[project]/node_modules/.pnpm/next@16.0.1_@babel+core@7.28.6_react-dom@19.2.0_react@19.2.0__react@19.2.0/node_modules/next/src/server/lib/router-utils/is-postpone.ts","turbopack:///[project]/node_modules/.pnpm/next@16.0.1_@babel+core@7.28.6_react-dom@19.2.0_react@19.2.0__react@19.2.0/node_modules/next/src/client/components/is-next-router-error.ts","turbopack:///[project]/node_modules/.pnpm/next@16.0.1_@babel+core@7.28.6_react-dom@19.2.0_react@19.2.0__react@19.2.0/node_modules/next/src/client/components/unstable-rethrow.server.ts","turbopack:///[project]/node_modules/.pnpm/next@16.0.1_@babel+core@7.28.6_react-dom@19.2.0_react@19.2.0__react@19.2.0/node_modules/next/src/client/components/unstable-rethrow.ts","turbopack:///[project]/node_modules/.pnpm/next@16.0.1_@babel+core@7.28.6_react-dom@19.2.0_react@19.2.0__react@19.2.0/node_modules/next/src/client/components/navigation.react-server.ts","turbopack:///[project]/node_modules/.pnpm/next@16.0.1_@babel+core@7.28.6_react-dom@19.2.0_react@19.2.0__react@19.2.0/node_modules/next/dist/api/navigation.react-server.js","turbopack:///[project]/src/lib/admin-permissions.ts","turbopack:///[project]/src/lib/plataform-permissions.ts"],"sourcesContent":["export enum RedirectStatusCode {\n  SeeOther = 303,\n  TemporaryRedirect = 307,\n  PermanentRedirect = 308,\n}\n","import { RedirectStatusCode } from './redirect-status-code'\n\nexport const REDIRECT_ERROR_CODE = 'NEXT_REDIRECT'\n\nexport enum RedirectType {\n  push = 'push',\n  replace = 'replace',\n}\n\nexport type RedirectError = Error & {\n  digest: `${typeof REDIRECT_ERROR_CODE};${RedirectType};${string};${RedirectStatusCode};`\n}\n\n/**\n * Checks an error to determine if it's an error generated by the\n * `redirect(url)` helper.\n *\n * @param error the error that may reference a redirect error\n * @returns true if the error is a redirect error\n */\nexport function isRedirectError(error: unknown): error is RedirectError {\n  if (\n    typeof error !== 'object' ||\n    error === null ||\n    !('digest' in error) ||\n    typeof error.digest !== 'string'\n  ) {\n    return false\n  }\n\n  const digest = error.digest.split(';')\n  const [errorCode, type] = digest\n  const destination = digest.slice(2, -2).join(';')\n  const status = digest.at(-2)\n\n  const statusCode = Number(status)\n\n  return (\n    errorCode === REDIRECT_ERROR_CODE &&\n    (type === 'replace' || type === 'push') &&\n    typeof destination === 'string' &&\n    !isNaN(statusCode) &&\n    statusCode in RedirectStatusCode\n  )\n}\n","/**\n * ReadonlyURLSearchParams implementation shared between client and server.\n * This file is intentionally not marked as 'use client' or 'use server'\n * so it can be imported by both environments.\n */\n\n/** @internal */\nclass ReadonlyURLSearchParamsError extends Error {\n  constructor() {\n    super(\n      'Method unavailable on `ReadonlyURLSearchParams`. Read more: https://nextjs.org/docs/app/api-reference/functions/use-search-params#updating-searchparams'\n    )\n  }\n}\n\n/**\n * A read-only version of URLSearchParams that throws errors when mutation methods are called.\n * This ensures that the URLSearchParams returned by useSearchParams() cannot be mutated.\n */\nexport class ReadonlyURLSearchParams extends URLSearchParams {\n  /** @deprecated Method unavailable on `ReadonlyURLSearchParams`. Read more: https://nextjs.org/docs/app/api-reference/functions/use-search-params#updating-searchparams */\n  append() {\n    throw new ReadonlyURLSearchParamsError()\n  }\n  /** @deprecated Method unavailable on `ReadonlyURLSearchParams`. Read more: https://nextjs.org/docs/app/api-reference/functions/use-search-params#updating-searchparams */\n  delete() {\n    throw new ReadonlyURLSearchParamsError()\n  }\n  /** @deprecated Method unavailable on `ReadonlyURLSearchParams`. Read more: https://nextjs.org/docs/app/api-reference/functions/use-search-params#updating-searchparams */\n  set() {\n    throw new ReadonlyURLSearchParamsError()\n  }\n  /** @deprecated Method unavailable on `ReadonlyURLSearchParams`. Read more: https://nextjs.org/docs/app/api-reference/functions/use-search-params#updating-searchparams */\n  sort() {\n    throw new ReadonlyURLSearchParamsError()\n  }\n}\n","import { RedirectStatusCode } from './redirect-status-code'\nimport {\n  RedirectType,\n  type RedirectError,\n  isRedirectError,\n  REDIRECT_ERROR_CODE,\n} from './redirect-error'\n\nconst actionAsyncStorage =\n  typeof window === 'undefined'\n    ? (\n        require('../../server/app-render/action-async-storage.external') as typeof import('../../server/app-render/action-async-storage.external')\n      ).actionAsyncStorage\n    : undefined\n\nexport function getRedirectError(\n  url: string,\n  type: RedirectType,\n  statusCode: RedirectStatusCode = RedirectStatusCode.TemporaryRedirect\n): RedirectError {\n  const error = new Error(REDIRECT_ERROR_CODE) as RedirectError\n  error.digest = `${REDIRECT_ERROR_CODE};${type};${url};${statusCode};`\n  return error\n}\n\n/**\n * This function allows you to redirect the user to another URL. It can be used in\n * [Server Components](https://nextjs.org/docs/app/building-your-application/rendering/server-components),\n * [Route Handlers](https://nextjs.org/docs/app/building-your-application/routing/route-handlers), and\n * [Server Actions](https://nextjs.org/docs/app/building-your-application/data-fetching/server-actions-and-mutations).\n *\n * - In a Server Component, this will insert a meta tag to redirect the user to the target page.\n * - In a Route Handler or Server Action, it will serve a 307/303 to the caller.\n * - In a Server Action, type defaults to 'push' and 'replace' elsewhere.\n *\n * Read more: [Next.js Docs: `redirect`](https://nextjs.org/docs/app/api-reference/functions/redirect)\n */\nexport function redirect(\n  /** The URL to redirect to */\n  url: string,\n  type?: RedirectType\n): never {\n  type ??= actionAsyncStorage?.getStore()?.isAction\n    ? RedirectType.push\n    : RedirectType.replace\n\n  throw getRedirectError(url, type, RedirectStatusCode.TemporaryRedirect)\n}\n\n/**\n * This function allows you to redirect the user to another URL. It can be used in\n * [Server Components](https://nextjs.org/docs/app/building-your-application/rendering/server-components),\n * [Route Handlers](https://nextjs.org/docs/app/building-your-application/routing/route-handlers), and\n * [Server Actions](https://nextjs.org/docs/app/building-your-application/data-fetching/server-actions-and-mutations).\n *\n * - In a Server Component, this will insert a meta tag to redirect the user to the target page.\n * - In a Route Handler or Server Action, it will serve a 308/303 to the caller.\n *\n * Read more: [Next.js Docs: `redirect`](https://nextjs.org/docs/app/api-reference/functions/redirect)\n */\nexport function permanentRedirect(\n  /** The URL to redirect to */\n  url: string,\n  type: RedirectType = RedirectType.replace\n): never {\n  throw getRedirectError(url, type, RedirectStatusCode.PermanentRedirect)\n}\n\n/**\n * Returns the encoded URL from the error if it's a RedirectError, null\n * otherwise. Note that this does not validate the URL returned.\n *\n * @param error the error that may be a redirect error\n * @return the url if the error was a redirect error\n */\nexport function getURLFromRedirectError(error: RedirectError): string\nexport function getURLFromRedirectError(error: unknown): string | null {\n  if (!isRedirectError(error)) return null\n\n  // Slices off the beginning of the digest that contains the code and the\n  // separating ';'.\n  return error.digest.split(';').slice(2, -2).join(';')\n}\n\nexport function getRedirectTypeFromError(error: RedirectError): RedirectType {\n  if (!isRedirectError(error)) {\n    throw new Error('Not a redirect error')\n  }\n\n  return error.digest.split(';', 2)[1] as RedirectType\n}\n\nexport function getRedirectStatusCodeFromError(error: RedirectError): number {\n  if (!isRedirectError(error)) {\n    throw new Error('Not a redirect error')\n  }\n\n  return Number(error.digest.split(';').at(-2))\n}\n","export const HTTPAccessErrorStatus = {\n  NOT_FOUND: 404,\n  FORBIDDEN: 403,\n  UNAUTHORIZED: 401,\n}\n\nconst ALLOWED_CODES = new Set(Object.values(HTTPAccessErrorStatus))\n\nexport const HTTP_ERROR_FALLBACK_ERROR_CODE = 'NEXT_HTTP_ERROR_FALLBACK'\n\nexport type HTTPAccessFallbackError = Error & {\n  digest: `${typeof HTTP_ERROR_FALLBACK_ERROR_CODE};${string}`\n}\n\n/**\n * Checks an error to determine if it's an error generated by\n * the HTTP navigation APIs `notFound()`, `forbidden()` or `unauthorized()`.\n *\n * @param error the error that may reference a HTTP access error\n * @returns true if the error is a HTTP access error\n */\nexport function isHTTPAccessFallbackError(\n  error: unknown\n): error is HTTPAccessFallbackError {\n  if (\n    typeof error !== 'object' ||\n    error === null ||\n    !('digest' in error) ||\n    typeof error.digest !== 'string'\n  ) {\n    return false\n  }\n  const [prefix, httpStatus] = error.digest.split(';')\n\n  return (\n    prefix === HTTP_ERROR_FALLBACK_ERROR_CODE &&\n    ALLOWED_CODES.has(Number(httpStatus))\n  )\n}\n\nexport function getAccessFallbackHTTPStatus(\n  error: HTTPAccessFallbackError\n): number {\n  const httpStatus = error.digest.split(';')[1]\n  return Number(httpStatus)\n}\n\nexport function getAccessFallbackErrorTypeByStatus(\n  status: number\n): 'not-found' | 'forbidden' | 'unauthorized' | undefined {\n  switch (status) {\n    case 401:\n      return 'unauthorized'\n    case 403:\n      return 'forbidden'\n    case 404:\n      return 'not-found'\n    default:\n      return\n  }\n}\n","import {\n  HTTP_ERROR_FALLBACK_ERROR_CODE,\n  type HTTPAccessFallbackError,\n} from './http-access-fallback/http-access-fallback'\n\n/**\n * This function allows you to render the [not-found.js file](https://nextjs.org/docs/app/api-reference/file-conventions/not-found)\n * within a route segment as well as inject a tag.\n *\n * `notFound()` can be used in\n * [Server Components](https://nextjs.org/docs/app/building-your-application/rendering/server-components),\n * [Route Handlers](https://nextjs.org/docs/app/building-your-application/routing/route-handlers), and\n * [Server Actions](https://nextjs.org/docs/app/building-your-application/data-fetching/server-actions-and-mutations).\n *\n * - In a Server Component, this will insert a `<meta name=\"robots\" content=\"noindex\" />` meta tag and set the status code to 404.\n * - In a Route Handler or Server Action, it will serve a 404 to the caller.\n *\n * Read more: [Next.js Docs: `notFound`](https://nextjs.org/docs/app/api-reference/functions/not-found)\n */\n\nconst DIGEST = `${HTTP_ERROR_FALLBACK_ERROR_CODE};404`\n\nexport function notFound(): never {\n  const error = new Error(DIGEST) as HTTPAccessFallbackError\n  ;(error as HTTPAccessFallbackError).digest = DIGEST\n\n  throw error\n}\n","import {\n  HTTP_ERROR_FALLBACK_ERROR_CODE,\n  type HTTPAccessFallbackError,\n} from './http-access-fallback/http-access-fallback'\n\n// TODO: Add `forbidden` docs\n/**\n * @experimental\n * This function allows you to render the [forbidden.js file](https://nextjs.org/docs/app/api-reference/file-conventions/forbidden)\n * within a route segment as well as inject a tag.\n *\n * `forbidden()` can be used in\n * [Server Components](https://nextjs.org/docs/app/building-your-application/rendering/server-components),\n * [Route Handlers](https://nextjs.org/docs/app/building-your-application/routing/route-handlers), and\n * [Server Actions](https://nextjs.org/docs/app/building-your-application/data-fetching/server-actions-and-mutations).\n *\n * Read more: [Next.js Docs: `forbidden`](https://nextjs.org/docs/app/api-reference/functions/forbidden)\n */\n\nconst DIGEST = `${HTTP_ERROR_FALLBACK_ERROR_CODE};403`\n\nexport function forbidden(): never {\n  if (!process.env.__NEXT_EXPERIMENTAL_AUTH_INTERRUPTS) {\n    throw new Error(\n      `\\`forbidden()\\` is experimental and only allowed to be enabled when \\`experimental.authInterrupts\\` is enabled.`\n    )\n  }\n\n  const error = new Error(DIGEST) as HTTPAccessFallbackError\n  ;(error as HTTPAccessFallbackError).digest = DIGEST\n  throw error\n}\n","import {\n  HTTP_ERROR_FALLBACK_ERROR_CODE,\n  type HTTPAccessFallbackError,\n} from './http-access-fallback/http-access-fallback'\n\n// TODO: Add `unauthorized` docs\n/**\n * @experimental\n * This function allows you to render the [unauthorized.js file](https://nextjs.org/docs/app/api-reference/file-conventions/unauthorized)\n * within a route segment as well as inject a tag.\n *\n * `unauthorized()` can be used in\n * [Server Components](https://nextjs.org/docs/app/building-your-application/rendering/server-components),\n * [Route Handlers](https://nextjs.org/docs/app/building-your-application/routing/route-handlers), and\n * [Server Actions](https://nextjs.org/docs/app/building-your-application/data-fetching/server-actions-and-mutations).\n *\n *\n * Read more: [Next.js Docs: `unauthorized`](https://nextjs.org/docs/app/api-reference/functions/unauthorized)\n */\n\nconst DIGEST = `${HTTP_ERROR_FALLBACK_ERROR_CODE};401`\n\nexport function unauthorized(): never {\n  if (!process.env.__NEXT_EXPERIMENTAL_AUTH_INTERRUPTS) {\n    throw new Error(\n      `\\`unauthorized()\\` is experimental and only allowed to be used when \\`experimental.authInterrupts\\` is enabled.`\n    )\n  }\n\n  const error = new Error(DIGEST) as HTTPAccessFallbackError\n  ;(error as HTTPAccessFallbackError).digest = DIGEST\n  throw error\n}\n","const REACT_POSTPONE_TYPE: symbol = Symbol.for('react.postpone')\n\nexport function isPostpone(error: any): boolean {\n  return (\n    typeof error === 'object' &&\n    error !== null &&\n    error.$$typeof === REACT_POSTPONE_TYPE\n  )\n}\n","import {\n  isHTTPAccessFallbackError,\n  type HTTPAccessFallbackError,\n} from './http-access-fallback/http-access-fallback'\nimport { isRedirectError, type RedirectError } from './redirect-error'\n\n/**\n * Returns true if the error is a navigation signal error. These errors are\n * thrown by user code to perform navigation operations and interrupt the React\n * render.\n */\nexport function isNextRouterError(\n  error: unknown\n): error is RedirectError | HTTPAccessFallbackError {\n  return isRedirectError(error) || isHTTPAccessFallbackError(error)\n}\n","import { isHangingPromiseRejectionError } from '../../server/dynamic-rendering-utils'\nimport { isPostpone } from '../../server/lib/router-utils/is-postpone'\nimport { isBailoutToCSRError } from '../../shared/lib/lazy-dynamic/bailout-to-csr'\nimport { isNextRouterError } from './is-next-router-error'\nimport {\n  isDynamicPostpone,\n  isPrerenderInterruptedError,\n} from '../../server/app-render/dynamic-rendering'\nimport { isDynamicServerError } from './hooks-server-context'\n\nexport function unstable_rethrow(error: unknown): void {\n  if (\n    isNextRouterError(error) ||\n    isBailoutToCSRError(error) ||\n    isDynamicServerError(error) ||\n    isDynamicPostpone(error) ||\n    isPostpone(error) ||\n    isHangingPromiseRejectionError(error) ||\n    isPrerenderInterruptedError(error)\n  ) {\n    throw error\n  }\n\n  if (error instanceof Error && 'cause' in error) {\n    unstable_rethrow(error.cause)\n  }\n}\n","/**\n * This function should be used to rethrow internal Next.js errors so that they can be handled by the framework.\n * When wrapping an API that uses errors to interrupt control flow, you should use this function before you do any error handling.\n * This function will rethrow the error if it is a Next.js error so it can be handled, otherwise it will do nothing.\n *\n * Read more: [Next.js Docs: `unstable_rethrow`](https://nextjs.org/docs/app/api-reference/functions/unstable_rethrow)\n */\nexport const unstable_rethrow =\n  typeof window === 'undefined'\n    ? (\n        require('./unstable-rethrow.server') as typeof import('./unstable-rethrow.server')\n      ).unstable_rethrow\n    : (\n        require('./unstable-rethrow.browser') as typeof import('./unstable-rethrow.browser')\n      ).unstable_rethrow\n","import { ReadonlyURLSearchParams } from './readonly-url-search-params'\n\nexport function unstable_isUnrecognizedActionError(): boolean {\n  throw new Error(\n    '`unstable_isUnrecognizedActionError` can only be used on the client.'\n  )\n}\n\nexport { redirect, permanentRedirect } from './redirect'\nexport { RedirectType } from './redirect-error'\nexport { notFound } from './not-found'\nexport { forbidden } from './forbidden'\nexport { unauthorized } from './unauthorized'\nexport { unstable_rethrow } from './unstable-rethrow'\nexport { ReadonlyURLSearchParams }\n","export * from '../client/components/navigation.react-server';\n\n//# sourceMappingURL=navigation.react-server.js.map","// src/lib/admin-permissions.ts\nimport { redirect } from 'next/navigation';\nimport { NextResponse } from 'next/server';\nimport { prisma } from '@/lib/prisma';\nimport { getCurrentPainelUser } from '@/lib/painel-session';\n\n/* =========================================================\n * Admin (Tenant)\n * ========================================================= */\n\nexport type AdminModule =\n    | 'DASHBOARD'\n    | 'REPORTS'\n    | 'CHECKOUT'\n    | 'APPOINTMENTS'\n    | 'PROFESSIONALS'\n    | 'SERVICES'\n    | 'REVIEWS'\n    | 'PRODUCTS'\n    | 'PARTNERS'\n    | 'CLIENTS'\n    | 'CLIENT_LEVELS'\n    | 'FINANCE'\n    | 'SETTINGS';\n\nexport type AdminSession = {\n    id: string;\n    name: string | null;\n    email: string;\n    role: 'ADMIN';\n    isOwner: boolean;\n    companyId: string;\n\n    // ✅ Multi-unidade fica para depois\n    unitId: null;\n\n    // ✅ Multi-unidade fica para depois (por enquanto sempre true pro owner e false pro resto)\n    canSeeAllUnits: boolean;\n};\n\ntype AdminAccessFlag =\n    | 'canAccessDashboard'\n    | 'canAccessReports'\n    | 'canAccessCheckout'\n    | 'canAccessAppointments'\n    | 'canAccessProfessionals'\n    | 'canAccessServices'\n    | 'canAccessReviews'\n    | 'canAccessProducts'\n    | 'canAccessPartners'\n    | 'canAccessClients'\n    | 'canAccessClientLevels'\n    | 'canAccessFinance'\n    | 'canAccessSettings';\n\ntype AdminAccessSelect = Record<AdminAccessFlag, true>;\nconst ADMIN_ACCESS_SELECT: AdminAccessSelect = {\n    canAccessDashboard: true,\n    canAccessReports: true,\n    canAccessCheckout: true,\n    canAccessAppointments: true,\n    canAccessProfessionals: true,\n    canAccessServices: true,\n    canAccessReviews: true,\n    canAccessProducts: true,\n    canAccessPartners: true,\n    canAccessClients: true,\n    canAccessClientLevels: true,\n    canAccessFinance: true,\n    canAccessSettings: true,\n};\n\nfunction moduleToAccessField(module: AdminModule): AdminAccessFlag | null {\n    switch (module) {\n        case 'DASHBOARD':\n            return 'canAccessDashboard';\n        case 'REPORTS':\n            return 'canAccessReports';\n        case 'CHECKOUT':\n            return 'canAccessCheckout';\n        case 'APPOINTMENTS':\n            return 'canAccessAppointments';\n        case 'PROFESSIONALS':\n            return 'canAccessProfessionals';\n        case 'SERVICES':\n            return 'canAccessServices';\n        case 'REVIEWS':\n            return 'canAccessReviews';\n        case 'PRODUCTS':\n            return 'canAccessProducts';\n\n        // ✅ IMPORTANTE:\n        // Parceiros saiu do ADMIN (tenant) e agora pertence somente à PLATAFORMA.\n        // Ao retornar null, o guard força redirect para o primeiro módulo permitido.\n        case 'PARTNERS':\n            return null;\n\n        case 'CLIENTS':\n            return 'canAccessClients';\n        case 'CLIENT_LEVELS':\n            return 'canAccessClientLevels';\n        case 'FINANCE':\n            return 'canAccessFinance';\n        case 'SETTINGS':\n            return 'canAccessSettings';\n        default:\n            return null;\n    }\n}\n\ntype AdminContext = {\n    id: string;\n    name: string | null;\n    email: string;\n    companyId: string;\n    isOwner: boolean;\n};\n\ntype AdminContextResult =\n    | { ok: true; ctx: AdminContext }\n    | {\n          ok: false;\n          reason:\n              | 'no_session'\n              | 'not_admin'\n              | 'invalid_token'\n              | 'user_inactive'\n              | 'no_membership'\n              | 'no_access';\n      };\n\ntype AdminContextFailureReason = Extract<\n    AdminContextResult,\n    { ok: false }\n>['reason'];\n\nasync function getAdminContext(): Promise<AdminContextResult> {\n    const session = await getCurrentPainelUser();\n\n    if (!session) return { ok: false, reason: 'no_session' };\n\n    // ✅ IMPORTANTE: aqui é TENANT ADMIN apenas\n    if (session.role !== 'ADMIN') return { ok: false, reason: 'not_admin' };\n\n    const userId = String((session as any).sub || '').trim();\n    const companyId = String((session as any).companyId || '').trim();\n\n    if (!userId || !companyId) return { ok: false, reason: 'invalid_token' };\n\n    const user = await prisma.user.findUnique({\n        where: { id: userId },\n        select: { id: true, name: true, email: true, isActive: true },\n    });\n\n    if (!user?.id || !user.isActive) {\n        return { ok: false, reason: 'user_inactive' };\n    }\n\n    const membership = await prisma.companyMember.findFirst({\n        where: {\n            userId,\n            companyId,\n            isActive: true,\n            role: { in: ['OWNER', 'ADMIN'] },\n        },\n        select: { role: true },\n    });\n\n    if (!membership?.role) return { ok: false, reason: 'no_membership' };\n\n    const isOwner = membership.role === 'OWNER';\n\n    // ✅ Sub-admin precisa existir em AdminAccess (OWNER não precisa)\n    if (!isOwner) {\n        const accessExists = await prisma.adminAccess.findFirst({\n            where: { userId, companyId },\n            select: { id: true },\n        });\n\n        if (!accessExists?.id) return { ok: false, reason: 'no_access' };\n    }\n\n    return {\n        ok: true,\n        ctx: {\n            id: user.id,\n            name: user.name ?? null,\n            email: user.email,\n            companyId,\n            isOwner,\n        },\n    };\n}\n\nfunction redirectToLoginByReason(reason: AdminContextFailureReason): never {\n    switch (reason) {\n        case 'no_session':\n            redirect('/painel/login?error=credenciais');\n        case 'not_admin':\n            redirect('/painel/login?error=permissao');\n        case 'invalid_token':\n        case 'user_inactive':\n        case 'no_membership':\n        case 'no_access':\n        default:\n            redirect('/painel/login?error=permissao');\n    }\n}\n\ntype ModuleRoute = { module: AdminModule; href: string };\n\n/**\n * ✅ Ordem de “melhor destino” quando falta permissão.\n *\n * Mantemos DASHBOARD por último (se for o único liberado, vira fallback final).\n * O restante segue a ordem do menu que você pediu.\n */\nconst FALLBACK_ROUTES: ModuleRoute[] = [\n    { module: 'APPOINTMENTS', href: '/admin/appointments' },\n    { module: 'CHECKOUT', href: '/admin/checkout' },\n    {\n        module: 'PROFESSIONALS',\n        // ✅ FIX: rota correta (plural)\n        href: '/admin/professionals',\n    },\n    { module: 'SERVICES', href: '/admin/services' },\n    { module: 'PRODUCTS', href: '/admin/products' },\n\n    // ✅ PARTNERS REMOVIDO do fallback (agora é somente da PLATAFORMA)\n\n    { module: 'CLIENTS', href: '/admin/clients' },\n    { module: 'CLIENT_LEVELS', href: '/admin/client-levels' },\n    { module: 'REVIEWS', href: '/admin/review-tags' },\n    { module: 'REPORTS', href: '/admin/reports' },\n    { module: 'FINANCE', href: '/admin/finance' },\n    { module: 'SETTINGS', href: '/admin/setting' },\n    // deixa dashboard por último\n    { module: 'DASHBOARD', href: '/admin/dashboard' },\n];\n\nfunction pickFirstAllowedHref(\n    access: Record<string, any> | null\n): string | null {\n    if (!access) return null;\n\n    for (const r of FALLBACK_ROUTES) {\n        const flag = moduleToAccessField(r.module);\n        if (!flag) continue;\n        if (Boolean((access as any)[flag])) return r.href;\n    }\n\n    return null;\n}\n\nasync function redirectToFirstAllowedOrLogin(params: {\n    companyId: string;\n    userId: string;\n}): Promise<never> {\n    const access = await prisma.adminAccess.findFirst({\n        where: { companyId: params.companyId, userId: params.userId },\n        select: ADMIN_ACCESS_SELECT,\n    });\n\n    const href = pickFirstAllowedHref(access as any);\n    if (href) {\n        redirect(`${href}?error=permissao`);\n        throw new Error('unreachable');\n    }\n\n    redirect('/painel/login?error=permissao');\n    throw new Error('unreachable');\n}\n\n/**\n * ✅ Server Components / Layouts / Pages (bloqueia com redirect)\n */\nexport async function requireAdminForModule(\n    module: AdminModule\n): Promise<AdminSession> {\n    const res = await getAdminContext();\n\n    if (!res.ok) {\n        redirectToLoginByReason(res.reason);\n    }\n\n    const ctx = res.ctx;\n\n    // OWNER: tudo liberado (mas mesmo assim, PARTNERS não existe mais no Admin)\n    if (ctx.isOwner) {\n        // ✅ Se tentarem acessar PARTNERS como admin-owner tenant, cai no redirect padrão\n        if (module === 'PARTNERS') {\n            await redirectToFirstAllowedOrLogin({\n                companyId: ctx.companyId,\n                userId: ctx.id,\n            });\n            throw new Error('unreachable');\n        }\n\n        return {\n            id: ctx.id,\n            name: ctx.name,\n            email: ctx.email,\n            role: 'ADMIN',\n            isOwner: true,\n            companyId: ctx.companyId,\n            unitId: null,\n            canSeeAllUnits: true,\n        };\n    }\n\n    const accessField = moduleToAccessField(module);\n    if (!accessField) {\n        await redirectToFirstAllowedOrLogin({\n            companyId: ctx.companyId,\n            userId: ctx.id,\n        });\n        throw new Error('unreachable');\n    }\n\n    const access = await prisma.adminAccess.findFirst({\n        where: { userId: ctx.id, companyId: ctx.companyId },\n        select: ADMIN_ACCESS_SELECT,\n    });\n\n    if (!access) {\n        await redirectToFirstAllowedOrLogin({\n            companyId: ctx.companyId,\n            userId: ctx.id,\n        });\n        throw new Error('unreachable');\n    }\n\n    const allowed = Boolean(access[accessField]);\n    if (!allowed) {\n        await redirectToFirstAllowedOrLogin({\n            companyId: ctx.companyId,\n            userId: ctx.id,\n        });\n        throw new Error('unreachable');\n    }\n\n    return {\n        id: ctx.id,\n        name: ctx.name,\n        email: ctx.email,\n        role: 'ADMIN',\n        isOwner: false,\n        companyId: ctx.companyId,\n        unitId: null,\n        canSeeAllUnits: false,\n    };\n}\n\n/**\n * ✅ Route Handlers /api (bloqueia com 403 JSON)\n *\n * Uso:\n * const res = await requireAdminForModuleApi('DASHBOARD');\n * if (res instanceof NextResponse) return res;\n * const session = res;\n */\nexport async function requireAdminForModuleApi(\n    module: AdminModule\n): Promise<AdminSession | NextResponse> {\n    const res = await getAdminContext();\n\n    if (!res.ok) {\n        return NextResponse.json(\n            { ok: false, error: 'unauthorized' },\n            { status: 401 }\n        );\n    }\n\n    const ctx = res.ctx;\n\n    if (ctx.isOwner) {\n        // ✅ trava PARTNERS também na API do Admin\n        if (module === 'PARTNERS') {\n            return NextResponse.json(\n                { ok: false, error: 'forbidden' },\n                { status: 403 }\n            );\n        }\n\n        return {\n            id: ctx.id,\n            name: ctx.name,\n            email: ctx.email,\n            role: 'ADMIN',\n            isOwner: true,\n            companyId: ctx.companyId,\n            unitId: null,\n            canSeeAllUnits: true,\n        };\n    }\n\n    const accessField = moduleToAccessField(module);\n    if (!accessField) {\n        return NextResponse.json(\n            { ok: false, error: 'forbidden' },\n            { status: 403 }\n        );\n    }\n\n    const access = await prisma.adminAccess.findFirst({\n        where: { userId: ctx.id, companyId: ctx.companyId },\n        select: ADMIN_ACCESS_SELECT,\n    });\n\n    if (!access || !Boolean(access[accessField])) {\n        const fallbackHref = pickFirstAllowedHref(access as any);\n        return NextResponse.json(\n            { ok: false, error: 'forbidden', fallback: fallbackHref },\n            { status: 403 }\n        );\n    }\n\n    return {\n        id: ctx.id,\n        name: ctx.name,\n        email: ctx.email,\n        role: 'ADMIN',\n        isOwner: false,\n        companyId: ctx.companyId,\n        unitId: null,\n        canSeeAllUnits: false,\n    };\n}\n\n/* =========================================================\n * Platform (AtendePlay)\n * ========================================================= *\n * ✅ MOVED OUT:\n * A plataforma agora vive em src/lib/platform-permissions.ts\n * Mantemos re-export aqui por compat (caso algum import antigo exista).\n */\n\nexport type {\n    PlatformModule,\n    PlatformSession,\n} from '@/lib/plataform-permissions';\nexport {\n    requirePlatformForModule,\n    requirePlatformForModuleApi,\n} from '@/lib/plataform-permissions';\n\n/**\n * Mantive esse export porque você já usou em outros pontos.\n * Implementamos de verdade quando chegar no painel do profissional.\n */\nexport async function requireProfessionalSession(): Promise<never> {\n    throw new Error(\n        'requireProfessionalSession ainda não foi implementado (não é necessário neste passo).'\n    );\n}\n","// src/lib/platform-permissions.ts\nimport { redirect } from 'next/navigation';\nimport { NextResponse } from 'next/server';\nimport { prisma } from '@/lib/prisma';\nimport { getCurrentPainelUser } from '@/lib/painel-session';\n\n/* =========================================================\n * Platform (AtendePlay)\n * ========================================================= */\n\nexport type PlatformModule =\n    | 'DASHBOARD'\n    | 'PARTNERS'\n    | 'COMPANIES'\n    | 'ANALYTICS'\n    | 'BILLING'\n    | 'SETTINGS';\n\nexport type PlatformSession = {\n    id: string;\n    name: string | null;\n    email: string;\n    role: 'PLATFORM_OWNER' | 'PLATFORM_STAFF';\n};\n\ntype PlatformContext = {\n    id: string;\n    name: string | null;\n    email: string;\n    role: PlatformSession['role'];\n};\n\ntype PlatformContextResult =\n    | { ok: true; ctx: PlatformContext }\n    | {\n          ok: false;\n          reason:\n              | 'no_session'\n              | 'not_platform'\n              | 'invalid_token'\n              | 'user_inactive';\n      };\n\ntype PlatformContextFailureReason = Extract<\n    PlatformContextResult,\n    { ok: false }\n>['reason'];\n\nasync function getPlatformContext(): Promise<PlatformContextResult> {\n    const session = await getCurrentPainelUser();\n\n    if (!session) return { ok: false, reason: 'no_session' };\n\n    const role = String((session as any).role || '').trim();\n    const isPlatform = role === 'PLATFORM_OWNER' || role === 'PLATFORM_STAFF';\n\n    if (!isPlatform) return { ok: false, reason: 'not_platform' };\n\n    const userId = String((session as any).sub || '').trim();\n    if (!userId) return { ok: false, reason: 'invalid_token' };\n\n    const user = await prisma.user.findUnique({\n        where: { id: userId },\n        select: {\n            id: true,\n            name: true,\n            email: true,\n            isActive: true,\n            role: true,\n        },\n    });\n\n    if (!user?.id || !user.isActive) {\n        return { ok: false, reason: 'user_inactive' };\n    }\n\n    // ✅ trava pelo role do banco também (não só do token)\n    const dbRole = String((user as any).role || '').trim();\n    const dbIsPlatform =\n        dbRole === 'PLATFORM_OWNER' || dbRole === 'PLATFORM_STAFF';\n\n    if (!dbIsPlatform) return { ok: false, reason: 'not_platform' };\n\n    return {\n        ok: true,\n        ctx: {\n            id: user.id,\n            name: user.name ?? null,\n            email: user.email,\n            role: dbRole as PlatformSession['role'],\n        },\n    };\n}\n\nfunction redirectToPlatformLoginByReason(\n    _reason: PlatformContextFailureReason\n): never {\n    // ✅ por enquanto reaproveita o mesmo login do painel.\n    // Depois você pode separar /plataform/login sem dor.\n    redirect('/painel/login?error=permissao');\n}\n\nfunction platformModuleAllowed(\n    session: PlatformSession,\n    module: PlatformModule\n): boolean {\n    // ✅ OWNER: tudo\n    if (session.role === 'PLATFORM_OWNER') return true;\n\n    // ✅ STAFF: por padrão não mexe em billing/config sensível\n    if (session.role === 'PLATFORM_STAFF') {\n        return module !== 'BILLING' && module !== 'SETTINGS';\n    }\n\n    return false;\n}\n\n/**\n * ✅ Server Components / Layouts / Pages (bloqueia com redirect)\n */\nexport async function requirePlatformForModule(\n    module: PlatformModule\n): Promise<PlatformSession> {\n    const res = await getPlatformContext();\n\n    if (!res.ok) {\n        redirectToPlatformLoginByReason(res.reason);\n    }\n\n    const session: PlatformSession = {\n        id: res.ctx.id,\n        name: res.ctx.name,\n        email: res.ctx.email,\n        role: res.ctx.role,\n    };\n\n    if (!platformModuleAllowed(session, module)) {\n        redirect('/painel/login?error=permissao');\n    }\n\n    return session;\n}\n\n/**\n * ✅ Route Handlers /api (bloqueia com 401/403 JSON)\n */\nexport async function requirePlatformForModuleApi(\n    module: PlatformModule\n): Promise<PlatformSession | NextResponse> {\n    const res = await getPlatformContext();\n\n    if (!res.ok) {\n        return NextResponse.json(\n            { ok: false, error: 'unauthorized' },\n            { status: 401 }\n        );\n    }\n\n    const session: PlatformSession = {\n        id: res.ctx.id,\n        name: res.ctx.name,\n        email: res.ctx.email,\n        role: res.ctx.role,\n    };\n\n    if (!platformModuleAllowed(session, module)) {\n        return NextResponse.json(\n            { ok: false, error: 'forbidden' },\n            { status: 403 }\n        );\n    }\n\n    return session;\n}\n"],"names":["RedirectStatusCode","REDIRECT_ERROR_CODE","RedirectType","isRedirectError","error","digest","split","errorCode","type","destination","slice","join","status","at","statusCode","Number","isNaN","ReadonlyURLSearchParams","ReadonlyURLSearchParamsError","Error","constructor","URLSearchParams","append","delete","set","sort","getRedirectError","getRedirectStatusCodeFromError","getRedirectTypeFromError","getURLFromRedirectError","permanentRedirect","redirect","actionAsyncStorage","window","require","undefined","url","TemporaryRedirect","getStore","isAction","push","replace","PermanentRedirect","HTTPAccessErrorStatus","HTTP_ERROR_FALLBACK_ERROR_CODE","getAccessFallbackErrorTypeByStatus","getAccessFallbackHTTPStatus","isHTTPAccessFallbackError","NOT_FOUND","FORBIDDEN","UNAUTHORIZED","ALLOWED_CODES","Set","Object","values","prefix","httpStatus","has","notFound","DIGEST","forbidden","process","env","__NEXT_EXPERIMENTAL_AUTH_INTERRUPTS","unauthorized","isPostpone","REACT_POSTPONE_TYPE","Symbol","for","$$typeof","isNextRouterError","unstable_rethrow","isBailoutToCSRError","isDynamicServerError","isDynamicPostpone","isHangingPromiseRejectionError","isPrerenderInterruptedError","cause","unstable_isUnrecognizedActionError"],"mappings":"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","ignoreList":[0,1,2,3,4,5,6,7,8,9,10,11,12,13]}