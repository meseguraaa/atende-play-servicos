module.exports=[193695,(a,b,c)=>{b.exports=a.x("next/dist/shared/lib/no-fallback-error.external.js",()=>require("next/dist/shared/lib/no-fallback-error.external.js"))},650645,a=>{a.n(a.i(827572))},262530,a=>{a.n(a.i(688848))},409171,a=>{a.n(a.i(753004))},21802,a=>{a.n(a.i(277152))},155517,a=>{a.n(a.i(298906))},444067,a=>{a.n(a.i(436102))},28792,a=>{"use strict";a.i(106878);var b=a.i(154840);a.i(330127);var c=a.i(766518),d=a.i(126918);a.i(110329);let e={canAccessDashboard:!0,canAccessReports:!0,canAccessCheckout:!0,canAccessAppointments:!0,canAccessProfessionals:!0,canAccessServices:!0,canAccessReviews:!0,canAccessProducts:!0,canAccessPartners:!0,canAccessClients:!0,canAccessClientLevels:!0,canAccessFinance:!0,canAccessSettings:!0};function f(a){switch(a){case"DASHBOARD":return"canAccessDashboard";case"REPORTS":return"canAccessReports";case"CHECKOUT":return"canAccessCheckout";case"APPOINTMENTS":return"canAccessAppointments";case"PROFESSIONALS":return"canAccessProfessionals";case"SERVICES":return"canAccessServices";case"REVIEWS":return"canAccessReviews";case"PRODUCTS":return"canAccessProducts";case"PARTNERS":default:return null;case"CLIENTS":return"canAccessClients";case"CLIENT_LEVELS":return"canAccessClientLevels";case"FINANCE":return"canAccessFinance";case"SETTINGS":return"canAccessSettings"}}async function g(){let a=await (0,d.getCurrentPainelUser)();if(!a)return{ok:!1,reason:"no_session"};if("ADMIN"!==a.role)return{ok:!1,reason:"not_admin"};let b=String(a.sub||"").trim(),e=String(a.companyId||"").trim();if(!b||!e)return{ok:!1,reason:"invalid_token"};let f=await c.prisma.user.findUnique({where:{id:b},select:{id:!0,name:!0,email:!0,isActive:!0}});if(!f?.id||!f.isActive)return{ok:!1,reason:"user_inactive"};let g=await c.prisma.companyMember.findFirst({where:{userId:b,companyId:e,isActive:!0,role:{in:["OWNER","ADMIN"]}},select:{role:!0}});if(!g?.role)return{ok:!1,reason:"no_membership"};let h="OWNER"===g.role;if(!h){let a=await c.prisma.adminAccess.findFirst({where:{userId:b,companyId:e},select:{id:!0}});if(!a?.id)return{ok:!1,reason:"no_access"}}return{ok:!0,ctx:{id:f.id,name:f.name??null,email:f.email,companyId:e,isOwner:h}}}let h=[{module:"APPOINTMENTS",href:"/admin/appointments"},{module:"CHECKOUT",href:"/admin/checkout"},{module:"PROFESSIONALS",href:"/admin/professionals"},{module:"SERVICES",href:"/admin/services"},{module:"PRODUCTS",href:"/admin/products"},{module:"CLIENTS",href:"/admin/clients"},{module:"CLIENT_LEVELS",href:"/admin/client-levels"},{module:"REVIEWS",href:"/admin/review-tags"},{module:"REPORTS",href:"/admin/reports"},{module:"FINANCE",href:"/admin/finance"},{module:"SETTINGS",href:"/admin/setting"},{module:"DASHBOARD",href:"/admin/dashboard"}];async function i(a){let d=function(a){if(!a)return null;for(let b of h){let c=f(b.module);if(c&&a[c])return b.href}return null}(await c.prisma.adminAccess.findFirst({where:{companyId:a.companyId,userId:a.userId},select:e}));if(d)throw(0,b.redirect)(`${d}?error=permissao`),Error("unreachable");throw(0,b.redirect)("/painel/login?error=permissao"),Error("unreachable")}async function j(a){let d=await g();d.ok||function(a){switch(a){case"no_session":(0,b.redirect)("/painel/login?error=credenciais");case"not_admin":(0,b.redirect)("/painel/login?error=permissao");default:(0,b.redirect)("/painel/login?error=permissao")}}(d.reason);let h=d.ctx;if(h.isOwner){if("PARTNERS"===a)throw await i({companyId:h.companyId,userId:h.id}),Error("unreachable");return{id:h.id,name:h.name,email:h.email,role:"ADMIN",isOwner:!0,companyId:h.companyId,unitId:null,canSeeAllUnits:!0}}let j=f(a);if(!j)throw await i({companyId:h.companyId,userId:h.id}),Error("unreachable");let k=await c.prisma.adminAccess.findFirst({where:{userId:h.id,companyId:h.companyId},select:e});if(!k||!k[j])throw await i({companyId:h.companyId,userId:h.id}),Error("unreachable");return{id:h.id,name:h.name,email:h.email,role:"ADMIN",isOwner:!1,companyId:h.companyId,unitId:null,canSeeAllUnits:!1}}a.s(["requireAdminForModule",()=>j])},725472,a=>{"use strict";let b=(0,a.i(976286).registerClientReference)(function(){throw Error("Attempted to call ProductRow() from the server but ProductRow is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/src/components/admin/products/product-row/product-row.tsx <module evaluation>","ProductRow");a.s(["ProductRow",0,b])},503219,a=>{"use strict";let b=(0,a.i(976286).registerClientReference)(function(){throw Error("Attempted to call ProductRow() from the server but ProductRow is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/src/components/admin/products/product-row/product-row.tsx","ProductRow");a.s(["ProductRow",0,b])},785117,a=>{"use strict";a.i(725472);var b=a.i(503219);a.n(b)},766541,a=>{"use strict";let b=(0,a.i(976286).registerClientReference)(function(){throw Error("Attempted to call ProductNewDialog() from the server but ProductNewDialog is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/src/components/admin/products/product-new-dialog/product-new-dialog.tsx <module evaluation>","ProductNewDialog");a.s(["ProductNewDialog",0,b])},78231,a=>{"use strict";let b=(0,a.i(976286).registerClientReference)(function(){throw Error("Attempted to call ProductNewDialog() from the server but ProductNewDialog is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/src/components/admin/products/product-new-dialog/product-new-dialog.tsx","ProductNewDialog");a.s(["ProductNewDialog",0,b])},373042,a=>{"use strict";a.i(766541);var b=a.i(78231);a.n(b)},749712,a=>{"use strict";var b=a.i(623127),c=a.i(169513),d=a.i(28792),e=a.i(785117),f=a.i(373042);async function g(){var a;let g,h;await (0,d.requireAdminForModule)("PRODUCTS");let i=(g=(a=await (0,c.headers)()).get("x-forwarded-host")??a.get("host"),h=a.get("x-forwarded-proto")??"http",g?`${h}://${g}`:null),j=(await (0,c.cookies)()).getAll().map(a=>`${a.name}=${a.value}`).join("; "),k=[],l=[];try{let a=i?`${i}/api/admin/products`:"/api/admin/products",b=await fetch(a,{method:"GET",cache:"no-store",headers:{cookie:j,accept:"application/json"}}),c=await b.json().catch(()=>null);b.ok&&c?.ok&&c.data?(k=c.data.products??[],l=c.data.units??[]):(k=[],l=[])}catch{k=[],l=[]}return(0,b.jsxs)("div",{className:"max-w-7xl space-y-6",children:[(0,b.jsxs)("header",{className:"flex items-center justify-between gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-title text-content-primary",children:"Produtos"}),(0,b.jsx)("p",{className:"text-paragraph-medium-size text-content-secondary",children:"Gerencie os produtos vendidos, estoque, categorias e comissões."})]}),(0,b.jsx)(f.ProductNewDialog,{units:l})]}),(0,b.jsx)("section",{className:"overflow-x-auto rounded-xl border border-border-primary bg-background-tertiary",children:(0,b.jsxs)("table",{className:"w-full table-fixed border-collapse text-sm",children:[(0,b.jsxs)("colgroup",{children:[(0,b.jsx)("col",{className:"w-95"}),(0,b.jsx)("col",{className:"w-55"}),(0,b.jsx)("col",{className:"w-27.5"}),(0,b.jsx)("col",{className:"w-27.5"}),(0,b.jsx)("col",{className:"w-27.5"}),(0,b.jsx)("col",{className:"w-27.5"}),(0,b.jsx)("col",{className:"w-27.5"}),(0,b.jsx)("col",{className:"w-27.5"}),(0,b.jsx)("col",{className:"w-60"})]}),(0,b.jsx)("thead",{children:(0,b.jsxs)("tr",{className:"border-b border-border-primary bg-background-secondary",children:[(0,b.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-content-secondary",children:"Produto"}),(0,b.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-content-secondary",children:"Unidade"}),(0,b.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-content-secondary",children:"Preço"}),(0,b.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-content-secondary",children:"Comissão"}),(0,b.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-content-secondary",children:"Categoria"}),(0,b.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-content-secondary",children:"Estoque"}),(0,b.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-content-secondary",children:"Prazo"}),(0,b.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-content-secondary",children:"Status"}),(0,b.jsx)("th",{className:"px-4 py-3 text-right text-xs font-medium text-content-secondary",children:"Ações"})]})}),(0,b.jsx)("tbody",{className:"[&>tr>td]:align-middle",children:0===k.length?(0,b.jsx)("tr",{className:"border-t border-border-primary",children:(0,b.jsx)("td",{colSpan:9,className:"px-4 py-6 text-center text-paragraph-small text-content-secondary",children:"Nenhum produto cadastrado ainda."})}):k.map(a=>(0,b.jsx)(e.ProductRow,{product:a},a.id))})]})})]})}a.s(["default",()=>g,"dynamic",0,"force-dynamic","metadata",0,{title:"Admin | Produtos"}])}];

//# sourceMappingURL=%5Broot-of-the-server%5D__c0c9cbeb._.js.map