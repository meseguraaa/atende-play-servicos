{"version":3,"sources":["turbopack:///[project]/src/components/admin/reports/unit-filter/unit-filter.tsx","turbopack:///[project]/src/components/admin/reports/compare-with-filter/compare-with-filter.tsx"],"sourcesContent":["// components/unit-filter.tsx\n'use client';\n\nimport * as React from 'react';\nimport { useRouter } from 'next/navigation';\n\nimport {\n    Select,\n    SelectContent,\n    SelectItem,\n    SelectTrigger,\n    SelectValue,\n} from '@/components/ui/select';\n\ntype UnitOption = {\n    id: string;\n    name: string;\n};\n\ntype UnitFilterProps = {\n    units: UnitOption[];\n    value: string; // cookie value atual: \"all\" | unitId\n    label?: string;\n    cookieName?: string;\n    allValue?: string;\n};\n\nconst DEFAULT_COOKIE_NAME = 'admin_unit_context';\nconst DEFAULT_ALL_VALUE = 'all';\n\nfunction setCookie(name: string, value: string) {\n    // 1 ano, path global. (igual “contexto” em admin)\n    const maxAge = 60 * 60 * 24 * 365;\n    document.cookie = `${encodeURIComponent(name)}=${encodeURIComponent(\n        value\n    )}; Path=/; Max-Age=${maxAge}; SameSite=Lax`;\n}\n\nexport function UnitFilter({\n    units,\n    value,\n    label = 'Unidade',\n    cookieName = DEFAULT_COOKIE_NAME,\n    allValue = DEFAULT_ALL_VALUE,\n}: UnitFilterProps) {\n    const router = useRouter();\n\n    const options = React.useMemo(() => {\n        // \"Todas\" sempre em cima (pra quem pode ver tudo)\n        return [{ id: allValue, name: 'Todas' }, ...units];\n    }, [units, allValue]);\n\n    const safeValue = React.useMemo(() => {\n        if (!value) return allValue;\n        const exists = options.some((u) => u.id === value);\n        return exists ? value : allValue;\n    }, [value, options, allValue]);\n\n    return (\n        <div className=\"space-y-2\">\n            <p className=\"text-label-small text-content-secondary\">{label}</p>\n\n            <Select\n                value={safeValue}\n                onValueChange={(next) => {\n                    setCookie(cookieName, next);\n                    router.refresh();\n                }}\n            >\n                <SelectTrigger className=\"w-full\">\n                    <SelectValue placeholder=\"Selecione\" />\n                </SelectTrigger>\n\n                <SelectContent>\n                    {options.map((u) => (\n                        <SelectItem key={u.id} value={u.id}>\n                            {u.name}\n                        </SelectItem>\n                    ))}\n                </SelectContent>\n            </Select>\n        </div>\n    );\n}\n","// src/components/compare-with-filter.tsx\n'use client';\n\nimport { useMemo } from 'react';\nimport { usePathname, useRouter, useSearchParams } from 'next/navigation';\n\nimport {\n    Select,\n    SelectContent,\n    SelectItem,\n    SelectTrigger,\n    SelectValue,\n} from '@/components/ui/select';\n\ntype CompareOption = {\n    value: 'prev_month' | 'prev_year';\n    label: string;\n};\n\nconst DEFAULT_OPTIONS: CompareOption[] = [\n    { value: 'prev_month', label: 'Mês anterior' },\n    { value: 'prev_year', label: 'Mesmo mês do ano anterior' },\n];\n\nexport function CompareWithFilter({\n    value,\n    paramKey = 'compare',\n    label = 'Comparar com',\n    options = DEFAULT_OPTIONS,\n}: {\n    value?: 'prev_month' | 'prev_year' | null;\n    paramKey?: string;\n    label?: string;\n    options?: CompareOption[];\n}) {\n    const router = useRouter();\n    const pathname = usePathname();\n    const searchParams = useSearchParams();\n\n    const selected = useMemo(() => {\n        const safe = options.some((o) => o.value === value) ? value : null;\n        return safe ?? 'prev_month'; // ✅ default: mês anterior\n    }, [options, value]);\n\n    function setParam(nextValue: 'prev_month' | 'prev_year') {\n        const params = new URLSearchParams(searchParams?.toString());\n\n        params.set(paramKey, nextValue);\n\n        // ✅ reset opcional (se um dia fizer sentido):\n        // params.delete(\"page\");\n\n        const qs = params.toString();\n        router.push(qs ? `${pathname}?${qs}` : pathname);\n    }\n\n    return (\n        <div className=\"space-y-2\">\n            <p className=\"text-label-small text-content-secondary\">{label}</p>\n\n            <Select value={selected} onValueChange={(v) => setParam(v as any)}>\n                <SelectTrigger className=\"h-12 min-h-12 py-2\">\n                    <SelectValue placeholder=\"Selecione\" />\n                </SelectTrigger>\n\n                <SelectContent>\n                    {options.map((o) => (\n                        <SelectItem key={o.value} value={o.value}>\n                            {o.label}\n                        </SelectItem>\n                    ))}\n                </SelectContent>\n            </Select>\n        </div>\n    );\n}\n"],"names":[],"mappings":"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"}