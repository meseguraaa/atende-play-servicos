{"version":3,"sources":["turbopack:///[project]/src/components/plataform/partners/partner-row/partner-row.tsx/__nextjs-internal-proxy.mjs","turbopack:///[project]/src/components/plataform/partners/partner-new-dialog/partner-new-dialog.tsx/__nextjs-internal-proxy.mjs","turbopack:///[project]/src/app/plataform/partners/page.tsx"],"sourcesContent":["// This file is generated by next-core EcmascriptClientReferenceModule.\nimport { registerClientReference } from \"react-server-dom-turbopack/server\";\nexport const PartnerRow = registerClientReference(\n    function() { throw new Error(\"Attempted to call PartnerRow() from the server but PartnerRow is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/src/components/plataform/partners/partner-row/partner-row.tsx\",\n    \"PartnerRow\",\n);\n","// This file is generated by next-core EcmascriptClientReferenceModule.\nimport { registerClientReference } from \"react-server-dom-turbopack/server\";\nexport const PartnerNewDialog = registerClientReference(\n    function() { throw new Error(\"Attempted to call PartnerNewDialog() from the server but PartnerNewDialog is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/src/components/plataform/partners/partner-new-dialog/partner-new-dialog.tsx\",\n    \"PartnerNewDialog\",\n);\n","// src/app/platform/partners/page.tsx\nimport type { Metadata } from 'next';\nimport { headers, cookies } from 'next/headers';\n\nimport { requirePlatformForModule } from '@/lib/plataform-permissions';\n\nimport { PartnerRow } from '@/components/plataform/partners/partner-row/partner-row';\nimport { PartnerNewDialog } from '@/components/plataform/partners/partner-new-dialog/partner-new-dialog';\n\nexport const dynamic = 'force-dynamic';\n\nexport const metadata: Metadata = {\n    title: 'Plataforma | Parceiros',\n};\n\nexport type PartnerForRow = {\n    id: string;\n    name: string;\n\n    logoUrl: string | null;\n    logoKey: string | null;\n\n    discountPct: number;\n\n    description: string | null;\n    rules: string | null;\n\n    ctaUrl: string | null;\n    ctaLabel: string | null;\n\n    isActive: boolean;\n    visibilityMode: 'ALL' | 'SELECTED';\n    sortOrder: number;\n\n    createdAt?: string | Date;\n    updatedAt?: string | Date;\n};\n\ntype PartnersApiResponse = {\n    ok: boolean;\n    data?: { partners: PartnerForRow[] };\n    error?: string;\n};\n\n// ✅ Tipagem compatível com o ReadonlyHeaders do Next\nfunction getBaseUrlFromHeaders(h: { get(name: string): string | null }) {\n    const host = h.get('x-forwarded-host') ?? h.get('host');\n    const proto = h.get('x-forwarded-proto') ?? 'http';\n    if (!host) return null;\n    return `${proto}://${host}`;\n}\n\nexport default async function PlatformPartnersPage() {\n    // ✅ Plataforma: acesso controlado pelo seu perfil ATENDEPLAY\n    await requirePlatformForModule('PARTNERS');\n\n    // ✅ No seu Next: headers() e cookies() são Promise\n    const h = await headers();\n    const baseUrl = getBaseUrlFromHeaders(h);\n\n    const cookieStore = await cookies();\n    const cookieHeader = cookieStore\n        .getAll()\n        .map((c: { name: string; value: string }) => `${c.name}=${c.value}`)\n        .join('; ');\n\n    let partners: PartnerForRow[] = [];\n\n    try {\n        const url = baseUrl\n            ? `${baseUrl}/api/plataform/partners`\n            : '/api/plataform/partners';\n\n        const res = await fetch(url, {\n            method: 'GET',\n            cache: 'no-store',\n            headers: {\n                accept: 'application/json',\n                cookie: cookieHeader,\n            },\n        });\n\n        const json = (await res\n            .json()\n            .catch(() => null)) as PartnersApiResponse | null;\n\n        if (res.ok && json?.ok && json.data) {\n            partners = json.data.partners ?? [];\n        } else {\n            partners = [];\n        }\n    } catch {\n        partners = [];\n    }\n\n    return (\n        <div className=\"max-w-7xl space-y-6\">\n            <header className=\"flex items-center justify-between gap-4\">\n                <div>\n                    <h1 className=\"text-title text-content-primary\">\n                        Parceiros\n                    </h1>\n                    <p className=\"text-paragraph-medium-size text-content-secondary\">\n                        Cadastre parceiros, descontos e links para abrir no app.\n                    </p>\n                </div>\n\n                <PartnerNewDialog />\n            </header>\n\n            <section className=\"overflow-x-auto rounded-xl border border-border-primary bg-background-tertiary\">\n                <table className=\"w-full table-fixed border-collapse text-sm\">\n                    <colgroup>\n                        <col className=\"w-95\" />\n                        <col className=\"w-40\" />\n                        <col className=\"w-40\" />\n                        <col className=\"w-40\" />\n                        <col className=\"w-40\" />\n                        <col className=\"w-60\" />\n                    </colgroup>\n\n                    <thead>\n                        <tr className=\"border-b border-border-primary bg-background-secondary\">\n                            <th className=\"px-4 py-3 text-left text-xs font-medium text-content-secondary\">\n                                Parceiro\n                            </th>\n                            <th className=\"px-4 py-3 text-left text-xs font-medium text-content-secondary\">\n                                Desconto\n                            </th>\n                            <th className=\"px-4 py-3 text-left text-xs font-medium text-content-secondary\">\n                                Visibilidade\n                            </th>\n                            <th className=\"px-4 py-3 text-left text-xs font-medium text-content-secondary\">\n                                Ordem\n                            </th>\n                            <th className=\"px-4 py-3 text-left text-xs font-medium text-content-secondary\">\n                                Status\n                            </th>\n                            <th className=\"px-4 py-3 text-right text-xs font-medium text-content-secondary\">\n                                Ações\n                            </th>\n                        </tr>\n                    </thead>\n\n                    <tbody className=\"[&>tr>td]:align-middle\">\n                        {partners.length === 0 ? (\n                            <tr className=\"border-t border-border-primary\">\n                                <td\n                                    colSpan={6}\n                                    className=\"px-4 py-6 text-center text-paragraph-small text-content-secondary\"\n                                >\n                                    Nenhum parceiro cadastrado ainda.\n                                </td>\n                            </tr>\n                        ) : (\n                            partners.map((partner) => (\n                                <PartnerRow\n                                    key={partner.id}\n                                    partner={partner}\n                                />\n                            ))\n                        )}\n                    </tbody>\n                </table>\n            </section>\n        </div>\n    );\n}\n"],"names":[],"mappings":"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","ignoreList":[0,1]}