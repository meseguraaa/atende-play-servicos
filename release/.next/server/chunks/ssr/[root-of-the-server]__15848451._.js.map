{"version":3,"sources":["turbopack:///[project]/src/lib/prisma.ts","turbopack:///[project]/node_modules/.pnpm/date-fns@4.1.0/node_modules/date-fns/constants.js","turbopack:///[project]/node_modules/.pnpm/date-fns@4.1.0/node_modules/date-fns/constructFrom.js","turbopack:///[project]/node_modules/.pnpm/date-fns@4.1.0/node_modules/date-fns/toDate.js","turbopack:///[project]/node_modules/.pnpm/date-fns@4.1.0/node_modules/date-fns/endOfMonth.js","turbopack:///[project]/node_modules/.pnpm/date-fns@4.1.0/node_modules/date-fns/startOfMonth.js","turbopack:///[project]/src/components/date-picker/date-picker.tsx/__nextjs-internal-proxy.mjs","turbopack:///[project]/src/components/date-picker/index.ts","turbopack:///[project]/src/lib/professional-permissions.ts","turbopack:///[project]/src/app/professional/dashboard/professional-appointments-client.tsx/__nextjs-internal-proxy.mjs","turbopack:///[project]/src/app/professional/dashboard/page.tsx"],"sourcesContent":["// src/lib/prisma.ts\nimport { PrismaClient } from '@prisma/client';\n\nconst globalForPrisma = globalThis as unknown as {\n    prisma: PrismaClient | undefined;\n};\n\nexport const prisma =\n    globalForPrisma.prisma ??\n    new PrismaClient({\n        log:\n            process.env.NODE_ENV === 'development'\n                ? ['error', 'warn']\n                : ['error'],\n    });\n\nif (process.env.NODE_ENV !== 'production') globalForPrisma.prisma = prisma;\n","/**\n * @module constants\n * @summary Useful constants\n * @description\n * Collection of useful date constants.\n *\n * The constants could be imported from `date-fns/constants`:\n *\n * ```ts\n * import { maxTime, minTime } from \"./constants/date-fns/constants\";\n *\n * function isAllowedTime(time) {\n *   return time <= maxTime && time >= minTime;\n * }\n * ```\n */\n\n/**\n * @constant\n * @name daysInWeek\n * @summary Days in 1 week.\n */\nexport const daysInWeek = 7;\n\n/**\n * @constant\n * @name daysInYear\n * @summary Days in 1 year.\n *\n * @description\n * How many days in a year.\n *\n * One years equals 365.2425 days according to the formula:\n *\n * > Leap year occurs every 4 years, except for years that are divisible by 100 and not divisible by 400.\n * > 1 mean year = (365+1/4-1/100+1/400) days = 365.2425 days\n */\nexport const daysInYear = 365.2425;\n\n/**\n * @constant\n * @name maxTime\n * @summary Maximum allowed time.\n *\n * @example\n * import { maxTime } from \"./constants/date-fns/constants\";\n *\n * const isValid = 8640000000000001 <= maxTime;\n * //=> false\n *\n * new Date(8640000000000001);\n * //=> Invalid Date\n */\nexport const maxTime = Math.pow(10, 8) * 24 * 60 * 60 * 1000;\n\n/**\n * @constant\n * @name minTime\n * @summary Minimum allowed time.\n *\n * @example\n * import { minTime } from \"./constants/date-fns/constants\";\n *\n * const isValid = -8640000000000001 >= minTime;\n * //=> false\n *\n * new Date(-8640000000000001)\n * //=> Invalid Date\n */\nexport const minTime = -maxTime;\n\n/**\n * @constant\n * @name millisecondsInWeek\n * @summary Milliseconds in 1 week.\n */\nexport const millisecondsInWeek = 604800000;\n\n/**\n * @constant\n * @name millisecondsInDay\n * @summary Milliseconds in 1 day.\n */\nexport const millisecondsInDay = 86400000;\n\n/**\n * @constant\n * @name millisecondsInMinute\n * @summary Milliseconds in 1 minute\n */\nexport const millisecondsInMinute = 60000;\n\n/**\n * @constant\n * @name millisecondsInHour\n * @summary Milliseconds in 1 hour\n */\nexport const millisecondsInHour = 3600000;\n\n/**\n * @constant\n * @name millisecondsInSecond\n * @summary Milliseconds in 1 second\n */\nexport const millisecondsInSecond = 1000;\n\n/**\n * @constant\n * @name minutesInYear\n * @summary Minutes in 1 year.\n */\nexport const minutesInYear = 525600;\n\n/**\n * @constant\n * @name minutesInMonth\n * @summary Minutes in 1 month.\n */\nexport const minutesInMonth = 43200;\n\n/**\n * @constant\n * @name minutesInDay\n * @summary Minutes in 1 day.\n */\nexport const minutesInDay = 1440;\n\n/**\n * @constant\n * @name minutesInHour\n * @summary Minutes in 1 hour.\n */\nexport const minutesInHour = 60;\n\n/**\n * @constant\n * @name monthsInQuarter\n * @summary Months in 1 quarter.\n */\nexport const monthsInQuarter = 3;\n\n/**\n * @constant\n * @name monthsInYear\n * @summary Months in 1 year.\n */\nexport const monthsInYear = 12;\n\n/**\n * @constant\n * @name quartersInYear\n * @summary Quarters in 1 year\n */\nexport const quartersInYear = 4;\n\n/**\n * @constant\n * @name secondsInHour\n * @summary Seconds in 1 hour.\n */\nexport const secondsInHour = 3600;\n\n/**\n * @constant\n * @name secondsInMinute\n * @summary Seconds in 1 minute.\n */\nexport const secondsInMinute = 60;\n\n/**\n * @constant\n * @name secondsInDay\n * @summary Seconds in 1 day.\n */\nexport const secondsInDay = secondsInHour * 24;\n\n/**\n * @constant\n * @name secondsInWeek\n * @summary Seconds in 1 week.\n */\nexport const secondsInWeek = secondsInDay * 7;\n\n/**\n * @constant\n * @name secondsInYear\n * @summary Seconds in 1 year.\n */\nexport const secondsInYear = secondsInDay * daysInYear;\n\n/**\n * @constant\n * @name secondsInMonth\n * @summary Seconds in 1 month\n */\nexport const secondsInMonth = secondsInYear / 12;\n\n/**\n * @constant\n * @name secondsInQuarter\n * @summary Seconds in 1 quarter.\n */\nexport const secondsInQuarter = secondsInMonth * 3;\n\n/**\n * @constant\n * @name constructFromSymbol\n * @summary Symbol enabling Date extensions to inherit properties from the reference date.\n *\n * The symbol is used to enable the `constructFrom` function to construct a date\n * using a reference date and a value. It allows to transfer extra properties\n * from the reference date to the new date. It's useful for extensions like\n * [`TZDate`](https://github.com/date-fns/tz) that accept a time zone as\n * a constructor argument.\n */\nexport const constructFromSymbol = Symbol.for(\"constructDateFrom\");\n","import { constructFromSymbol } from \"./constants.js\";\n\n/**\n * @name constructFrom\n * @category Generic Helpers\n * @summary Constructs a date using the reference date and the value\n *\n * @description\n * The function constructs a new date using the constructor from the reference\n * date and the given value. It helps to build generic functions that accept\n * date extensions.\n *\n * It defaults to `Date` if the passed reference date is a number or a string.\n *\n * Starting from v3.7.0, it allows to construct a date using `[Symbol.for(\"constructDateFrom\")]`\n * enabling to transfer extra properties from the reference date to the new date.\n * It's useful for extensions like [`TZDate`](https://github.com/date-fns/tz)\n * that accept a time zone as a constructor argument.\n *\n * @typeParam DateType - The `Date` type, the function operates on. Gets inferred from passed arguments. Allows to use extensions like [`UTCDate`](https://github.com/date-fns/utc).\n *\n * @param date - The reference date to take constructor from\n * @param value - The value to create the date\n *\n * @returns Date initialized using the given date and value\n *\n * @example\n * import { constructFrom } from \"./constructFrom/date-fns\";\n *\n * // A function that clones a date preserving the original type\n * function cloneDate<DateType extends Date>(date: DateType): DateType {\n *   return constructFrom(\n *     date, // Use constructor from the given date\n *     date.getTime() // Use the date value to create a new date\n *   );\n * }\n */\nexport function constructFrom(date, value) {\n  if (typeof date === \"function\") return date(value);\n\n  if (date && typeof date === \"object\" && constructFromSymbol in date)\n    return date[constructFromSymbol](value);\n\n  if (date instanceof Date) return new date.constructor(value);\n\n  return new Date(value);\n}\n\n// Fallback for modularized imports:\nexport default constructFrom;\n","import { constructFrom } from \"./constructFrom.js\";\n\n/**\n * @name toDate\n * @category Common Helpers\n * @summary Convert the given argument to an instance of Date.\n *\n * @description\n * Convert the given argument to an instance of Date.\n *\n * If the argument is an instance of Date, the function returns its clone.\n *\n * If the argument is a number, it is treated as a timestamp.\n *\n * If the argument is none of the above, the function returns Invalid Date.\n *\n * Starting from v3.7.0, it clones a date using `[Symbol.for(\"constructDateFrom\")]`\n * enabling to transfer extra properties from the reference date to the new date.\n * It's useful for extensions like [`TZDate`](https://github.com/date-fns/tz)\n * that accept a time zone as a constructor argument.\n *\n * **Note**: *all* Date arguments passed to any *date-fns* function is processed by `toDate`.\n *\n * @typeParam DateType - The `Date` type, the function operates on. Gets inferred from passed arguments. Allows to use extensions like [`UTCDate`](https://github.com/date-fns/utc).\n * @typeParam ResultDate - The result `Date` type, it is the type returned from the context function if it is passed, or inferred from the arguments.\n *\n * @param argument - The value to convert\n *\n * @returns The parsed date in the local time zone\n *\n * @example\n * // Clone the date:\n * const result = toDate(new Date(2014, 1, 11, 11, 30, 30))\n * //=> Tue Feb 11 2014 11:30:30\n *\n * @example\n * // Convert the timestamp to date:\n * const result = toDate(1392098430000)\n * //=> Tue Feb 11 2014 11:30:30\n */\nexport function toDate(argument, context) {\n  // [TODO] Get rid of `toDate` or `constructFrom`?\n  return constructFrom(context || argument, argument);\n}\n\n// Fallback for modularized imports:\nexport default toDate;\n","import { toDate } from \"./toDate.js\";\n\n/**\n * The {@link endOfMonth} function options.\n */\n\n/**\n * @name endOfMonth\n * @category Month Helpers\n * @summary Return the end of a month for the given date.\n *\n * @description\n * Return the end of a month for the given date.\n * The result will be in the local timezone.\n *\n * @typeParam DateType - The `Date` type, the function operates on. Gets inferred from passed arguments. Allows to use extensions like [`UTCDate`](https://github.com/date-fns/utc).\n * @typeParam ResultDate - The result `Date` type, it is the type returned from the context function if it is passed, or inferred from the arguments.\n *\n * @param date - The original date\n * @param options - An object with options\n *\n * @returns The end of a month\n *\n * @example\n * // The end of a month for 2 September 2014 11:55:00:\n * const result = endOfMonth(new Date(2014, 8, 2, 11, 55, 0))\n * //=> Tue Sep 30 2014 23:59:59.999\n */\nexport function endOfMonth(date, options) {\n  const _date = toDate(date, options?.in);\n  const month = _date.getMonth();\n  _date.setFullYear(_date.getFullYear(), month + 1, 0);\n  _date.setHours(23, 59, 59, 999);\n  return _date;\n}\n\n// Fallback for modularized imports:\nexport default endOfMonth;\n","import { toDate } from \"./toDate.js\";\n\n/**\n * The {@link startOfMonth} function options.\n */\n\n/**\n * @name startOfMonth\n * @category Month Helpers\n * @summary Return the start of a month for the given date.\n *\n * @description\n * Return the start of a month for the given date. The result will be in the local timezone.\n *\n * @typeParam DateType - The `Date` type, the function operates on. Gets inferred from passed arguments.\n * Allows to use extensions like [`UTCDate`](https://github.com/date-fns/utc).\n * @typeParam ResultDate - The result `Date` type, it is the type returned from the context function if it is passed,\n * or inferred from the arguments.\n *\n * @param date - The original date\n * @param options - An object with options\n *\n * @returns The start of a month\n *\n * @example\n * // The start of a month for 2 September 2014 11:55:00:\n * const result = startOfMonth(new Date(2014, 8, 2, 11, 55, 0))\n * //=> Mon Sep 01 2014 00:00:00\n */\nexport function startOfMonth(date, options) {\n  const _date = toDate(date, options?.in);\n  _date.setDate(1);\n  _date.setHours(0, 0, 0, 0);\n  return _date;\n}\n\n// Fallback for modularized imports:\nexport default startOfMonth;\n","// This file is generated by next-core EcmascriptClientReferenceModule.\nimport { registerClientReference } from \"react-server-dom-turbopack/server\";\nexport const DatePicker = registerClientReference(\n    function() { throw new Error(\"Attempted to call DatePicker() from the server but DatePicker is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/src/components/date-picker/date-picker.tsx\",\n    \"DatePicker\",\n);\n","export * from './date-picker';\n","// src/lib/professional-permissions.ts\nimport { prisma } from '@/lib/prisma';\nimport { getCurrentPainelUser } from '@/lib/painel-session';\n\nexport type ProfessionalSession = {\n    companyId: string;\n    professionalId: string;\n    userId: string;\n\n    /**\n     * ✅ Opcional: unidade “default” (quando existe vínculo em ProfessionalUnit).\n     * Não é obrigatório para não quebrar fluxos já existentes.\n     */\n    unitId?: string;\n\n    name?: string | null;\n    email?: string;\n};\n\n/**\n * ✅ Server helper (igual ao padrão do admin):\n * - Usa getCurrentPainelUser() (JWT/cookie do painel)\n * - Valida role PROFESSIONAL\n * - Garante vínculo real do usuário com Professional (companyId + userId)\n *\n * Importante:\n * - NÃO dá redirect aqui (pra não quebrar usos em /api).\n * - Em caso de falha, retorna strings vazias e a route decide 401.\n */\nexport async function requireProfessionalSession(): Promise<ProfessionalSession> {\n    const session = await getCurrentPainelUser();\n\n    if (!session) {\n        return { companyId: '', professionalId: '', userId: '', unitId: '' };\n    }\n\n    // precisa ser PROFESSIONAL\n    if ((session as any).role !== 'PROFESSIONAL') {\n        return { companyId: '', professionalId: '', userId: '', unitId: '' };\n    }\n\n    const userId = String((session as any).sub || '').trim();\n    const companyId = String((session as any).companyId || '').trim();\n\n    if (!userId || !companyId) {\n        return { companyId: '', professionalId: '', userId: '', unitId: '' };\n    }\n\n    // busca o professional vinculado a esse userId + companyId\n    const professional = await prisma.professional.findFirst({\n        where: {\n            userId,\n            companyId,\n            isActive: true,\n        },\n        select: {\n            id: true,\n            name: true,\n            email: true,\n        },\n    });\n\n    if (!professional?.id) {\n        return { companyId: '', professionalId: '', userId, unitId: '' };\n    }\n\n    /**\n     * ✅ Unidade \"default\" (se existir vínculo em ProfessionalUnit)\n     * - Não muda comportamento existente (só adiciona dado)\n     * - Útil para telas que precisem filtrar por unidade sem exigir parâmetro\n     */\n    const professionalUnit = await prisma.professionalUnit.findFirst({\n        where: {\n            companyId,\n            professionalId: professional.id,\n            isActive: true,\n        },\n        select: {\n            unitId: true,\n        },\n        orderBy: {\n            updatedAt: 'desc',\n        },\n    });\n\n    return {\n        companyId,\n        professionalId: professional.id,\n        userId,\n        unitId: professionalUnit?.unitId ?? '',\n        name: professional.name ?? null,\n        email: professional.email,\n    };\n}\n","// This file is generated by next-core EcmascriptClientReferenceModule.\nimport { registerClientReference } from \"react-server-dom-turbopack/server\";\nexport default registerClientReference(\n    function() { throw new Error(\"Attempted to call the default export of [project]/src/app/professional/dashboard/professional-appointments-client.tsx from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/src/app/professional/dashboard/professional-appointments-client.tsx\",\n    \"default\",\n);\n","// src/app/professional/dashboard/page.tsx\nimport type { Metadata } from 'next';\n\nimport { prisma } from '@/lib/prisma';\nimport { requireProfessionalSession } from '@/lib/professional-permissions';\n\nimport { endOfMonth, startOfMonth } from 'date-fns';\n\nimport { DatePicker } from '@/components/date-picker';\n\n// ✅ client que renderiza a lista viva (editar/concluir/cancelar)\nimport ProfessionalAppointmentsClient from './professional-appointments-client';\n\nexport const dynamic = 'force-dynamic';\n\nexport const metadata: Metadata = {\n    title: 'Profissional | Dashboard',\n};\n\ntype SearchParamsShape = {\n    date?: string; // yyyy-MM-dd (filtro do DIA)\n    month?: string; // yyyy-MM (filtro do MÊS)\n};\n\n/**\n * ✅ Next (versões recentes) pode tipar `searchParams` como Promise nos tipos gerados.\n * Para evitar conflito com `.next/dev/types/...`, tratamos como Promise<any>.\n */\ntype PageProps = {\n    searchParams?: Promise<any>;\n};\n\nfunction normalizeString(v: unknown): string {\n    return String(v ?? '').trim();\n}\n\n/* ---------------------------------------------------------\n * ✅ Decimal-safe helpers (evita NaN com Prisma.Decimal)\n * ---------------------------------------------------------*/\nfunction toNumberDecimal(v: unknown): number {\n    if (v == null) return NaN;\n    if (typeof v === 'number') return v;\n\n    if (typeof v === 'string') {\n        const n = Number(v.replace(',', '.'));\n        return Number.isFinite(n) ? n : NaN;\n    }\n\n    if (typeof v === 'object') {\n        const anyObj = v as any;\n        if (typeof anyObj?.toNumber === 'function') {\n            const n = anyObj.toNumber();\n            return Number.isFinite(n) ? n : NaN;\n        }\n        if (typeof anyObj?.toString === 'function') {\n            const n = Number(String(anyObj.toString()).replace(',', '.'));\n            return Number.isFinite(n) ? n : NaN;\n        }\n    }\n\n    const n = Number(v as any);\n    return Number.isFinite(n) ? n : NaN;\n}\n\n/* ---------------------------------------------------------\n * ✅ Date helpers (dia em America/Sao_Paulo => range UTC)\n * - evita \"sumir\" agendamentos quando o server roda em UTC\n * ---------------------------------------------------------*/\nconst SAO_PAULO_UTC_OFFSET_HOURS = 3; // SP = UTC-03 => 00:00 SP = 03:00 UTC\n\nfunction parseYMD(\n    dateStr?: string\n): { y: number; m: number; d: number } | null {\n    const raw = normalizeString(dateStr);\n    if (!raw) return null;\n\n    const [y, m, d] = raw.split('-').map(Number);\n    if (!y || !m || !d) return null;\n\n    return { y, m, d };\n}\n\nfunction getTodayYMDInSaoPaulo(): { y: number; m: number; d: number } {\n    const parts = new Intl.DateTimeFormat('en-CA', {\n        timeZone: 'America/Sao_Paulo',\n        year: 'numeric',\n        month: '2-digit',\n        day: '2-digit',\n    }).formatToParts(new Date());\n\n    const y = Number(parts.find((p) => p.type === 'year')?.value ?? '0');\n    const m = Number(parts.find((p) => p.type === 'month')?.value ?? '0');\n    const d = Number(parts.find((p) => p.type === 'day')?.value ?? '0');\n\n    return { y, m, d };\n}\n\nfunction buildSaoPauloDayUtcRange(ymd: { y: number; m: number; d: number }) {\n    const { y, m, d } = ymd;\n\n    const startUtcMs = Date.UTC(\n        y,\n        m - 1,\n        d,\n        SAO_PAULO_UTC_OFFSET_HOURS,\n        0,\n        0,\n        0\n    );\n\n    const nextDayStartUtcMs = Date.UTC(\n        y,\n        m - 1,\n        d + 1,\n        SAO_PAULO_UTC_OFFSET_HOURS,\n        0,\n        0,\n        0\n    );\n\n    return {\n        startUtc: new Date(startUtcMs),\n        endUtc: new Date(nextDayStartUtcMs - 1),\n    };\n}\n\nfunction parseMonthParam(monthParam?: string): Date {\n    const raw = normalizeString(monthParam);\n    if (!raw) return startOfMonth(new Date());\n\n    // esperado yyyy-MM\n    const [y, m] = raw.split('-').map(Number);\n    if (!y || !m) return startOfMonth(new Date());\n\n    return startOfMonth(new Date(y, m - 1, 1));\n}\n\nfunction clampToPct(v: number) {\n    if (!Number.isFinite(v)) return 0;\n    if (v < 0) return 0;\n    if (v > 100) return 100;\n    return v;\n}\n\nfunction safeAdd(a: number, b: number) {\n    const aa = Number.isFinite(a) ? a : 0;\n    const bb = Number.isFinite(b) ? b : 0;\n    return aa + bb;\n}\n\nexport default async function ProfessionalDashboardPage({\n    searchParams,\n}: PageProps) {\n    // ✅ Unwrap do Next (searchParams pode vir como Promise)\n    const sp = (await searchParams) as SearchParamsShape | undefined;\n\n    // ✅ sessão do profissional no SERVER\n    const session = await requireProfessionalSession();\n\n    const companyId = normalizeString(session.companyId);\n    const professionalId = normalizeString(session.professionalId);\n\n    // unitId pode vir do session. Se não vier, buscamos pela ProfessionalUnit ativa.\n    let unitId = normalizeString(session.unitId);\n\n    if (!companyId || !professionalId) {\n        throw new Error(\n            'ProfessionalDashboardPage: companyId/professionalId não encontrado na sessão.'\n        );\n    }\n\n    if (!unitId) {\n        const pu = await prisma.professionalUnit.findFirst({\n            where: { companyId, professionalId, isActive: true },\n            select: { unitId: true },\n            orderBy: { updatedAt: 'desc' },\n        });\n        unitId = normalizeString(pu?.unitId);\n    }\n\n    if (!unitId) {\n        throw new Error(\n            'ProfessionalDashboardPage: unitId não encontrado para o profissional.'\n        );\n    }\n\n    // ✅ DIA (range em UTC equivalente ao dia em SP)\n    const ymd = parseYMD(sp?.date) ?? getTodayYMDInSaoPaulo();\n    const { startUtc: dayStart, endUtc: dayEnd } =\n        buildSaoPauloDayUtcRange(ymd);\n\n    // ✅ MÊS (mantém como estava)\n    const monthBase = parseMonthParam(sp?.month);\n    const monthStart = startOfMonth(monthBase);\n    const monthEnd = endOfMonth(monthBase);\n\n    const currencyFormatter = new Intl.NumberFormat('pt-BR', {\n        style: 'currency',\n        currency: 'BRL',\n        minimumFractionDigits: 2,\n    });\n\n    // ---------------------------------------------------------\n    // ✅ ATENDIMENTOS (DIA): total e done\n    // ---------------------------------------------------------\n    const [appointmentsTodayCount, appointmentsDoneTodayCount] =\n        await Promise.all([\n            prisma.appointment.count({\n                where: {\n                    companyId,\n                    unitId,\n                    professionalId,\n                    scheduleAt: { gte: dayStart, lte: dayEnd },\n                    status: { in: ['PENDING', 'DONE'] },\n                },\n            }),\n            prisma.appointment.count({\n                where: {\n                    companyId,\n                    unitId,\n                    professionalId,\n                    scheduleAt: { gte: dayStart, lte: dayEnd },\n                    status: 'DONE',\n                },\n            }),\n        ]);\n\n    const appointmentsPendingToday =\n        appointmentsTodayCount - appointmentsDoneTodayCount;\n\n    // ---------------------------------------------------------\n    // ✅ FINANCEIRO (DIA/MÊS) baseado SEMPRE em Order COMPLETED\n    // ---------------------------------------------------------\n    const [ordersDay, ordersMonth] = await Promise.all([\n        prisma.order.findMany({\n            where: {\n                companyId,\n                unitId,\n                status: 'COMPLETED',\n                updatedAt: { gte: dayStart, lte: dayEnd },\n                OR: [\n                    { professionalId },\n                    { items: { some: { professionalId } } },\n                ],\n            },\n            select: {\n                id: true,\n                professionalId: true,\n                appointment: {\n                    select: {\n                        professionalPercentageAtTheTime: true,\n                    },\n                },\n                items: {\n                    select: {\n                        professionalId: true,\n                        totalPrice: true,\n                        serviceId: true,\n                        productId: true,\n                        service: { select: { professionalPercentage: true } },\n                        product: { select: { professionalPercentage: true } },\n                    },\n                },\n            },\n        }),\n        prisma.order.findMany({\n            where: {\n                companyId,\n                unitId,\n                status: 'COMPLETED',\n                updatedAt: { gte: monthStart, lte: monthEnd },\n                OR: [\n                    { professionalId },\n                    { items: { some: { professionalId } } },\n                ],\n            },\n            select: {\n                id: true,\n                professionalId: true,\n                appointment: {\n                    select: {\n                        professionalPercentageAtTheTime: true,\n                    },\n                },\n                items: {\n                    select: {\n                        professionalId: true,\n                        totalPrice: true,\n                        serviceId: true,\n                        productId: true,\n                        service: { select: { professionalPercentage: true } },\n                        product: { select: { professionalPercentage: true } },\n                    },\n                },\n            },\n        }),\n    ]);\n\n    // ---------------------------------------------------------\n    // ✅ CÁLCULO (DIA)\n    // ---------------------------------------------------------\n    let grossToday = 0;\n    let commissionToday = 0;\n\n    for (const o of ordersDay) {\n        const orderBelongsToProfessional = o.professionalId === professionalId;\n\n        const pctFromAppointment = clampToPct(\n            toNumberDecimal(o.appointment?.professionalPercentageAtTheTime)\n        );\n\n        for (const it of o.items) {\n            const itemBelongsToProfessional =\n                it.professionalId === professionalId ||\n                (orderBelongsToProfessional && !it.professionalId);\n\n            if (!itemBelongsToProfessional) continue;\n\n            const itemTotal = toNumberDecimal(it.totalPrice);\n            grossToday = safeAdd(grossToday, itemTotal);\n\n            if (it.serviceId) {\n                const pctFromService = clampToPct(\n                    toNumberDecimal(it.service?.professionalPercentage)\n                );\n                const pct = pctFromAppointment || pctFromService;\n                commissionToday = safeAdd(\n                    commissionToday,\n                    (itemTotal * pct) / 100\n                );\n            } else if (it.productId) {\n                const pctFromProduct = clampToPct(\n                    toNumberDecimal(it.product?.professionalPercentage)\n                );\n                commissionToday = safeAdd(\n                    commissionToday,\n                    (itemTotal * pctFromProduct) / 100\n                );\n            }\n        }\n    }\n\n    const netToday = grossToday - commissionToday;\n\n    // ---------------------------------------------------------\n    // ✅ CÁLCULO (MÊS)\n    // ---------------------------------------------------------\n    let grossMonth = 0;\n    let commissionMonth = 0;\n\n    for (const o of ordersMonth) {\n        const orderBelongsToProfessional = o.professionalId === professionalId;\n\n        const pctFromAppointment = clampToPct(\n            toNumberDecimal(o.appointment?.professionalPercentageAtTheTime)\n        );\n\n        for (const it of o.items) {\n            const itemBelongsToProfessional =\n                it.professionalId === professionalId ||\n                (orderBelongsToProfessional && !it.professionalId);\n\n            if (!itemBelongsToProfessional) continue;\n\n            const itemTotal = toNumberDecimal(it.totalPrice);\n            grossMonth = safeAdd(grossMonth, itemTotal);\n\n            if (it.serviceId) {\n                const pctFromService = clampToPct(\n                    toNumberDecimal(it.service?.professionalPercentage)\n                );\n                const pct = pctFromAppointment || pctFromService;\n                commissionMonth = safeAdd(\n                    commissionMonth,\n                    (itemTotal * pct) / 100\n                );\n            } else if (it.productId) {\n                const pctFromProduct = clampToPct(\n                    toNumberDecimal(it.product?.professionalPercentage)\n                );\n                commissionMonth = safeAdd(\n                    commissionMonth,\n                    (itemTotal * pctFromProduct) / 100\n                );\n            }\n        }\n    }\n\n    const netMonth = grossMonth - commissionMonth;\n\n    // ---------------------------------------------------------\n    // ✅ REVIEWS (MÊS): média e total\n    // ---------------------------------------------------------\n    const reviewsMonthAgg = await prisma.appointmentReview.aggregate({\n        where: {\n            companyId,\n            professionalId,\n            createdAt: { gte: monthStart, lte: monthEnd },\n        },\n        _count: { id: true },\n        _avg: { rating: true },\n    });\n\n    const totalReviewsMonth = reviewsMonthAgg._count.id ?? 0;\n    const averageRatingMonth = Number(reviewsMonthAgg._avg.rating ?? 0);\n\n    const averageRatingMonthDisplay =\n        totalReviewsMonth > 0 ? averageRatingMonth.toFixed(2) : '—';\n\n    // ---------------------------------------------------------\n    // ✅ LISTA VIVA (DIA): agendamentos do profissional\n    // ---------------------------------------------------------\n    const [appointmentsPrisma, unitPrisma, servicesPrisma, clientsPrisma] =\n        await Promise.all([\n            prisma.appointment.findMany({\n                where: {\n                    companyId,\n                    unitId,\n                    professionalId,\n                    scheduleAt: { gte: dayStart, lte: dayEnd },\n                    status: { in: ['PENDING', 'DONE', 'CANCELED'] },\n                },\n                orderBy: { scheduleAt: 'asc' },\n                select: {\n                    id: true,\n                    unitId: true,\n                    clientId: true,\n                    clientName: true,\n                    phone: true,\n                    description: true,\n                    scheduleAt: true,\n                    status: true,\n                    professionalId: true,\n                    serviceId: true,\n                },\n            }),\n\n            prisma.unit.findFirst({\n                where: { id: unitId, companyId },\n                select: { id: true, name: true },\n            }),\n\n            // ✅ para o EditAppointmentDialog (mesma UX do admin)\n            prisma.service.findMany({\n                where: {\n                    companyId,\n                    isActive: true,\n                    OR: [{ unitId }, { unitId: null }],\n                },\n                orderBy: { name: 'asc' },\n                select: {\n                    id: true,\n                    name: true,\n                    durationMinutes: true,\n                    price: true,\n                    isActive: true,\n                    unitId: true,\n                },\n            }),\n\n            // ✅ para o picker de cliente\n            prisma.user.findMany({\n                where: {\n                    isActive: true,\n                    companyMemberships: {\n                        some: {\n                            companyId,\n                            isActive: true,\n                            role: 'CLIENT',\n                        },\n                    },\n                },\n                orderBy: { name: 'asc' },\n                take: 200,\n                select: {\n                    id: true,\n                    name: true,\n                    phone: true,\n                },\n            }),\n        ]);\n\n    const appointments = appointmentsPrisma.map((a) => ({\n        id: a.id,\n        unitId: a.unitId,\n        clientId: a.clientId,\n        clientName: a.clientName,\n        phone: a.phone,\n        description: a.description,\n        scheduleAt: a.scheduleAt,\n        status: a.status as 'PENDING' | 'DONE' | 'CANCELED',\n        professionalId: a.professionalId ?? null,\n        serviceId: a.serviceId ?? null,\n    }));\n\n    // na tela do profissional, a lista de profissionais é só ele mesmo\n    const professionals = [\n        {\n            id: professionalId,\n            name: session.name ?? 'Profissional',\n            imageUrl: null as string | null,\n            isActive: true,\n        },\n    ];\n\n    // ✅ EditAppointmentDialog aceita price number | string\n    const services = servicesPrisma.map((s) => ({\n        id: s.id,\n        name: s.name,\n        durationMinutes: s.durationMinutes,\n        price: s.price != null ? String(s.price) : undefined,\n        isActive: s.isActive,\n        unitId: s.unitId ?? null,\n    }));\n\n    const clients = clientsPrisma\n        .map((c) => ({\n            id: c.id,\n            name: normalizeString(c.name),\n            phone: normalizeString(c.phone) || null,\n        }))\n        .filter((c) => c.name.length > 0);\n\n    const units = [\n        {\n            id: unitId,\n            name: unitPrisma?.name ?? 'Unidade',\n        },\n    ];\n\n    // ✅ garante que o client mostre a data mesmo quando não vem querystring\n    const dayParamForClient =\n        normalizeString(sp?.date) ||\n        `${String(ymd.y).padStart(4, '0')}-${String(ymd.m).padStart(\n            2,\n            '0'\n        )}-${String(ymd.d).padStart(2, '0')}`;\n\n    return (\n        <div className=\"space-y-6\">\n            {/* HEADER + DATA */}\n            <div className=\"flex flex-col gap-4 md:flex-row md:items-center md:justify-between\">\n                <div>\n                    <h1 className=\"text-title text-content-primary\">\n                        Dashboard\n                    </h1>\n                    <p className=\"text-paragraph-medium-size text-content-secondary\">\n                        Sua visão geral: atendimentos, ganhos e avaliações no\n                        período selecionado.\n                    </p>\n                </div>\n\n                <DatePicker />\n            </div>\n\n            {/* KPIs */}\n            <section className=\"grid gap-4 md:grid-cols-2 lg:grid-cols-4\">\n                <div className=\"rounded-xl border border-border-primary bg-background-tertiary p-4\">\n                    <p className=\"text-label-small text-content-secondary\">\n                        Atendimentos hoje\n                    </p>\n                    <p className=\"mt-1 text-title font-semibold text-content-primary\">\n                        {appointmentsTodayCount}\n                    </p>\n                    <p className=\"mt-2 text-paragraph-small text-content-tertiary\">\n                        Pendentes:{' '}\n                        <span className=\"text-content-primary font-medium\">\n                            {appointmentsPendingToday}\n                        </span>{' '}\n                        · Concluídos:{' '}\n                        <span className=\"text-content-primary font-medium\">\n                            {appointmentsDoneTodayCount}\n                        </span>\n                    </p>\n                </div>\n\n                <div className=\"rounded-xl border border-border-primary bg-background-tertiary p-4\">\n                    <p className=\"text-label-small text-content-secondary\">\n                        Ganhos do dia\n                    </p>\n                    <p className=\"mt-1 text-title font-semibold text-content-primary\">\n                        {currencyFormatter.format(netToday)}\n                    </p>\n                    <p className=\"mt-2 text-paragraph-small text-content-tertiary\">\n                        Bruto: {currencyFormatter.format(grossToday)} ·\n                        Comissão: {currencyFormatter.format(commissionToday)}\n                    </p>\n                </div>\n\n                <div className=\"rounded-xl border border-border-primary bg-background-tertiary p-4\">\n                    <p className=\"text-label-small text-content-secondary\">\n                        Ganhos do mês\n                    </p>\n                    <p className=\"mt-1 text-title font-semibold text-content-primary\">\n                        {currencyFormatter.format(netMonth)}\n                    </p>\n                    <p className=\"mt-2 text-paragraph-small text-content-tertiary\">\n                        Bruto: {currencyFormatter.format(grossMonth)} ·\n                        Comissão: {currencyFormatter.format(commissionMonth)}\n                    </p>\n                </div>\n\n                <div className=\"rounded-xl border border-border-primary bg-background-tertiary p-4\">\n                    <p className=\"text-label-small text-content-secondary\">\n                        Nota no mês\n                    </p>\n                    <p className=\"mt-1 text-title font-semibold text-content-primary\">\n                        {averageRatingMonthDisplay}\n                        {totalReviewsMonth > 0 && (\n                            <span className=\"ml-2 align-middle text-xl text-yellow-500\">\n                                {'★'.repeat(\n                                    Math.max(\n                                        0,\n                                        Math.min(\n                                            5,\n                                            Math.round(averageRatingMonth)\n                                        )\n                                    )\n                                )}\n                            </span>\n                        )}\n                    </p>\n                    <p className=\"mt-2 text-paragraph-small text-content-tertiary\">\n                        {totalReviewsMonth} avaliações no período\n                    </p>\n                </div>\n            </section>\n\n            {/* ✅ AGENDAMENTOS DO DIA (VIVO) */}\n            <ProfessionalAppointmentsClient\n                date={dayParamForClient}\n                unitId={unitId}\n                professionalId={professionalId}\n                appointments={appointments}\n                units={units}\n                professionals={professionals}\n                services={services}\n                clients={clients}\n            />\n        </div>\n    );\n}\n"],"names":[],"mappings":"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","ignoreList":[1,2,3,4,5,6,9]}