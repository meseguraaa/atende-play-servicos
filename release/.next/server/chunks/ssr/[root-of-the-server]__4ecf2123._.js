module.exports=[193695,(a,b,c)=>{b.exports=a.x("next/dist/shared/lib/no-fallback-error.external.js",()=>require("next/dist/shared/lib/no-fallback-error.external.js"))},650645,a=>{a.n(a.i(827572))},262530,a=>{a.n(a.i(688848))},409171,a=>{a.n(a.i(753004))},21802,a=>{a.n(a.i(277152))},155517,a=>{a.n(a.i(298906))},444067,a=>{a.n(a.i(436102))},28792,a=>{"use strict";a.i(106878);var b=a.i(154840);a.i(330127);var c=a.i(766518),d=a.i(126918);a.i(110329);let e={canAccessDashboard:!0,canAccessReports:!0,canAccessCheckout:!0,canAccessAppointments:!0,canAccessProfessionals:!0,canAccessServices:!0,canAccessReviews:!0,canAccessProducts:!0,canAccessPartners:!0,canAccessClients:!0,canAccessClientLevels:!0,canAccessFinance:!0,canAccessSettings:!0};function f(a){switch(a){case"DASHBOARD":return"canAccessDashboard";case"REPORTS":return"canAccessReports";case"CHECKOUT":return"canAccessCheckout";case"APPOINTMENTS":return"canAccessAppointments";case"PROFESSIONALS":return"canAccessProfessionals";case"SERVICES":return"canAccessServices";case"REVIEWS":return"canAccessReviews";case"PRODUCTS":return"canAccessProducts";case"PARTNERS":default:return null;case"CLIENTS":return"canAccessClients";case"CLIENT_LEVELS":return"canAccessClientLevels";case"FINANCE":return"canAccessFinance";case"SETTINGS":return"canAccessSettings"}}async function g(){let a=await (0,d.getCurrentPainelUser)();if(!a)return{ok:!1,reason:"no_session"};if("ADMIN"!==a.role)return{ok:!1,reason:"not_admin"};let b=String(a.sub||"").trim(),e=String(a.companyId||"").trim();if(!b||!e)return{ok:!1,reason:"invalid_token"};let f=await c.prisma.user.findUnique({where:{id:b},select:{id:!0,name:!0,email:!0,isActive:!0}});if(!f?.id||!f.isActive)return{ok:!1,reason:"user_inactive"};let g=await c.prisma.companyMember.findFirst({where:{userId:b,companyId:e,isActive:!0,role:{in:["OWNER","ADMIN"]}},select:{role:!0}});if(!g?.role)return{ok:!1,reason:"no_membership"};let h="OWNER"===g.role;if(!h){let a=await c.prisma.adminAccess.findFirst({where:{userId:b,companyId:e},select:{id:!0}});if(!a?.id)return{ok:!1,reason:"no_access"}}return{ok:!0,ctx:{id:f.id,name:f.name??null,email:f.email,companyId:e,isOwner:h}}}let h=[{module:"APPOINTMENTS",href:"/admin/appointments"},{module:"CHECKOUT",href:"/admin/checkout"},{module:"PROFESSIONALS",href:"/admin/professionals"},{module:"SERVICES",href:"/admin/services"},{module:"PRODUCTS",href:"/admin/products"},{module:"CLIENTS",href:"/admin/clients"},{module:"CLIENT_LEVELS",href:"/admin/client-levels"},{module:"REVIEWS",href:"/admin/review-tags"},{module:"REPORTS",href:"/admin/reports"},{module:"FINANCE",href:"/admin/finance"},{module:"SETTINGS",href:"/admin/setting"},{module:"DASHBOARD",href:"/admin/dashboard"}];async function i(a){let d=function(a){if(!a)return null;for(let b of h){let c=f(b.module);if(c&&a[c])return b.href}return null}(await c.prisma.adminAccess.findFirst({where:{companyId:a.companyId,userId:a.userId},select:e}));if(d)throw(0,b.redirect)(`${d}?error=permissao`),Error("unreachable");throw(0,b.redirect)("/painel/login?error=permissao"),Error("unreachable")}async function j(a){let d=await g();d.ok||function(a){switch(a){case"no_session":(0,b.redirect)("/painel/login?error=credenciais");case"not_admin":(0,b.redirect)("/painel/login?error=permissao");default:(0,b.redirect)("/painel/login?error=permissao")}}(d.reason);let h=d.ctx;if(h.isOwner){if("PARTNERS"===a)throw await i({companyId:h.companyId,userId:h.id}),Error("unreachable");return{id:h.id,name:h.name,email:h.email,role:"ADMIN",isOwner:!0,companyId:h.companyId,unitId:null,canSeeAllUnits:!0}}let j=f(a);if(!j)throw await i({companyId:h.companyId,userId:h.id}),Error("unreachable");let k=await c.prisma.adminAccess.findFirst({where:{userId:h.id,companyId:h.companyId},select:e});if(!k||!k[j])throw await i({companyId:h.companyId,userId:h.id}),Error("unreachable");return{id:h.id,name:h.name,email:h.email,role:"ADMIN",isOwner:!1,companyId:h.companyId,unitId:null,canSeeAllUnits:!1}}a.s(["requireAdminForModule",()=>j])},779045,a=>{"use strict";var b=a.i(976286);let c=(0,b.registerClientReference)(function(){throw Error("Attempted to call Accordion() from the server but Accordion is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/src/components/ui/accordion.tsx <module evaluation>","Accordion"),d=(0,b.registerClientReference)(function(){throw Error("Attempted to call AccordionContent() from the server but AccordionContent is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/src/components/ui/accordion.tsx <module evaluation>","AccordionContent"),e=(0,b.registerClientReference)(function(){throw Error("Attempted to call AccordionItem() from the server but AccordionItem is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/src/components/ui/accordion.tsx <module evaluation>","AccordionItem"),f=(0,b.registerClientReference)(function(){throw Error("Attempted to call AccordionTrigger() from the server but AccordionTrigger is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/src/components/ui/accordion.tsx <module evaluation>","AccordionTrigger");a.s(["Accordion",0,c,"AccordionContent",0,d,"AccordionItem",0,e,"AccordionTrigger",0,f])},490035,a=>{"use strict";var b=a.i(976286);let c=(0,b.registerClientReference)(function(){throw Error("Attempted to call Accordion() from the server but Accordion is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/src/components/ui/accordion.tsx","Accordion"),d=(0,b.registerClientReference)(function(){throw Error("Attempted to call AccordionContent() from the server but AccordionContent is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/src/components/ui/accordion.tsx","AccordionContent"),e=(0,b.registerClientReference)(function(){throw Error("Attempted to call AccordionItem() from the server but AccordionItem is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/src/components/ui/accordion.tsx","AccordionItem"),f=(0,b.registerClientReference)(function(){throw Error("Attempted to call AccordionTrigger() from the server but AccordionTrigger is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/src/components/ui/accordion.tsx","AccordionTrigger");a.s(["Accordion",0,c,"AccordionContent",0,d,"AccordionItem",0,e,"AccordionTrigger",0,f])},593025,a=>{"use strict";a.i(779045);var b=a.i(490035);a.n(b)},337441,a=>{"use strict";let b=(0,a.i(976286).registerClientReference)(function(){throw Error("Attempted to call ProfessionalRow() from the server but ProfessionalRow is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/src/components/admin/professionals/professional-row/professional-row.tsx <module evaluation>","ProfessionalRow");a.s(["ProfessionalRow",0,b])},281533,a=>{"use strict";let b=(0,a.i(976286).registerClientReference)(function(){throw Error("Attempted to call ProfessionalRow() from the server but ProfessionalRow is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/src/components/admin/professionals/professional-row/professional-row.tsx","ProfessionalRow");a.s(["ProfessionalRow",0,b])},976520,a=>{"use strict";a.i(337441);var b=a.i(281533);a.n(b)},255940,a=>{"use strict";let b=(0,a.i(976286).registerClientReference)(function(){throw Error("Attempted to call ProfessionalNewDialog() from the server but ProfessionalNewDialog is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/src/components/admin/professionals/professional-new-dialog/professional-new-dialog.tsx <module evaluation>","ProfessionalNewDialog");a.s(["ProfessionalNewDialog",0,b])},344046,a=>{"use strict";let b=(0,a.i(976286).registerClientReference)(function(){throw Error("Attempted to call ProfessionalNewDialog() from the server but ProfessionalNewDialog is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/src/components/admin/professionals/professional-new-dialog/professional-new-dialog.tsx","ProfessionalNewDialog");a.s(["ProfessionalNewDialog",0,b])},915521,a=>{"use strict";a.i(255940);var b=a.i(344046);a.n(b)},398204,a=>{"use strict";var b=a.i(623127),c=a.i(766518),d=a.i(28792),e=a.i(593025),f=a.i(976520),g=a.i(915521);let h=["Dom","Seg","Ter","Qua","Qui","Sex","Sáb"];async function i(){let a=String((await (0,d.requireAdminForModule)("PROFESSIONALS")).companyId);if(!a)return(0,b.jsx)("div",{className:"space-y-8 max-w-7xl",children:(0,b.jsx)("div",{className:"rounded-xl border border-border-primary bg-background-tertiary px-4 py-6",children:(0,b.jsx)("p",{className:"text-paragraph-small text-content-secondary text-center",children:"Sessão inválida (companyId ausente)."})})});let i=await c.prisma.unit.findMany({where:{companyId:a},select:{id:!0,name:!0,isActive:!0},orderBy:[{isActive:"desc"},{name:"asc"}]}),j=(await c.prisma.professional.findMany({where:{companyId:a},orderBy:[{isActive:"desc"},{name:"asc"}],include:{user:!0,units:{where:{companyId:a},include:{unit:!0},orderBy:{createdAt:"asc"}},weeklyAvailabilities:{where:{companyId:a},include:{intervals:!0},orderBy:[{weekday:"asc"},{createdAt:"asc"}]},dailyAvailabilities:{where:{companyId:a},include:{intervals:!0},orderBy:[{date:"asc"},{createdAt:"asc"}]},reviews:{where:{companyId:a},include:{tags:{include:{tag:!0}}},orderBy:{createdAt:"desc"}}}})).map(a=>{let b,c=a.units.filter(a=>a.isActive&&a.unit?.isActive),d=c.map(a=>a.unitId),e=c.map(a=>({id:a.unit.id,name:a.unit.name})),f=a.weeklyAvailabilities.map(a=>({weekday:a.weekday,isActive:a.isActive,intervals:a.intervals.map(a=>({startTime:a.startTime,endTime:a.endTime}))})),g=a.dailyAvailabilities.map(a=>({date:a.date,type:a.type,intervals:a.intervals.map(a=>({startTime:a.startTime,endTime:a.endTime}))})),i=function(a){if(!a||0===a.length)return null;let b=a.length,c=a.reduce((a,b)=>a+(b.rating??0),0),d=new Map;for(let a=1;a<=5;a++)d.set(a,0);for(let b of a){let a=Math.max(1,Math.min(5,Number(b.rating??0)));d.set(a,(d.get(a)??0)+1)}let e=Array.from(d.entries()).map(([a,b])=>({rating:a,count:b})).sort((a,b)=>b.rating-a.rating),f=new Map;for(let b of a)for(let a of b.tags??[]){let b=String(a?.tag?.label??"").trim();b&&f.set(b,(f.get(b)??0)+1)}return{avgRating:b>0?c/b:0,totalReviews:b,ratingsCount:e,topTags:Array.from(f.entries()).map(([a,b])=>({label:a,count:b})).sort((a,b)=>b.count!==a.count?b.count-a.count:a.label.localeCompare(b.label,"pt-BR")).slice(0,5)}}(a.reviews);return{id:a.id,name:a.name,email:a.email,phone:a.phone??null,isActive:a.isActive,createdAt:a.createdAt,updatedAt:a.updatedAt,userId:a.userId??null,imageUrl:a.imageUrl??a.user?.image??null,selectedUnitIds:d,linkedUnits:e,weeklyScheduleLabel:0===(b=f.filter(a=>a.isActive&&a.intervals.length>0).sort((a,b)=>a.weekday-b.weekday)).length?"Sem escala semanal":b.length<=3?b.map(a=>{let b=h[a.weekday]??`Dia ${String(a.weekday)}`,c=a.intervals.slice().sort((a,b)=>a.startTime.localeCompare(b.startTime)).map(a=>`${a.startTime}–${a.endTime}`).join(", ");return`${b}: ${c}`}).join(" • "):`${b.length} dias com escala`,exceptionsLabel:function(a){if(0===a.length)return"Sem exceções";let b=a.filter(a=>"DAY_OFF"===a.type).length,c=a.filter(a=>"CUSTOM"===a.type).length,d=[];return b>0&&d.push(1===b?"1 dia de folga":`${b} dias de folga`),c>0&&d.push(1===c?"1 ajuste de horário":`${c} ajustes de hor\xe1rio`),d.join(" • ")||"Exceções cadastradas"}(g),weeklyAvailabilities:f,dailyAvailabilities:g,reviewStats:i}}),k=j.filter(a=>a.isActive),l=j.filter(a=>!a.isActive);return(0,b.jsxs)("div",{className:"space-y-8 max-w-7xl",children:[(0,b.jsxs)("header",{className:"flex items-center justify-between gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-title text-content-primary",children:"Profissionais"}),(0,b.jsx)("p",{className:"text-paragraph-medium text-content-secondary",children:"Veja a disponibilidade, reputação e as unidades vinculadas de cada profissional."})]}),(0,b.jsx)(g.ProfessionalNewDialog,{units:i})]}),(0,b.jsxs)("section",{className:"space-y-4",children:[(0,b.jsx)("h2",{className:"text-paragraph-medium text-content-primary",children:"Profissionais ativos"}),(0,b.jsx)(e.Accordion,{type:"single",collapsible:!0,className:"space-y-2",children:0===k.length?(0,b.jsx)("p",{className:"text-paragraph-small text-content-secondary px-2",children:"Nenhum profissional ativo no momento."}):k.map(a=>(0,b.jsx)(f.ProfessionalRow,{row:a,units:i},a.id))})]}),(0,b.jsxs)("section",{className:"space-y-3",children:[(0,b.jsx)("h2",{className:"text-paragraph-medium text-content-primary",children:"Profissionais inativos"}),(0,b.jsx)(e.Accordion,{type:"single",collapsible:!0,className:"space-y-2",children:0===l.length?(0,b.jsx)("div",{className:"rounded-xl border border-border-primary bg-background-tertiary px-4 py-6",children:(0,b.jsx)("p",{className:"text-paragraph-small text-content-secondary text-center",children:"Nenhum profissional inativo no momento."})}):l.map(a=>(0,b.jsx)(f.ProfessionalRow,{row:a,units:i},a.id))})]})]})}a.s(["default",()=>i,"dynamic",0,"force-dynamic","metadata",0,{title:"Admin | Profissionais"}],398204)}];

//# sourceMappingURL=%5Broot-of-the-server%5D__4ecf2123._.js.map