module.exports=[612747,a=>{"use strict";function b(a){return a.json().catch(()=>null)}function c(a,b){return("string"==typeof a?.error?a.error:"")||b}async function d(a){let d=await fetch("/api/admin/professionals",{method:"POST",headers:{"Content-Type":"application/json"},cache:"no-store",body:JSON.stringify(a)}),e=await b(d);return d.ok&&e?.ok?{ok:!0,data:e.data}:{ok:!1,error:c(e,"Erro ao criar profissional.")}}async function e(a,d){let e=await fetch(`/api/admin/professionals/${encodeURIComponent(a)}`,{method:"PATCH",headers:{"Content-Type":"application/json"},cache:"no-store",body:JSON.stringify(d)}),f=await b(e);return e.ok&&f?.ok?{ok:!0,data:f.data}:{ok:!1,error:c(f,"Erro ao atualizar profissional.")}}a.s(["createProfessional",()=>d,"updateProfessional",()=>e])},261519,a=>{"use strict";var b=a.i(584944),c=a.i(107439),d=a.i(259849),e=a.i(156916),f=a.i(773608),g=a.i(499638),h=a.i(699570),i=a.i(876841),j=a.i(814574),k=a.i(866718),l=a.i(580701),m=a.i(612747),n=a.i(368114),o=a.i(273819),p=a.i(597635),q=a.i(300298),r=a.i(263758),s=a.i(320091),t=a.i(789815),u=a.i(898062),v=a.i(190616);function w(a){let{icon:c,className:d,...e}=a;return(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)("div",{className:"pointer-events-none absolute left-3 top-1/2 -translate-y-1/2",children:(0,b.jsx)(c,{className:"h-4 w-4 text-content-brand"})}),(0,b.jsx)(k.Input,{...e,className:(0,n.cn)("pl-10",d)})]})}let x="bg-background-tertiary border-border-primary text-content-primary hover:border-border-secondary focus:border-border-brand focus-visible:ring-1 focus-visible:ring-border-brand focus-visible:ring-offset-0";async function y(a){let b=new FormData;b.append("file",a),b.append("module","PROFESSIONALS");let c=await fetch("/api/admin/uploads",{method:"POST",body:b}),d=await c.json().catch(()=>null);return c.ok&&d&&!0===d.ok?{ok:!0,data:d.data}:{ok:!1,error:d&&!1===d.ok&&d.error||"Não foi possível fazer upload da imagem."}}function z({barber:a,units:f,selectedUnitIds:g}){let i=(0,d.useRouter)(),z=(0,c.useRef)(null),[A,B]=(0,c.useState)(!1),[C,D]=(0,c.useState)(!1),[E,F]=(0,c.useState)(!1),[G,H]=(0,c.useState)(a.name??""),[I,J]=(0,c.useState)(a.email??""),[K,L]=(0,c.useState)(a.phone??""),[M,N]=(0,c.useState)(a.imageUrl??""),[O,P]=(0,c.useState)(""),Q=(f?.length??0)>0,R=(0,c.useMemo)(()=>f.find(a=>a.isActive)?.id??"",[f]),[S,T]=(0,c.useState)(()=>(g?.[0]??"")||R);async function U(a){if(!a.type?.startsWith("image/"))return void e.toast.error("Selecione um arquivo de imagem.");if(a.size>5242880)return void e.toast.error("Imagem muito grande. Máximo: 5MB.");F(!0);let b=await y(a);(F(!1),b.ok)?(N(b.data.url),e.toast.success("Imagem enviada!")):e.toast.error(b.error)}(0,c.useEffect)(()=>{!A||(H(a.name??""),J(a.email??""),L(a.phone??""),N(a.imageUrl??""),P(""),T((g?.[0]??"")||R),F(!1),z.current&&(z.current.value=""))},[A,a.name,a.email,a.phone,a.imageUrl,g,R]);let V=(0,c.useMemo)(()=>{let a=M.trim();if(!a)return null;let b=String(a??"").trim();if(!b)return null;let c=b.toLowerCase();if(c.startsWith("http://")||c.startsWith("https://"))return b;let d=b.startsWith("/")?b:`/${b}`;return`${window.location.origin}${d}`},[M]),W=C||E,X=!Q||!S;async function Y(b){if(b.preventDefault(),W)return;if(!Q)return void e.toast.error("Crie pelo menos 1 unidade antes de cadastrar profissionais.");let c=f.find(a=>a.id===S)||null;if(!c||!c.isActive)return void e.toast.error("Selecione uma unidade ativa.");D(!0);let d=await (0,m.updateProfessional)(a.id,{name:G.trim(),email:I.trim().toLowerCase(),phone:K.trim(),imageUrl:V,password:O||void 0,unitIds:[S]});(D(!1),d.ok)?(e.toast.success("Alterações salvas!"),B(!1),i.refresh()):e.toast.error(d.error)}return(0,b.jsxs)(j.Dialog,{open:A,onOpenChange:a=>{W||B(a)},children:[(0,b.jsx)(j.DialogTrigger,{asChild:!0,children:(0,b.jsx)(h.Button,{variant:"edit2",size:"sm",className:"border-border-primary hover:bg-muted/40",children:"Editar"})}),(0,b.jsxs)(j.DialogContent,{className:"bg-background-secondary border border-border-primary max-h-[80vh] overflow-y-auto",children:[(0,b.jsx)(j.DialogHeader,{children:(0,b.jsx)(j.DialogTitle,{className:"text-title text-content-primary",children:"Editar profissional"})}),(0,b.jsxs)("form",{onSubmit:Y,className:"space-y-4 pb-2",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)("label",{className:"text-label-small text-content-secondary",children:["Unidade ",(0,b.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,b.jsxs)(l.Select,{value:S,onValueChange:a=>T(a),disabled:!Q||W,children:[(0,b.jsx)(l.SelectTrigger,{className:"h-10 w-full justify-between text-left font-normal bg-background-tertiary border-border-primary text-content-primary hover:border-border-secondary focus:border-border-brand focus-visible:ring-1 focus-visible:ring-border-brand focus-visible:ring-offset-0 focus-visible:border-border-brand",children:(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(r.Building2,{className:"h-4 w-4 text-content-brand"}),(0,b.jsx)(l.SelectValue,{placeholder:Q?"Selecione a unidade":"Nenhuma unidade cadastrada"})]})}),(0,b.jsx)(l.SelectContent,{children:f.map(a=>(0,b.jsxs)(l.SelectItem,{value:a.id,disabled:!a.isActive,children:[a.name," ",a.isActive?"":"(inativa)"]},a.id))})]}),X?(0,b.jsx)("p",{className:"text-xs text-red-500",children:"Selecione uma unidade ativa."}):null]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("label",{className:"text-label-small text-content-secondary",children:"Foto do profissional"}),(0,b.jsx)("input",{ref:z,type:"file",accept:"image/*",className:"hidden",disabled:W,onChange:a=>{let b=a.currentTarget.files?.[0];b&&U(b)}}),(0,b.jsxs)("div",{className:"grid gap-3 sm:grid-cols-[1fr_auto] sm:items-start",children:[(0,b.jsx)("div",{className:"space-y-2",children:(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)("div",{className:"pointer-events-none absolute left-3 top-1/2 -translate-y-1/2",children:(0,b.jsx)(o.Image,{className:"h-4 w-4 text-content-brand"})}),(0,b.jsx)(k.Input,{value:V??"",readOnly:!0,placeholder:"Escolha seu arquivo clicando em Upload.",className:(0,n.cn)("pl-10 pr-10",x)}),V?(0,b.jsx)("button",{type:"button",className:"absolute right-3 top-1/2 -translate-y-1/2 text-content-secondary hover:text-content-primary",onClick:()=>{N(""),z.current&&(z.current.value="")},disabled:W,title:"Remover imagem",children:(0,b.jsx)(q.X,{className:"h-4 w-4"})}):null]})}),(0,b.jsx)(h.Button,{type:"button",variant:"brand",className:"h-10",onClick:()=>z.current?.click(),disabled:W,title:E?"Enviando...":void 0,children:(0,b.jsxs)("span",{className:"inline-flex items-center gap-2",children:[(0,b.jsx)(p.Upload,{className:"h-4 w-4"}),E?"Enviando...":"Upload"]})})]}),V?(0,b.jsx)("div",{className:"overflow-hidden rounded-xl border border-border-primary bg-background-tertiary",children:(0,b.jsx)("img",{src:V,alt:"Preview do profissional",className:"h-40 w-full object-cover"})}):null]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)("label",{className:"text-label-small text-content-secondary",children:["Nome ",(0,b.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,b.jsx)(w,{icon:s.User,name:"name",required:!0,value:G,onChange:a=>H(a.target.value),disabled:W,className:x})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)("label",{className:"text-label-small text-content-secondary",children:["E-mail ",(0,b.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,b.jsx)(w,{icon:t.Mail,type:"email",name:"email",required:!0,value:I,onChange:a=>J(a.target.value),disabled:W,className:x})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)("label",{className:"text-label-small text-content-secondary",children:["Telefone ",(0,b.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,b.jsx)(w,{icon:u.Phone,name:"phone",required:!0,placeholder:"(99) 99999-9999",value:K??"",onChange:function(a){let b=a.target.value.replace(/\D/g,"").slice(0,11);L(b=b.length<=10?b.replace(/(\d{2})(\d)/,"($1) $2").replace(/(\d{4})(\d)/,"$1-$2"):b.replace(/(\d{2})(\d)/,"($1) $2").replace(/(\d{5})(\d)/,"$1-$2"))},disabled:W,className:x})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("label",{className:"text-label-small text-content-secondary",children:"Nova senha"}),(0,b.jsx)(w,{icon:v.KeyRound,type:"password",name:"password",value:O,onChange:a=>P(a.target.value),disabled:W,placeholder:"Preencha para alterar a senha",className:x}),(0,b.jsxs)("p",{className:"text-[11px] text-content-secondary",children:["Deixe vazio para manter a senha atual. Se preencher: mín. 6, 1 maiúscula, 1 número e 1 especial (!@#$%^&*()_+-=[]",";':\",.<>/?\\|)"]})]}),(0,b.jsx)("div",{className:"flex justify-end gap-2 pt-2",children:(0,b.jsx)(h.Button,{type:"submit",variant:"brand",disabled:W||X,title:X?"Selecione uma unidade ativa":void 0,children:E?"Enviando...":C?"Salvando...":"Salvar alterações"})})]})]})]})}let A=["Dom","Seg","Ter","Qua","Qui","Sex","Sáb"],B=["Domingo","Segunda-feira","Terça-feira","Quarta-feira","Quinta-feira","Sexta-feira","Sábado"];function C(a,b){return String(a.startTime??"").localeCompare(String(b.startTime??""))}function D({row:a,units:j}){let k=(0,d.useRouter)(),[l,n]=(0,c.useState)(!1),o=(0,c.useMemo)(()=>a.imageUrl?function(a){let b=String(a??"").trim();if(!b)return null;let c=b.toLowerCase();if(c.startsWith("http://")||c.startsWith("https://"))return b;let d=b.startsWith("/")?b:`/${b}`;return`${window.location.origin}${d}`}(a.imageUrl):null,[a.imageUrl]),p=!!a.isActive,q=a.selectedUnitIds??[],r=(0,c.useMemo)(()=>{if(a.unitsSummaryLabel)return a.unitsSummaryLabel;let b=a.linkedUnits??[];return 0===b.length?"Sem unidade":b.length<=2?b.map(a=>a.name).join(" • "):`${b.length} unidades`},[a.unitsSummaryLabel,a.linkedUnits]),s=(0,c.useMemo)(()=>(a.linkedUnits??[]).slice().sort((a,b)=>a.name.localeCompare(b.name,"pt-BR")),[a.linkedUnits]),t=a.weeklyAvailabilities??[],u=a.dailyAvailabilities??[],v=a.reviewStats??null,w=(0,c.useMemo)(()=>(function(a){let b=new Map;for(let c of a??[]){let a=function(a){let b=Number(a);return Number.isFinite(b)?b>=0&&b<=6?b:b>=1&&b<=7?b-1:-1:-1}(c.weekday);a<0||b.set(a,c)}return b})(t),[t]),x=v?v.avgRating.toFixed(2):"—";async function y(){if(l)return;n(!0);let b=await (0,m.updateProfessional)(a.id,{isActive:!p});(n(!1),b.ok)?(e.toast.success(p?"Profissional desativado.":"Profissional ativado."),k.refresh()):e.toast.error(b.error)}return(0,b.jsxs)(i.AccordionItem,{value:a.id,className:"border border-border-primary rounded-xl bg-background-tertiary",children:[(0,b.jsxs)("div",{className:"grid grid-cols-[minmax(0,3fr)_minmax(0,2fr)_minmax(0,2fr)_auto] items-center gap-6 px-4 py-3",children:[(0,b.jsx)(i.AccordionTrigger,{className:"flex items-center gap-3 min-w-0 hover:no-underline px-0 py-0",children:(0,b.jsxs)("div",{className:"flex items-center gap-3 min-w-0",children:[(0,b.jsx)("div",{className:"h-10 w-10 rounded-full bg-background-secondary border border-border-primary overflow-hidden flex items-center justify-center shrink-0",children:o?(0,b.jsx)("img",{src:o,alt:a.name,className:"h-full w-full object-cover"}):(0,b.jsx)("span",{className:"text-xs font-medium text-content-secondary",children:(a.name||"?").split(" ").map(a=>a[0]).join("").slice(0,2).toUpperCase()})}),(0,b.jsxs)("div",{className:"flex flex-col min-w-0",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 min-w-0",children:[(0,b.jsx)("p",{className:"text-paragraph-medium-size font-semibold text-content-primary truncate",children:a.name}),"boolean"==typeof a.isActive&&(0,b.jsx)("span",{className:"shrink-0 text-[11px] px-2 py-0.5 rounded-full border border-border-primary text-content-secondary",children:p?"Ativo":"Inativo"})]}),(0,b.jsxs)("p",{className:"text-xs text-content-secondary truncate",children:[a.email||"Sem e-mail"," ",(0,b.jsx)("span",{className:"mx-1 text-content-tertiary",children:"•"})," ",(0,b.jsx)("span",{className:"text-content-secondary",children:r})]})]})]})}),(0,b.jsxs)("div",{className:"hidden md:block min-w-0 whitespace-nowrap text-xs text-content-primary truncate",children:[(0,b.jsx)("span",{className:"text-content-secondary mr-1",children:"Escala semanal:"}),a.weeklyScheduleLabel??"—"]}),(0,b.jsxs)("div",{className:"hidden md:block min-w-0 whitespace-nowrap text-xs text-content-primary truncate",children:[(0,b.jsx)("span",{className:"text-content-secondary mr-1",children:"Exceções:"}),a.exceptionsLabel??"—"]}),(0,b.jsxs)("div",{className:"flex items-center justify-end gap-2 whitespace-nowrap",children:[(0,b.jsx)(z,{barber:{id:a.id,name:a.name,email:a.email??"",phone:a.phone??null,isActive:p,createdAt:a.createdAt??new Date,updatedAt:a.updatedAt??new Date,userId:a.userId??null,imageUrl:a.imageUrl??null},units:j,selectedUnitIds:q}),(0,b.jsx)(h.Button,{type:"button",variant:p?"destructive":"active",size:"sm",className:"border-border-primary hover:bg-muted/40",disabled:l,onClick:y,children:l?"Salvando...":p?"Desativar":"Ativar"})]})]}),(0,b.jsx)(i.AccordionContent,{className:"border-t border-border-primary px-4 py-4",children:(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)("div",{className:"rounded-2xl border border-border-primary bg-background-secondary p-4 space-y-3",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h2",{className:"text-label-small text-content-primary",children:"Unidades vinculadas"}),(0,b.jsx)("p",{className:"text-paragraph-small text-content-secondary",children:"Onde este profissional pode atuar (vínculos ativos)."})]}),0===s.length?(0,b.jsx)("div",{className:"rounded-xl border border-dashed border-border-primary bg-background-tertiary px-4 py-6 text-center text-paragraph-small text-content-secondary",children:"Nenhuma unidade vinculada ainda."}):(0,b.jsx)("div",{className:"flex flex-wrap gap-2",children:s.map(a=>(0,b.jsx)("span",{className:"rounded-full border border-border-primary bg-background-tertiary px-3 py-1 text-[11px] text-content-secondary",children:a.name},a.id))})]}),(0,b.jsxs)("div",{className:"rounded-2xl border border-border-primary bg-background-secondary p-4 space-y-4",children:[(0,b.jsxs)("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-2",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h2",{className:"text-label-small text-content-primary",children:"Reputação do profissional"}),(0,b.jsx)("p",{className:"text-paragraph-small text-content-secondary",children:"Visão geral das avaliações feitas pelos clientes nos atendimentos deste profissional."})]}),v&&(0,b.jsxs)("div",{className:"text-right",children:[(0,b.jsx)("p",{className:"text-paragraph-small text-content-secondary",children:"Nota média"}),(0,b.jsxs)("p",{className:"text-title font-semibold text-content-primary",children:[x,(0,b.jsx)("span",{className:"ml-2 text-yellow-500 align-middle",children:"★".repeat(Math.max(0,Math.min(5,Math.round(v.avgRating))))})]}),(0,b.jsxs)("p",{className:"text-paragraph-small text-content-secondary",children:[v.totalReviews," ",1===v.totalReviews?"avaliação":"avaliações"]})]})]}),v?(0,b.jsxs)("div",{className:"grid gap-4 md:grid-cols-[2fr,3fr]",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("p",{className:"text-label-small text-content-primary",children:"Distribuição de notas"}),(0,b.jsx)("div",{className:"space-y-1 text-[11px] text-content-secondary",children:v.ratingsCount.map(a=>(0,b.jsxs)("div",{className:"flex items-center justify-between gap-2",children:[(0,b.jsx)("span",{className:"flex items-center gap-1",children:(0,b.jsxs)("span",{className:"text-yellow-500",children:[a.rating,"★"]})}),(0,b.jsx)("span",{className:"text-content-primary font-medium",children:a.count})]},a.rating))})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("p",{className:"text-label-small text-content-primary",children:"Principais motivos citados"}),0===v.topTags.length?(0,b.jsx)("p",{className:"text-[11px] text-content-secondary",children:"Ainda não há tags suficientes para exibir aqui."}):(0,b.jsx)("div",{className:"flex flex-wrap gap-2",children:v.topTags.map(a=>(0,b.jsxs)("span",{className:"rounded-full border border-border-primary bg-background-tertiary px-3 py-1 text-[11px] text-content-secondary",children:[a.label," ",(0,b.jsxs)("span",{className:"text-content-tertiary",children:["· ",a.count]})]},a.label))})]})]}):(0,b.jsx)("div",{className:"mt-2 rounded-xl border border-dashed border-border-primary bg-background-tertiary px-4 py-6 text-center text-paragraph-small text-content-secondary",children:"Ainda não há avaliações registradas para este profissional."})]}),(0,b.jsxs)("div",{className:"rounded-2xl border border-border-primary bg-background-secondary p-4 space-y-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h2",{className:"text-label-small text-zinc-100",children:"Disponibilidade"}),(0,b.jsx)("p",{className:"text-paragraph-small text-zinc-400",children:"Visualização dos horários salvos pelo profissional. Alterações devem ser feitas no painel dele."})]}),(0,b.jsx)("div",{className:"grid gap-3 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-7",children:A.map((a,c)=>{let d=B[c],e=w.get(c)??{weekday:c,isActive:!1,intervals:[]},f=!!e.isActive&&(e.intervals?.length??0)>0;return(0,b.jsxs)("div",{className:"rounded-xl border border-zinc-700 bg-zinc-900/40 p-3 space-y-3",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-xs text-zinc-400",children:a}),(0,b.jsx)("p",{className:"text-paragraph-small text-zinc-100 font-medium",children:d})]}),(0,b.jsx)("span",{className:["text-[11px] px-2 py-0.5 rounded-full border",f?"border-emerald-500/60 text-emerald-300":"border-zinc-700 text-zinc-300"].join(" "),children:f?"Sim":"Não"})]}),(0,b.jsx)("div",{className:"space-y-1 text-[11px] text-zinc-100",children:f?(e.intervals??[]).slice().sort(C).map((a,c)=>(0,b.jsxs)("p",{children:["Das"," ",(0,b.jsx)("span",{className:"font-medium",children:a.startTime})," ","até"," ",(0,b.jsx)("span",{className:"font-medium",children:a.endTime})]},c)):(0,b.jsx)("p",{className:"text-zinc-400",children:"Sem horário definido."})})]},c)})}),(0,b.jsx)("p",{className:"text-[11px] text-zinc-400",children:"As exceções por dia (folgas, eventos, ajustes pontuais) estão listadas abaixo."})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("h3",{className:"text-label-small text-content-primary",children:"Exceções por dia"}),(0,b.jsx)("p",{className:"text-paragraph-small text-content-secondary",children:"Visualização de dias com horários diferentes do padrão semanal."}),0===u.length?(0,b.jsx)("div",{className:"mt-2 rounded-xl border border-dashed border-border-primary bg-background-secondary px-4 py-6 text-center text-paragraph-small text-content-secondary",children:"Este profissional ainda não possui nenhuma exceção cadastrada."}):(0,b.jsx)("div",{className:"mt-2 space-y-2",children:u.slice().sort((a,b)=>new Date(a.date).getTime()-new Date(b.date).getTime()).map((a,c)=>{let d=a.date instanceof Date?a.date:new Date(a.date);return(0,b.jsxs)("div",{className:"rounded-xl border border-border-primary bg-background-secondary px-4 py-3 flex flex-col md:flex-row md:items-center md:justify-between gap-2",children:[(0,b.jsxs)("div",{className:"space-y-1",children:[(0,b.jsx)("p",{className:"text-paragraph-small text-content-primary font-medium",children:(0,f.format)(d,"dd/MM/yyyy",{locale:g.ptBR})}),(0,b.jsx)("p",{className:"text-[11px] text-content-secondary",children:"DAY_OFF"===a.type?"Dia de folga":"Horário personalizado"})]}),(0,b.jsx)("div",{className:"text-[11px] text-content-primary",children:"DAY_OFF"===a.type?(0,b.jsx)("p",{children:"Sem atendimento neste dia."}):0===(a.intervals??[]).length?(0,b.jsx)("p",{className:"text-content-secondary",children:"Sem intervalos definidos."}):(a.intervals??[]).map((a,c)=>(0,b.jsxs)("p",{children:["Das"," ",(0,b.jsx)("span",{className:"font-medium",children:a.startTime})," ","até"," ",(0,b.jsx)("span",{className:"font-medium",children:a.endTime})]},c))})]},c)})})]})]})})]})}a.s(["ProfessionalRow",()=>D],261519)},658459,a=>{"use strict";var b=a.i(584944),c=a.i(107439),d=a.i(156916),e=a.i(259849),f=a.i(814574),g=a.i(699570),h=a.i(866718),i=a.i(580701),j=a.i(612747),k=a.i(368114),l=a.i(273819),m=a.i(597635),n=a.i(300298),o=a.i(263758),p=a.i(320091),q=a.i(789815),r=a.i(898062),s=a.i(190616);function t(a){let{icon:c,className:d,...e}=a;return(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)("div",{className:"pointer-events-none absolute left-3 top-1/2 -translate-y-1/2",children:(0,b.jsx)(c,{className:"h-4 w-4 text-content-brand"})}),(0,b.jsx)(h.Input,{...e,className:(0,k.cn)("pl-10",d)})]})}let u="bg-background-tertiary border-border-primary text-content-primary hover:border-border-secondary focus:border-border-brand focus-visible:ring-1 focus-visible:ring-border-brand focus-visible:ring-offset-0";async function v(a){let b=new FormData;b.append("file",a),b.append("module","PROFESSIONALS");let c=await fetch("/api/admin/uploads",{method:"POST",body:b}),d=await c.json().catch(()=>null);return c.ok&&d&&!0===d.ok?{ok:!0,data:d.data}:{ok:!1,error:d&&!1===d.ok&&d.error||"Não foi possível fazer upload da imagem."}}function w({units:a}){let w=(0,e.useRouter)(),x=(0,c.useRef)(null),[y,z]=(0,c.useState)(!1),[A,B]=(0,c.useState)(!1),[C,D]=(0,c.useState)(!1),[E,F]=(0,c.useState)(""),[G,H]=(0,c.useState)(""),[I,J]=(0,c.useState)(""),[K,L]=(0,c.useState)(""),M=(a?.length??0)>0,N=(0,c.useMemo)(()=>a.find(a=>a.isActive)?.id??"",[a]),[O,P]=(0,c.useState)(N),[Q,R]=(0,c.useState)("");function S(){F(""),H(""),J(""),L(""),P(N),R(""),D(!1),x.current&&(x.current.value="")}async function T(a){if(!a.type?.startsWith("image/"))return void d.toast.error("Selecione um arquivo de imagem.");if(a.size>5242880)return void d.toast.error("Imagem muito grande. Máximo: 5MB.");D(!0);let b=await v(a);(D(!1),b.ok)?(R(b.data.url),d.toast.success("Imagem enviada!")):d.toast.error(b.error)}(0,c.useEffect)(()=>{y&&P(a=>a||N)},[y,N]);let U=(0,c.useMemo)(()=>{let a=Q.trim();if(!a)return null;let b=String(a??"").trim();if(!b)return null;let c=b.toLowerCase();if(c.startsWith("http://")||c.startsWith("https://"))return b;let d=b.startsWith("/")?b:`/${b}`;return`${window.location.origin}${d}`},[Q]);async function V(b){if(b.preventDefault(),A||C)return;if(!M)return void d.toast.error("Crie pelo menos 1 unidade antes de cadastrar profissionais.");let c=a.find(a=>a.id===O)||null;if(!c||!c.isActive)return void d.toast.error("Selecione uma unidade ativa.");B(!0);let e=await (0,j.createProfessional)({name:E.trim(),email:G.trim().toLowerCase(),phone:I.trim(),password:K,unitIds:[O],imageUrl:U});(B(!1),e.ok)?(d.toast.success("Profissional criado com sucesso!"),z(!1),S(),w.refresh()):d.toast.error(e.error)}let W=A||C,X=!M||!O;return(0,b.jsxs)(f.Dialog,{open:y,onOpenChange:a=>{!W&&(z(a),a||S())},children:[(0,b.jsx)(f.DialogTrigger,{asChild:!0,children:(0,b.jsx)(g.Button,{variant:"brand",disabled:!M,children:"Novo profissional"})}),(0,b.jsxs)(f.DialogContent,{className:"bg-background-secondary border border-border-primary max-h-[80vh] overflow-y-auto",children:[(0,b.jsx)(f.DialogHeader,{children:(0,b.jsx)(f.DialogTitle,{className:"text-title text-content-primary",children:"Novo profissional"})}),M?(0,b.jsxs)("form",{onSubmit:V,className:"space-y-4 pb-2",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)("label",{className:"text-label-small text-content-secondary",children:["Unidade ",(0,b.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,b.jsxs)(i.Select,{value:O,onValueChange:a=>P(a),disabled:!M||W,children:[(0,b.jsx)(i.SelectTrigger,{className:"h-10 w-full justify-between text-left font-normal bg-background-tertiary border-border-primary text-content-primary hover:border-border-secondary focus:border-border-brand focus-visible:ring-1 focus-visible:ring-border-brand focus-visible:ring-offset-0 focus-visible:border-border-brand",children:(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(o.Building2,{className:"h-4 w-4 text-content-brand"}),(0,b.jsx)(i.SelectValue,{placeholder:M?"Selecione a unidade":"Nenhuma unidade cadastrada"})]})}),(0,b.jsx)(i.SelectContent,{children:a.map(a=>(0,b.jsxs)(i.SelectItem,{value:a.id,disabled:!a.isActive,children:[a.name," ",a.isActive?"":"(inativa)"]},a.id))})]}),X?(0,b.jsx)("p",{className:"text-xs text-red-500",children:"Selecione uma unidade ativa."}):null]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("label",{className:"text-label-small text-content-secondary",children:"Foto do profissional"}),(0,b.jsx)("input",{ref:x,type:"file",accept:"image/*",className:"hidden",disabled:W,onChange:a=>{let b=a.currentTarget.files?.[0];b&&T(b)}}),(0,b.jsxs)("div",{className:"grid gap-3 sm:grid-cols-[1fr_auto] sm:items-start",children:[(0,b.jsx)("div",{className:"space-y-2",children:(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)("div",{className:"pointer-events-none absolute left-3 top-1/2 -translate-y-1/2",children:(0,b.jsx)(l.Image,{className:"h-4 w-4 text-content-brand"})}),(0,b.jsx)(h.Input,{value:U??"",readOnly:!0,placeholder:"Escolha seu arquivo clicando em Upload.",className:(0,k.cn)("pl-10 pr-10",u)}),U?(0,b.jsx)("button",{type:"button",className:"absolute right-3 top-1/2 -translate-y-1/2 text-content-secondary hover:text-content-primary",onClick:()=>{R(""),x.current&&(x.current.value="")},disabled:W,title:"Remover imagem",children:(0,b.jsx)(n.X,{className:"h-4 w-4"})}):null]})}),(0,b.jsx)(g.Button,{type:"button",variant:"brand",className:"h-10",onClick:()=>x.current?.click(),disabled:W,title:C?"Enviando...":void 0,children:(0,b.jsxs)("span",{className:"inline-flex items-center gap-2",children:[(0,b.jsx)(m.Upload,{className:"h-4 w-4"}),C?"Enviando...":"Upload"]})})]}),U?(0,b.jsx)("div",{className:"overflow-hidden rounded-xl border border-border-primary bg-background-tertiary",children:(0,b.jsx)("img",{src:U,alt:"Preview do profissional",className:"h-40 w-full object-cover"})}):null]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)("label",{className:"text-label-small text-content-secondary",children:["Nome ",(0,b.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,b.jsx)(t,{icon:p.User,name:"name",required:!0,value:E,onChange:a=>F(a.target.value),disabled:W,className:u})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)("label",{className:"text-label-small text-content-secondary",children:["E-mail ",(0,b.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,b.jsx)(t,{icon:q.Mail,type:"email",name:"email",required:!0,value:G,onChange:a=>H(a.target.value),disabled:W,className:u})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)("label",{className:"text-label-small text-content-secondary",children:["Telefone ",(0,b.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,b.jsx)(t,{icon:r.Phone,name:"phone",required:!0,placeholder:"(99) 99999-9999",value:I,onChange:function(a){let b=a.target.value.replace(/\D/g,"").slice(0,11);J(b=b.length<=10?b.replace(/(\d{2})(\d)/,"($1) $2").replace(/(\d{4})(\d)/,"$1-$2"):b.replace(/(\d{2})(\d)/,"($1) $2").replace(/(\d{5})(\d)/,"$1-$2"))},disabled:W,className:u})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)("label",{className:"text-label-small text-content-secondary",children:["Senha ",(0,b.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,b.jsx)(t,{icon:s.KeyRound,type:"password",name:"password",required:!0,value:K,onChange:a=>L(a.target.value),disabled:W,placeholder:"Defina a senha do profissional",className:u}),(0,b.jsxs)("p",{className:"text-[11px] text-content-secondary",children:["Mín. 6 caracteres, 1 maiúscula, 1 número e 1 especial (!@#$%^&*()_+-=[]",";':\",.<>/?\\|)"]})]}),(0,b.jsx)("div",{className:"flex justify-end gap-2 pt-2",children:(0,b.jsx)(g.Button,{type:"submit",variant:"brand",disabled:W||X,title:X?"Selecione uma unidade ativa":void 0,children:C?"Enviando...":A?"Salvando...":"Criar profissional"})})]}):(0,b.jsx)("div",{className:"rounded-xl border border-dashed border-border-primary bg-background-tertiary p-4 text-sm text-content-secondary",children:"Você ainda não tem unidades ativas. Crie uma unidade primeiro para cadastrar profissionais."})]})]})}a.s(["ProfessionalNewDialog",()=>w])}];

//# sourceMappingURL=src_8b9fdb20._.js.map