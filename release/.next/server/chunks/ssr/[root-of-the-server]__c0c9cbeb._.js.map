{"version":3,"sources":["turbopack:///[project]/src/lib/admin-permissions.ts","turbopack:///[project]/src/components/admin/products/product-row/product-row.tsx/__nextjs-internal-proxy.mjs","turbopack:///[project]/src/components/admin/products/product-new-dialog/product-new-dialog.tsx/__nextjs-internal-proxy.mjs","turbopack:///[project]/src/app/admin/products/page.tsx"],"sourcesContent":["// src/lib/admin-permissions.ts\nimport { redirect } from 'next/navigation';\nimport { NextResponse } from 'next/server';\nimport { prisma } from '@/lib/prisma';\nimport { getCurrentPainelUser } from '@/lib/painel-session';\n\n/* =========================================================\n * Admin (Tenant)\n * ========================================================= */\n\nexport type AdminModule =\n    | 'DASHBOARD'\n    | 'REPORTS'\n    | 'CHECKOUT'\n    | 'APPOINTMENTS'\n    | 'PROFESSIONALS'\n    | 'SERVICES'\n    | 'REVIEWS'\n    | 'PRODUCTS'\n    | 'PARTNERS'\n    | 'CLIENTS'\n    | 'CLIENT_LEVELS'\n    | 'FINANCE'\n    | 'SETTINGS';\n\nexport type AdminSession = {\n    id: string;\n    name: string | null;\n    email: string;\n    role: 'ADMIN';\n    isOwner: boolean;\n    companyId: string;\n\n    // ✅ Multi-unidade fica para depois\n    unitId: null;\n\n    // ✅ Multi-unidade fica para depois (por enquanto sempre true pro owner e false pro resto)\n    canSeeAllUnits: boolean;\n};\n\ntype AdminAccessFlag =\n    | 'canAccessDashboard'\n    | 'canAccessReports'\n    | 'canAccessCheckout'\n    | 'canAccessAppointments'\n    | 'canAccessProfessionals'\n    | 'canAccessServices'\n    | 'canAccessReviews'\n    | 'canAccessProducts'\n    | 'canAccessPartners'\n    | 'canAccessClients'\n    | 'canAccessClientLevels'\n    | 'canAccessFinance'\n    | 'canAccessSettings';\n\ntype AdminAccessSelect = Record<AdminAccessFlag, true>;\nconst ADMIN_ACCESS_SELECT: AdminAccessSelect = {\n    canAccessDashboard: true,\n    canAccessReports: true,\n    canAccessCheckout: true,\n    canAccessAppointments: true,\n    canAccessProfessionals: true,\n    canAccessServices: true,\n    canAccessReviews: true,\n    canAccessProducts: true,\n    canAccessPartners: true,\n    canAccessClients: true,\n    canAccessClientLevels: true,\n    canAccessFinance: true,\n    canAccessSettings: true,\n};\n\nfunction moduleToAccessField(module: AdminModule): AdminAccessFlag | null {\n    switch (module) {\n        case 'DASHBOARD':\n            return 'canAccessDashboard';\n        case 'REPORTS':\n            return 'canAccessReports';\n        case 'CHECKOUT':\n            return 'canAccessCheckout';\n        case 'APPOINTMENTS':\n            return 'canAccessAppointments';\n        case 'PROFESSIONALS':\n            return 'canAccessProfessionals';\n        case 'SERVICES':\n            return 'canAccessServices';\n        case 'REVIEWS':\n            return 'canAccessReviews';\n        case 'PRODUCTS':\n            return 'canAccessProducts';\n\n        // ✅ IMPORTANTE:\n        // Parceiros saiu do ADMIN (tenant) e agora pertence somente à PLATAFORMA.\n        // Ao retornar null, o guard força redirect para o primeiro módulo permitido.\n        case 'PARTNERS':\n            return null;\n\n        case 'CLIENTS':\n            return 'canAccessClients';\n        case 'CLIENT_LEVELS':\n            return 'canAccessClientLevels';\n        case 'FINANCE':\n            return 'canAccessFinance';\n        case 'SETTINGS':\n            return 'canAccessSettings';\n        default:\n            return null;\n    }\n}\n\ntype AdminContext = {\n    id: string;\n    name: string | null;\n    email: string;\n    companyId: string;\n    isOwner: boolean;\n};\n\ntype AdminContextResult =\n    | { ok: true; ctx: AdminContext }\n    | {\n          ok: false;\n          reason:\n              | 'no_session'\n              | 'not_admin'\n              | 'invalid_token'\n              | 'user_inactive'\n              | 'no_membership'\n              | 'no_access';\n      };\n\ntype AdminContextFailureReason = Extract<\n    AdminContextResult,\n    { ok: false }\n>['reason'];\n\nasync function getAdminContext(): Promise<AdminContextResult> {\n    const session = await getCurrentPainelUser();\n\n    if (!session) return { ok: false, reason: 'no_session' };\n\n    // ✅ IMPORTANTE: aqui é TENANT ADMIN apenas\n    if (session.role !== 'ADMIN') return { ok: false, reason: 'not_admin' };\n\n    const userId = String((session as any).sub || '').trim();\n    const companyId = String((session as any).companyId || '').trim();\n\n    if (!userId || !companyId) return { ok: false, reason: 'invalid_token' };\n\n    const user = await prisma.user.findUnique({\n        where: { id: userId },\n        select: { id: true, name: true, email: true, isActive: true },\n    });\n\n    if (!user?.id || !user.isActive) {\n        return { ok: false, reason: 'user_inactive' };\n    }\n\n    const membership = await prisma.companyMember.findFirst({\n        where: {\n            userId,\n            companyId,\n            isActive: true,\n            role: { in: ['OWNER', 'ADMIN'] },\n        },\n        select: { role: true },\n    });\n\n    if (!membership?.role) return { ok: false, reason: 'no_membership' };\n\n    const isOwner = membership.role === 'OWNER';\n\n    // ✅ Sub-admin precisa existir em AdminAccess (OWNER não precisa)\n    if (!isOwner) {\n        const accessExists = await prisma.adminAccess.findFirst({\n            where: { userId, companyId },\n            select: { id: true },\n        });\n\n        if (!accessExists?.id) return { ok: false, reason: 'no_access' };\n    }\n\n    return {\n        ok: true,\n        ctx: {\n            id: user.id,\n            name: user.name ?? null,\n            email: user.email,\n            companyId,\n            isOwner,\n        },\n    };\n}\n\nfunction redirectToLoginByReason(reason: AdminContextFailureReason): never {\n    switch (reason) {\n        case 'no_session':\n            redirect('/painel/login?error=credenciais');\n        case 'not_admin':\n            redirect('/painel/login?error=permissao');\n        case 'invalid_token':\n        case 'user_inactive':\n        case 'no_membership':\n        case 'no_access':\n        default:\n            redirect('/painel/login?error=permissao');\n    }\n}\n\ntype ModuleRoute = { module: AdminModule; href: string };\n\n/**\n * ✅ Ordem de “melhor destino” quando falta permissão.\n *\n * Mantemos DASHBOARD por último (se for o único liberado, vira fallback final).\n * O restante segue a ordem do menu que você pediu.\n */\nconst FALLBACK_ROUTES: ModuleRoute[] = [\n    { module: 'APPOINTMENTS', href: '/admin/appointments' },\n    { module: 'CHECKOUT', href: '/admin/checkout' },\n    {\n        module: 'PROFESSIONALS',\n        // ✅ FIX: rota correta (plural)\n        href: '/admin/professionals',\n    },\n    { module: 'SERVICES', href: '/admin/services' },\n    { module: 'PRODUCTS', href: '/admin/products' },\n\n    // ✅ PARTNERS REMOVIDO do fallback (agora é somente da PLATAFORMA)\n\n    { module: 'CLIENTS', href: '/admin/clients' },\n    { module: 'CLIENT_LEVELS', href: '/admin/client-levels' },\n    { module: 'REVIEWS', href: '/admin/review-tags' },\n    { module: 'REPORTS', href: '/admin/reports' },\n    { module: 'FINANCE', href: '/admin/finance' },\n    { module: 'SETTINGS', href: '/admin/setting' },\n    // deixa dashboard por último\n    { module: 'DASHBOARD', href: '/admin/dashboard' },\n];\n\nfunction pickFirstAllowedHref(\n    access: Record<string, any> | null\n): string | null {\n    if (!access) return null;\n\n    for (const r of FALLBACK_ROUTES) {\n        const flag = moduleToAccessField(r.module);\n        if (!flag) continue;\n        if (Boolean((access as any)[flag])) return r.href;\n    }\n\n    return null;\n}\n\nasync function redirectToFirstAllowedOrLogin(params: {\n    companyId: string;\n    userId: string;\n}): Promise<never> {\n    const access = await prisma.adminAccess.findFirst({\n        where: { companyId: params.companyId, userId: params.userId },\n        select: ADMIN_ACCESS_SELECT,\n    });\n\n    const href = pickFirstAllowedHref(access as any);\n    if (href) {\n        redirect(`${href}?error=permissao`);\n        throw new Error('unreachable');\n    }\n\n    redirect('/painel/login?error=permissao');\n    throw new Error('unreachable');\n}\n\n/**\n * ✅ Server Components / Layouts / Pages (bloqueia com redirect)\n */\nexport async function requireAdminForModule(\n    module: AdminModule\n): Promise<AdminSession> {\n    const res = await getAdminContext();\n\n    if (!res.ok) {\n        redirectToLoginByReason(res.reason);\n    }\n\n    const ctx = res.ctx;\n\n    // OWNER: tudo liberado (mas mesmo assim, PARTNERS não existe mais no Admin)\n    if (ctx.isOwner) {\n        // ✅ Se tentarem acessar PARTNERS como admin-owner tenant, cai no redirect padrão\n        if (module === 'PARTNERS') {\n            await redirectToFirstAllowedOrLogin({\n                companyId: ctx.companyId,\n                userId: ctx.id,\n            });\n            throw new Error('unreachable');\n        }\n\n        return {\n            id: ctx.id,\n            name: ctx.name,\n            email: ctx.email,\n            role: 'ADMIN',\n            isOwner: true,\n            companyId: ctx.companyId,\n            unitId: null,\n            canSeeAllUnits: true,\n        };\n    }\n\n    const accessField = moduleToAccessField(module);\n    if (!accessField) {\n        await redirectToFirstAllowedOrLogin({\n            companyId: ctx.companyId,\n            userId: ctx.id,\n        });\n        throw new Error('unreachable');\n    }\n\n    const access = await prisma.adminAccess.findFirst({\n        where: { userId: ctx.id, companyId: ctx.companyId },\n        select: ADMIN_ACCESS_SELECT,\n    });\n\n    if (!access) {\n        await redirectToFirstAllowedOrLogin({\n            companyId: ctx.companyId,\n            userId: ctx.id,\n        });\n        throw new Error('unreachable');\n    }\n\n    const allowed = Boolean(access[accessField]);\n    if (!allowed) {\n        await redirectToFirstAllowedOrLogin({\n            companyId: ctx.companyId,\n            userId: ctx.id,\n        });\n        throw new Error('unreachable');\n    }\n\n    return {\n        id: ctx.id,\n        name: ctx.name,\n        email: ctx.email,\n        role: 'ADMIN',\n        isOwner: false,\n        companyId: ctx.companyId,\n        unitId: null,\n        canSeeAllUnits: false,\n    };\n}\n\n/**\n * ✅ Route Handlers /api (bloqueia com 403 JSON)\n *\n * Uso:\n * const res = await requireAdminForModuleApi('DASHBOARD');\n * if (res instanceof NextResponse) return res;\n * const session = res;\n */\nexport async function requireAdminForModuleApi(\n    module: AdminModule\n): Promise<AdminSession | NextResponse> {\n    const res = await getAdminContext();\n\n    if (!res.ok) {\n        return NextResponse.json(\n            { ok: false, error: 'unauthorized' },\n            { status: 401 }\n        );\n    }\n\n    const ctx = res.ctx;\n\n    if (ctx.isOwner) {\n        // ✅ trava PARTNERS também na API do Admin\n        if (module === 'PARTNERS') {\n            return NextResponse.json(\n                { ok: false, error: 'forbidden' },\n                { status: 403 }\n            );\n        }\n\n        return {\n            id: ctx.id,\n            name: ctx.name,\n            email: ctx.email,\n            role: 'ADMIN',\n            isOwner: true,\n            companyId: ctx.companyId,\n            unitId: null,\n            canSeeAllUnits: true,\n        };\n    }\n\n    const accessField = moduleToAccessField(module);\n    if (!accessField) {\n        return NextResponse.json(\n            { ok: false, error: 'forbidden' },\n            { status: 403 }\n        );\n    }\n\n    const access = await prisma.adminAccess.findFirst({\n        where: { userId: ctx.id, companyId: ctx.companyId },\n        select: ADMIN_ACCESS_SELECT,\n    });\n\n    if (!access || !Boolean(access[accessField])) {\n        const fallbackHref = pickFirstAllowedHref(access as any);\n        return NextResponse.json(\n            { ok: false, error: 'forbidden', fallback: fallbackHref },\n            { status: 403 }\n        );\n    }\n\n    return {\n        id: ctx.id,\n        name: ctx.name,\n        email: ctx.email,\n        role: 'ADMIN',\n        isOwner: false,\n        companyId: ctx.companyId,\n        unitId: null,\n        canSeeAllUnits: false,\n    };\n}\n\n/* =========================================================\n * Platform (AtendePlay)\n * ========================================================= *\n * ✅ MOVED OUT:\n * A plataforma agora vive em src/lib/platform-permissions.ts\n * Mantemos re-export aqui por compat (caso algum import antigo exista).\n */\n\nexport type {\n    PlatformModule,\n    PlatformSession,\n} from '@/lib/plataform-permissions';\nexport {\n    requirePlatformForModule,\n    requirePlatformForModuleApi,\n} from '@/lib/plataform-permissions';\n\n/**\n * Mantive esse export porque você já usou em outros pontos.\n * Implementamos de verdade quando chegar no painel do profissional.\n */\nexport async function requireProfessionalSession(): Promise<never> {\n    throw new Error(\n        'requireProfessionalSession ainda não foi implementado (não é necessário neste passo).'\n    );\n}\n","// This file is generated by next-core EcmascriptClientReferenceModule.\nimport { registerClientReference } from \"react-server-dom-turbopack/server\";\nexport const ProductRow = registerClientReference(\n    function() { throw new Error(\"Attempted to call ProductRow() from the server but ProductRow is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/src/components/admin/products/product-row/product-row.tsx\",\n    \"ProductRow\",\n);\n","// This file is generated by next-core EcmascriptClientReferenceModule.\nimport { registerClientReference } from \"react-server-dom-turbopack/server\";\nexport const ProductNewDialog = registerClientReference(\n    function() { throw new Error(\"Attempted to call ProductNewDialog() from the server but ProductNewDialog is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/src/components/admin/products/product-new-dialog/product-new-dialog.tsx\",\n    \"ProductNewDialog\",\n);\n","// src/app/admin/products/page.tsx\nimport type { Metadata } from 'next';\nimport { headers, cookies } from 'next/headers';\n\nimport { requireAdminForModule } from '@/lib/admin-permissions';\n\nimport { ProductRow } from '@/components/admin/products/product-row/product-row';\nimport { ProductNewDialog } from '@/components/admin/products/product-new-dialog/product-new-dialog';\n\nexport const dynamic = 'force-dynamic';\n\nexport const metadata: Metadata = {\n    title: 'Admin | Produtos',\n};\n\nexport type ProductForRow = {\n    id: string;\n    name: string;\n\n    // ✅ API sempre retorna string ('' quando não tem imagem)\n    imageUrl: string;\n\n    description: string | null;\n    price: number;\n    barberPercentage: number | null;\n    category: string | null;\n    stockQuantity: number;\n    isActive: boolean;\n\n    pickupDeadlineDays: number;\n\n    unitId: string;\n    unitName: string;\n\n    birthdayBenefitEnabled?: boolean;\n    birthdayPriceLevel?: 'BRONZE' | 'PRATA' | 'OURO' | 'DIAMANTE' | null;\n\n    hasLevelPrices: boolean;\n    levelDiscounts?: Partial<\n        Record<'BRONZE' | 'PRATA' | 'OURO' | 'DIAMANTE', number>\n    >;\n\n    isFeatured: boolean;\n};\n\ntype UnitOption = { id: string; name: string; isActive: boolean };\n\ntype ProductsApiResponse = {\n    ok: boolean;\n    data?: {\n        products: ProductForRow[];\n        units: UnitOption[];\n        activeUnitId: string | null;\n    };\n    error?: string;\n};\n\nfunction getBaseUrlFromHeaders(h: Headers) {\n    const host = h.get('x-forwarded-host') ?? h.get('host');\n    const proto = h.get('x-forwarded-proto') ?? 'http';\n    if (!host) return null;\n    return `${proto}://${host}`;\n}\n\nexport default async function AdminProductsPage() {\n    await requireAdminForModule('PRODUCTS');\n\n    // ✅ no seu Next, isso é Promise -> precisa await\n    const h = await headers();\n    const baseUrl = getBaseUrlFromHeaders(h);\n\n    // ✅ no seu Next, isso é Promise -> precisa await\n    const cookieStore = await cookies();\n    const cookieHeader = cookieStore\n        .getAll()\n        .map((c: { name: string; value: string }) => `${c.name}=${c.value}`)\n        .join('; ');\n\n    let products: ProductForRow[] = [];\n    let units: UnitOption[] = [];\n\n    try {\n        const url = baseUrl\n            ? `${baseUrl}/api/admin/products`\n            : '/api/admin/products';\n\n        const res = await fetch(url, {\n            method: 'GET',\n            cache: 'no-store',\n            headers: {\n                // repassa cookies (unit scope + sessão)\n                cookie: cookieHeader,\n                accept: 'application/json',\n            },\n        });\n\n        const json = (await res\n            .json()\n            .catch(() => null)) as ProductsApiResponse | null;\n\n        if (res.ok && json?.ok && json.data) {\n            products = json.data.products ?? [];\n            units = json.data.units ?? [];\n        } else {\n            products = [];\n            units = [];\n        }\n    } catch {\n        products = [];\n        units = [];\n    }\n\n    return (\n        <div className=\"max-w-7xl space-y-6\">\n            <header className=\"flex items-center justify-between gap-4\">\n                <div>\n                    <h1 className=\"text-title text-content-primary\">\n                        Produtos\n                    </h1>\n                    <p className=\"text-paragraph-medium-size text-content-secondary\">\n                        Gerencie os produtos vendidos, estoque, categorias e\n                        comissões.\n                    </p>\n                </div>\n\n                <ProductNewDialog units={units} />\n            </header>\n\n            <section className=\"overflow-x-auto rounded-xl border border-border-primary bg-background-tertiary\">\n                <table className=\"w-full table-fixed border-collapse text-sm\">\n                    <colgroup>\n                        <col className=\"w-95\" />\n                        <col className=\"w-55\" />\n                        <col className=\"w-27.5\" />\n                        <col className=\"w-27.5\" />\n                        <col className=\"w-27.5\" />\n                        <col className=\"w-27.5\" />\n                        <col className=\"w-27.5\" />\n                        <col className=\"w-27.5\" />\n                        <col className=\"w-60\" />\n                    </colgroup>\n\n                    <thead>\n                        <tr className=\"border-b border-border-primary bg-background-secondary\">\n                            <th className=\"px-4 py-3 text-left text-xs font-medium text-content-secondary\">\n                                Produto\n                            </th>\n                            <th className=\"px-4 py-3 text-left text-xs font-medium text-content-secondary\">\n                                Unidade\n                            </th>\n                            <th className=\"px-4 py-3 text-left text-xs font-medium text-content-secondary\">\n                                Preço\n                            </th>\n                            <th className=\"px-4 py-3 text-left text-xs font-medium text-content-secondary\">\n                                Comissão\n                            </th>\n                            <th className=\"px-4 py-3 text-left text-xs font-medium text-content-secondary\">\n                                Categoria\n                            </th>\n                            <th className=\"px-4 py-3 text-left text-xs font-medium text-content-secondary\">\n                                Estoque\n                            </th>\n                            <th className=\"px-4 py-3 text-left text-xs font-medium text-content-secondary\">\n                                Prazo\n                            </th>\n                            <th className=\"px-4 py-3 text-left text-xs font-medium text-content-secondary\">\n                                Status\n                            </th>\n                            <th className=\"px-4 py-3 text-right text-xs font-medium text-content-secondary\">\n                                Ações\n                            </th>\n                        </tr>\n                    </thead>\n\n                    <tbody className=\"[&>tr>td]:align-middle\">\n                        {products.length === 0 ? (\n                            <tr className=\"border-t border-border-primary\">\n                                <td\n                                    colSpan={9}\n                                    className=\"px-4 py-6 text-center text-paragraph-small text-content-secondary\"\n                                >\n                                    Nenhum produto cadastrado ainda.\n                                </td>\n                            </tr>\n                        ) : (\n                            products.map((product) => (\n                                <ProductRow\n                                    key={product.id}\n                                    product={product}\n                                />\n                            ))\n                        )}\n                    </tbody>\n                </table>\n            </section>\n        </div>\n    );\n}\n"],"names":[],"mappings":"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","ignoreList":[1,2]}