(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,216157,e=>{"use strict";var r=e.i(565750),t=e.i(990341),a=e.i(273443),s=e.i(519455),n=e.i(487486),i=e.i(793479),o=e.i(776639),c=e.i(263942),l=e.i(939397),d=e.i(383206);let m=(0,d.default)("map-pin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]),u=(0,d.default)("hash",[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]]);var p=e.i(641304);let x=(0,d.default)("toggle-right",[["circle",{cx:"15",cy:"12",r:"3",key:"1afu0r"}],["rect",{width:"20",height:"14",x:"2",y:"5",rx:"7",key:"g7kal2"}]]);var b=e.i(14435),h=e.i(559586),f=e.i(257209),v=e.i(995403),g=e.i(975157),y=e.i(967489),j=e.i(227766),N=e.i(337822),A=e.i(230902),w=e.i(661977),T=e.i(67356),C=e.i(276389),S=e.i(512710),k=e.i(136764);let _=["Dom","Seg","Ter","Qua","Qui","Sex","S√°b"],E=["Domingo","Segunda","Ter√ßa","Quarta","Quinta","Sexta","S√°bado"],D=(()=>{let e=[];for(let r=0;r<=23;r++)for(let t=0;t<60;t+=30)e.push(`${String(r).padStart(2,"0")}:${String(t).padStart(2,"0")}`);return e})();function I(e){return e&&"object"==typeof e&&"ok"in e&&!1===e.ok&&"string"==typeof e.error?String(e.error):"internal_error"}function $(e){return({forbidden_owner_only:"Somente o dono pode criar exce√ß√µes.",unit_not_found:"N√£o foi poss√≠vel encontrar essa unidade.",unit_id_required:"Unidade inv√°lida.",exception_id_required:"Exce√ß√£o inv√°lida.",invalid_json:"Erro ao enviar dados. Tente novamente.",date_required:"Informe uma data v√°lida.",invalid_time_format:"Informe hor√°rio no formato correto (HH:mm).",invalid_time_range:"O hor√°rio final deve ser maior que o inicial.",intervals_overlap:"Os intervalos n√£o podem se sobrepor.",unauthorized:"Voc√™ n√£o tem permiss√£o para realizar esta a√ß√£o.",internal_error:"Erro interno. Tente novamente.",exception_not_found:"Exce√ß√£o n√£o encontrada."})[e]??"Algo deu errado. Tente novamente."}function P(e){return/^([01]\d|2[0-3]):([0-5]\d)$/.test(e.trim())}function z(e){let[r,t]=e.split(":").map(Number);return 60*r+t}function O(){let e=new Date,r=e.getFullYear(),t=String(e.getMonth()+1).padStart(2,"0"),a=String(e.getDate()).padStart(2,"0");return`${r}-${t}-${a}`}function q(e){if(!/^\d{4}-\d{2}-\d{2}$/.test(e))return null;let[r,t,a]=e.split("-").map(Number);if(!r||!t||!a)return null;let s=new Date(r,t-1,a).getDay();return Number.isFinite(s)?s:null}function B(e){return[...e].sort((e,r)=>z(e.startTime)-z(r.startTime)||z(e.endTime)-z(r.endTime))}function V({unitId:e,weekly:a,setWeeklyByUnitId:n,onSubmitWeekly:i}){let c,l,d,m=t.useMemo(()=>{let e=a||{};return Array.from({length:7}).map((r,t)=>{let a=e[t]||{isActive:!1,startTime:"",endTime:""};return{weekday:t,short:_[t]??`Dia ${t}`,full:E[t]??`Dia ${t}`,isActive:a.isActive,startTime:a.startTime,endTime:a.endTime}})},[a]),u=t.useMemo(()=>m.some(e=>{if(!e.isActive)return!1;let r=String(e.startTime||"").trim(),t=String(e.endTime||"").trim();return!!P(r)&&!!P(t)&&z(r)>=z(t)}),[m]),[p,x]=t.useState([]),[b,h]=t.useState(!0),[f,V]=t.useState(null),R=t.useRef(null),F=t.useCallback(async()=>{h(!0),V(null),R.current&&R.current.abort();let r=new AbortController;R.current=r;try{let t=await fetch(`/api/admin/settings/units/${e}/exceptions`,{method:"GET",headers:{"Content-Type":"application/json"},signal:r.signal}),a=null;try{a=await t.json()}catch{a=null}if(!t.ok||!a||!a.ok){let e=a?I(a):"internal_error",r=$(e);x([]),V(r);return}let s=Array.isArray(a.data)?a.data:[];x([...s].sort((e,r)=>e.date===r.date?0:e.date<r.date?1:-1))}catch(e){if(e?.name==="AbortError")return;x([]),V("N√£o foi poss√≠vel carregar as exce√ß√µes. Verifique sua conex√£o.")}finally{h(!1)}},[e]);t.useEffect(()=>(F(),()=>{R.current&&R.current.abort()}),[F]);let[L,U]=t.useState(null);async function M(r){if(r){U(r);try{let t=await fetch(`/api/admin/settings/units/${e}/exceptions/${r}`,{method:"DELETE",headers:{"Content-Type":"application/json"}}),a=null;try{a=await t.json()}catch{a=null}if(!t.ok||!a||!a.ok){let e=a?I(a):"internal_error";v.toast.error($(e));return}v.toast.success("Exce√ß√£o removida ‚úÖ"),await F()}catch{v.toast.error("N√£o foi poss√≠vel remover a exce√ß√£o. Verifique a conex√£o.")}finally{U(null)}}}let[H,G]=t.useState(!1),[J,Q]=t.useState(!1),[Y,K]=t.useState(!1),[W,X]=t.useState({date:O(),mode:"INTERVALS",intervals:[{startTime:"12:00",endTime:"14:00"}]}),Z=t.useMemo(()=>(function(e){if(!/^\d{4}-\d{2}-\d{2}$/.test(e))return null;let[r,t,a]=e.split("-").map(Number);if(!r||!t||!a)return null;let s=new Date(r,t-1,a);return(0,w.isValid)(s)?s:null})(W.date)??new Date,[W.date]);function ee(){J||(G(!1),K(!1))}function er(e,r){X(t=>{let a=[...t.intervals];return a[e]={...a[e],...r},{...t,intervals:a}})}function et(e){let r=q(e);if(null===r)return null;let t=a?.[r];if(!t?.isActive)return null;let s=String(t.startTime||"").trim(),n=String(t.endTime||"").trim();if(!P(s)||!P(n))return null;let i=z(s);return z(n)<=i?null:{startTime:s,endTime:n}}async function ea(r){r.preventDefault();let t=String(W.date||"").trim(),a=W.mode;if(!t||!/^\d{4}-\d{2}-\d{2}$/.test(t))return void v.toast.error("Informe uma data v√°lida.");let s=[];if("FULL_DAY"===a){let e=et(t);if(!e){let e=q(t),r=null!==e?E[e]??`Dia ${e}`:"o dia";v.toast.error(`N\xe3o d\xe1 pra bloquear o dia inteiro: ${r} n\xe3o est\xe1 com hor\xe1rio v\xe1lido no padr\xe3o semanal.`);return}s=[e]}else{let e=W.intervals.map(e=>({startTime:String(e.startTime||"").trim(),endTime:String(e.endTime||"").trim()}));for(let r=0;r<e.length;r++){let t=e[r];if(!P(t.startTime)||!P(t.endTime))return void v.toast.error(`Intervalo #${r+1}: hor\xe1rios inv\xe1lidos.`);let a=z(t.startTime);if(z(t.endTime)<=a)return void v.toast.error(`Intervalo #${r+1}: o hor\xe1rio final deve ser maior que o inicial.`)}if(function(e){let r=B(e);for(let e=1;e<r.length;e++){let t=z(r[e-1].endTime);if(z(r[e].startTime)<t)return!0}return!1}(e))return void v.toast.error("Os intervalos n√£o podem se sobrepor.");s=B(e)}Q(!0);try{let r=await fetch(`/api/admin/settings/units/${e}/exceptions`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({date:t,mode:a,intervals:s})}),n=null;try{n=await r.json()}catch{n=null}if(!r.ok||!n||!n.ok){let e=n?I(n):"internal_error";v.toast.error($(e));return}v.toast.success("FULL_DAY"===a?"Exce√ß√£o criada (dia inteiro) ‚úÖ":"Exce√ß√£o criada ‚úÖ"),G(!1),await F()}catch{v.toast.error("N√£o foi poss√≠vel criar a exce√ß√£o. Verifique a conex√£o.")}finally{Q(!1)}}return(0,r.jsxs)("div",{className:"rounded-2xl border border-border-primary bg-background-secondary p-4 space-y-4",children:[(0,r.jsx)(o.Dialog,{open:H,onOpenChange:e=>e?G(!0):ee(),children:(0,r.jsxs)(o.DialogContent,{variant:"appointment",overlayVariant:"blurred",showCloseButton:!0,className:"sm:max-w-[720px]",children:[(0,r.jsxs)(o.DialogHeader,{children:[(0,r.jsx)(o.DialogTitle,{size:"modal",children:"Criar exce√ß√£o"}),(0,r.jsx)(o.DialogDescription,{size:"modal",children:"Bloqueie o dia inteiro (com base no padr√£o semanal) ou crie pausas por intervalos."})]}),(0,r.jsxs)("form",{onSubmit:ea,className:"space-y-4",children:[(0,r.jsxs)("div",{className:"grid gap-4 md:grid-cols-2",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("label",{className:"text-label-medium-size text-content-primary",children:"Data"}),(0,r.jsxs)(N.Popover,{open:Y,onOpenChange:K,children:[(0,r.jsx)(N.PopoverTrigger,{asChild:!0,children:(0,r.jsxs)(s.Button,{type:"button",variant:"outline",className:"w-full justify-between text-left font-normal bg-transparent border-border-primary text-content-primary hover:bg-background-tertiary hover:border-border-secondary hover:text-content-primary focus-visible:ring-offset-0 focus-visible:ring-1 focus-visible:ring-border-brand focus:border-border-brand focus-visible:border-border-brand",disabled:J,children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)(C.Calendar,{className:"h-4 w-4 text-content-brand"}),Z?(0,A.format)(Z,"dd/MM/yyyy",{locale:T.ptBR}):(0,r.jsx)("span",{children:"Selecione uma data"})]}),(0,r.jsx)(S.ChevronDown,{className:"h-4 w-4 opacity-50"})]})}),(0,r.jsx)(N.PopoverContent,{className:"w-auto p-0",children:(0,r.jsx)(j.Calendar,{mode:"single",selected:Z,onSelect:e=>{e&&(X(r=>({...r,date:(0,A.format)(e,"yyyy-MM-dd")})),K(!1))},autoFocus:!0,locale:T.ptBR})})]}),(0,r.jsx)("p",{className:"text-[11px] text-content-secondary/70",children:"Selecione uma data para criar o bloqueio."})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("label",{className:"text-label-medium-size text-content-primary",children:"Tipo de bloqueio"}),(0,r.jsxs)(y.Select,{value:W.mode,onValueChange:e=>X(r=>({...r,mode:e})),disabled:J,children:[(0,r.jsx)(y.SelectTrigger,{className:"h-10 w-full justify-between text-left font-normal bg-background-tertiary border-border-primary text-content-primary hover:border-border-secondary focus:border-border-brand focus-visible:ring-1 focus-visible:ring-border-brand focus-visible:ring-offset-0",children:(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)(k.Clock,{className:"h-4 w-4 text-content-brand"}),(0,r.jsx)(y.SelectValue,{placeholder:"Selecione"})]})}),(0,r.jsxs)(y.SelectContent,{children:[(0,r.jsx)(y.SelectItem,{value:"FULL_DAY",children:"Dia inteiro"}),(0,r.jsx)(y.SelectItem,{value:"INTERVALS",children:"Intervalos"})]})]}),(0,r.jsx)("p",{className:"text-[11px] text-content-secondary/70",children:"FULL_DAY"===W.mode?"Vai bloquear o per√≠odo de atendimento do dia, baseado no padr√£o semanal.":"Voc√™ pode adicionar v√°rios intervalos de pausa/bloqueio."})]})]}),"FULL_DAY"===W.mode?(0,r.jsx)("div",{className:"rounded-xl border border-border-primary bg-background-tertiary p-4 space-y-2",children:(l=null!==(c=q(W.date))?E[c]??`Dia ${c}`:"‚Äî",d=et(W.date),(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("p",{className:"text-[11px] text-content-secondary",children:["Dia selecionado:"," ",(0,r.jsx)("span",{className:"text-content-primary font-medium",children:l})]}),d?(0,r.jsxs)("p",{className:"text-[11px] text-content-secondary",children:["Hor√°rio do padr√£o semanal:"," ",(0,r.jsxs)("span",{className:"text-content-primary",children:[d.startTime," √†s"," ",d.endTime]})]}):(0,r.jsx)("p",{className:"text-[11px] text-destructive",children:"Esse dia n√£o tem hor√°rio v√°lido no padr√£o semanal (ou est√° desativado)."}),(0,r.jsx)("p",{className:"text-[11px] text-content-secondary/70",children:"Dica: ajuste o padr√£o semanal se quiser que ‚Äúdia inteiro‚Äù funcione nesse dia."})]}))}):(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between gap-3",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-label-medium-size text-content-primary",children:"Intervalos"}),(0,r.jsx)("p",{className:"text-[11px] text-content-secondary/70",children:"Adicione pausas/bloqueios no dia selecionado."})]}),(0,r.jsx)(s.Button,{type:"button",variant:"outline",size:"sm",onClick:function(){X(e=>({...e,mode:"INTERVALS",intervals:[...e.intervals,{startTime:"12:00",endTime:"14:00"}]}))},disabled:J,children:"+ Adicionar intervalo"})]}),(0,r.jsx)("div",{className:"space-y-2",children:W.intervals.map((e,t)=>(0,r.jsxs)("div",{className:"rounded-xl border border-border-primary bg-background-tertiary p-4 space-y-3",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between gap-2",children:[(0,r.jsxs)("p",{className:"text-[11px] text-content-secondary",children:["Intervalo #",t+1]}),(0,r.jsx)(s.Button,{type:"button",variant:"outline",size:"sm",onClick:()=>{X(e=>{let r=[...e.intervals];return r.splice(t,1),{...e,intervals:r.length?r:[{startTime:"12:00",endTime:"14:00"}]}})},disabled:J||W.intervals.length<=1,children:"Remover"})]}),(0,r.jsxs)("div",{className:"grid gap-4 md:grid-cols-2",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("label",{className:"text-label-medium-size text-content-primary",children:"In√≠cio"}),(0,r.jsxs)(y.Select,{value:e.startTime||"",onValueChange:e=>er(t,{startTime:e}),disabled:J,children:[(0,r.jsx)(y.SelectTrigger,{className:(0,g.cn)("h-10 w-full justify-between text-left font-normal bg-background-tertiary border-border-primary text-content-primary focus-visible:ring-offset-0 focus-visible:ring-1 focus-visible:ring-border-brand focus:border-border-brand focus-visible:border-border-brand"),children:(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)(k.Clock,{className:"h-4 w-4 text-content-brand"}),(0,r.jsx)(y.SelectValue,{placeholder:"00:00"})]})}),(0,r.jsx)(y.SelectContent,{children:D.map(e=>(0,r.jsx)(y.SelectItem,{value:e,children:e},e))})]})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("label",{className:"text-label-medium-size text-content-primary",children:"Fim"}),(0,r.jsxs)(y.Select,{value:e.endTime||"",onValueChange:e=>er(t,{endTime:e}),disabled:J,children:[(0,r.jsx)(y.SelectTrigger,{className:(0,g.cn)("h-10 w-full justify-between text-left font-normal bg-background-tertiary border-border-primary text-content-primary focus-visible:ring-offset-0 focus-visible:ring-1 focus-visible:ring-border-brand focus:border-border-brand focus-visible:border-border-brand"),children:(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)(k.Clock,{className:"h-4 w-4 text-content-brand"}),(0,r.jsx)(y.SelectValue,{placeholder:"00:00"})]})}),(0,r.jsx)(y.SelectContent,{children:D.map(e=>(0,r.jsx)(y.SelectItem,{value:e,children:e},e))})]})]})]}),(0,r.jsxs)("p",{className:"text-[11px] text-content-secondary/70",children:["Exemplo: ",(0,r.jsx)("strong",{children:"12:00"})," ","at√© ",(0,r.jsx)("strong",{children:"14:00"})," para a pausa do almo√ßo. ü•™"]})]},`${t}-${e.startTime}-${e.endTime}`))})]}),(0,r.jsxs)(o.DialogFooter,{className:"gap-2 sm:gap-3",children:[(0,r.jsx)(s.Button,{type:"submit",variant:"edit2",size:"sm",disabled:J,children:J?"Criando‚Ä¶":"Criar exce√ß√£o"}),(0,r.jsx)(s.Button,{type:"button",variant:"outline",size:"sm",onClick:ee,disabled:J,children:"Cancelar"})]})]})]})}),(0,r.jsxs)("form",{onSubmit:r=>i(e,r),className:"space-y-4",children:[(0,r.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-label-small text-content-primary",children:"Disponibilidade da unidade"}),(0,r.jsx)("p",{className:"text-paragraph-small text-content-secondary",children:"Ajuste o padr√£o semanal de atendimento desta unidade."})]}),(0,r.jsxs)("div",{className:"flex items-center justify-end gap-2",children:[(0,r.jsx)(s.Button,{type:"submit",variant:"edit2",size:"sm",disabled:u,title:u?"Corrija os hor√°rios inv√°lidos antes de salvar.":void 0,children:"Salvar padr√£o semanal"}),(0,r.jsx)(s.Button,{type:"button",variant:"destructive",size:"sm",onClick:function(){X({date:O(),mode:"INTERVALS",intervals:[{startTime:"12:00",endTime:"14:00"}]}),K(!1),G(!0)},children:"Criar exce√ß√£o"})]})]}),(0,r.jsx)("div",{className:"grid grid-cols-2 gap-3 md:grid-cols-4 lg:grid-cols-7",children:m.map(t=>{let a=P(String(t.startTime||"")),s=P(String(t.endTime||"")),i=t.isActive&&a&&s&&z(t.startTime)>=z(t.endTime);return(0,r.jsxs)("div",{className:(0,g.cn)("flex flex-col rounded-xl border px-3 py-3 text-paragraph-small-size transition-colors",t.isActive?"border-border-brand bg-background-tertiary/80":"border-border-secondary bg-background-tertiary"),children:[(0,r.jsxs)("div",{className:"mb-2 flex items-center justify-between gap-2",children:[(0,r.jsxs)("div",{className:"flex flex-col",children:[(0,r.jsx)("span",{className:"text-content-primary font-medium",children:t.short}),(0,r.jsx)("span",{className:"text-[11px] text-content-primary",children:t.full})]}),(0,r.jsx)("button",{type:"button",onClick:()=>{let r=!t.isActive;n(a=>({...a,[e]:{...a[e]||{},[t.weekday]:{...a[e]?.[t.weekday]||{isActive:!1,startTime:"",endTime:""},isActive:r}}}))},className:(0,g.cn)("inline-flex items-center rounded-full px-3 py-1 text-[11px] font-medium transition-colors",t.isActive?"bg-background-brand text-content-on-brand":"bg-background-primary text-content-secondary border border-border-secondary"),children:t.isActive?"Sim":"N√£o"})]}),(0,r.jsxs)("div",{className:"mt-auto space-y-2",children:[(0,r.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,r.jsx)("span",{className:"text-[11px] text-content-primary",children:"Das"}),(0,r.jsxs)(y.Select,{value:t.startTime||"",onValueChange:r=>{n(a=>({...a,[e]:{...a[e]||{},[t.weekday]:{...a[e]?.[t.weekday]||{isActive:!1,startTime:"",endTime:""},startTime:r}}}))},disabled:!t.isActive,children:[(0,r.jsx)(y.SelectTrigger,{className:(0,g.cn)("h-9 w-full justify-between text-left font-normal bg-background-tertiary border-border-primary text-content-primary focus-visible:ring-offset-0 focus-visible:ring-1 focus-visible:ring-border-brand focus:border-border-brand focus-visible:border-border-brand",i&&"border-destructive focus-visible:ring-destructive/40"),children:(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)(k.Clock,{className:"h-4 w-4 text-content-brand"}),(0,r.jsx)(y.SelectValue,{placeholder:"00:00"})]})}),(0,r.jsx)(y.SelectContent,{children:D.map(e=>(0,r.jsx)(y.SelectItem,{value:e,children:e},e))})]})]}),(0,r.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,r.jsx)("span",{className:"text-[11px] text-content-primary",children:"At√©"}),(0,r.jsxs)(y.Select,{value:t.endTime||"",onValueChange:r=>{n(a=>({...a,[e]:{...a[e]||{},[t.weekday]:{...a[e]?.[t.weekday]||{isActive:!1,startTime:"",endTime:""},endTime:r}}}))},disabled:!t.isActive,children:[(0,r.jsx)(y.SelectTrigger,{className:(0,g.cn)("h-9 w-full justify-between text-left font-normal bg-background-tertiary border-border-primary text-content-primary focus-visible:ring-offset-0 focus-visible:ring-1 focus-visible:ring-border-brand focus:border-border-brand focus-visible:border-border-brand",i&&"border-destructive focus-visible:ring-destructive/40"),children:(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)(k.Clock,{className:"h-4 w-4 text-content-brand"}),(0,r.jsx)(y.SelectValue,{placeholder:"00:00"})]})}),(0,r.jsx)(y.SelectContent,{children:D.map(e=>(0,r.jsx)(y.SelectItem,{value:e,children:e},e))})]})]})]}),i&&(0,r.jsx)("p",{className:"mt-2 text-[11px] text-destructive",children:"Em dias ativos, o hor√°rio inicial deve ser menor que o final."})]},t.weekday)})}),u&&(0,r.jsx)("p",{className:"text-[11px] text-destructive",children:"Existem dias ativos com hor√°rio inv√°lido (in√≠cio maior/igual ao fim)."}),(0,r.jsxs)("div",{className:"pt-4 space-y-2",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between gap-3",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-label-small text-content-primary",children:"Exce√ß√µes"}),(0,r.jsx)("p",{className:"text-[11px] text-content-secondary",children:"Pausas/bloqueios em datas espec√≠ficas."})]}),(0,r.jsx)(s.Button,{type:"button",variant:"outline",size:"sm",onClick:F,disabled:b,children:b?"Atualizando‚Ä¶":"Atualizar"})]}),f?(0,r.jsx)("div",{className:"rounded-xl border border-destructive/40 bg-destructive/5 p-4",children:(0,r.jsx)("p",{className:"text-[11px] text-destructive",children:f})}):b?(0,r.jsxs)("div",{className:"rounded-xl border border-border-primary bg-background-tertiary p-4 space-y-2",children:[(0,r.jsx)("div",{className:"h-9 w-full rounded-lg bg-background-secondary/60"}),(0,r.jsx)("div",{className:"h-9 w-full rounded-lg bg-background-secondary/60"}),(0,r.jsx)("p",{className:"text-[11px] text-content-secondary",children:"Carregando exce√ß√µes‚Ä¶"})]}):0===p.length?(0,r.jsx)("div",{className:"rounded-xl border border-border-primary bg-background-tertiary p-4",children:(0,r.jsx)("p",{className:"text-paragraph-small text-content-secondary",children:"Nenhuma exce√ß√£o cadastrada ainda."})}):(0,r.jsx)("div",{className:"space-y-2",children:p.map(e=>{let t=L===e.id,a=Array.isArray(e.intervals)?e.intervals:[];return(0,r.jsx)("div",{className:"rounded-xl border border-border-primary bg-background-tertiary p-4",children:(0,r.jsxs)("div",{className:"flex items-start justify-between gap-3",children:[(0,r.jsxs)("div",{className:"min-w-0",children:[(0,r.jsx)("p",{className:"text-paragraph-small text-content-primary font-medium",children:function(e){let[r,t,a]=e.split("-").map(Number);if(!r||!t||!a)return e;try{return new Intl.DateTimeFormat("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric"}).format(new Date(r,t-1,a))}catch{return e}}(e.date)}),e.isClosed?(0,r.jsx)("p",{className:"text-[11px] text-content-secondary mt-1",children:"Dia fechado (sem atendimento)"}):a.length?(0,r.jsx)("div",{className:"mt-1 space-y-1",children:a.map(e=>(0,r.jsxs)("p",{className:"text-[11px] text-content-secondary",children:["Pausa:"," ",(0,r.jsxs)("span",{className:"text-content-primary",children:[e.startTime," ","√†s"," ",e.endTime]})]},e.id))}):(0,r.jsx)("p",{className:"text-[11px] text-content-secondary mt-1",children:"Exce√ß√£o sem intervalos (vazia)"})]}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("span",{className:"shrink-0 rounded-full border border-border-primary px-3 py-1 text-[11px] text-content-secondary",children:"Bloqueio"}),(0,r.jsx)(s.Button,{type:"button",variant:"outline",size:"sm",disabled:t,onClick:()=>M(e.id),children:t?"Removendo‚Ä¶":"Remover"})]})]})},e.id)})})]})]})]})}let R=["Domingo","Segunda","Ter√ßa","Quarta","Quinta","Sexta","S√°bado"];function F(e){try{return new Intl.DateTimeFormat("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}).format(e)}catch{return e.toISOString()}}function L(e){return({forbidden_owner_only:"Somente o dono pode editar dados da empresa.",company_not_found:"N√£o foi poss√≠vel encontrar a empresa.",company_name_required:"Informe o nome da empresa.",invalid_json:"Erro ao enviar dados. Tente novamente.",internal_error:"Erro interno. Tente novamente.",forbidden:"Voc√™ n√£o tem permiss√£o para acessar esta √°rea."})[e]??"Algo deu errado. Tente novamente."}function U(e){return({forbidden_owner_only:"Somente o dono pode criar unidades.",unit_name_required:"Informe o nome da unidade.",invalid_json:"Erro ao enviar dados. Tente novamente.",internal_error:"Erro interno. Tente novamente.",forbidden:"Voc√™ n√£o tem permiss√£o para gerenciar unidades.",unit_not_found:"N√£o foi poss√≠vel encontrar essa unidade."})[e]??"Algo deu errado. Tente novamente."}function M(e){return({forbidden_owner_only:"Somente o dono pode criar/editar administradores.",forbidden_cannot_edit_owner:"N√£o √© poss√≠vel editar permiss√µes do dono (OWNER).",target_not_found:"N√£o foi poss√≠vel encontrar esse administrador.",target_not_admin:"Esse usu√°rio n√£o √© um administrador.",nothing_to_update:"Nenhuma altera√ß√£o foi enviada.",invalid_id:"Administrador inv√°lido.",admin_name_required:"Informe o nome do administrador.",admin_email_required:"Informe o e-mail do administrador.",admin_email_invalid:"Informe um e-mail v√°lido.",admin_phone_invalid:"Informe um telefone v√°lido.",admin_password_invalid:"A senha deve ter pelo menos 6 caracteres.",email_in_use:"Este e-mail j√° est√° em uso.",missing_unit:"Voc√™ precisa ter pelo menos 1 unidade ativa para criar administradores.",invalid_json:"Erro ao enviar dados. Tente novamente.",internal_error:"Erro interno. Tente novamente.",forbidden:"Voc√™ n√£o tem permiss√£o para acessar esta √°rea.",unauthorized:"Sua sess√£o expirou. Fa√ßa login novamente.",admin_not_found:"N√£o foi poss√≠vel encontrar esse administrador."})[e]??"Algo deu errado. Tente novamente."}function H(e){return e&&"object"==typeof e&&"ok"in e&&!1===e.ok&&"string"==typeof e.error?String(e.error):"internal_error"}function G(){return Array.from({length:7}).reduce((e,r,t)=>(e[t]=0===t?{isActive:!1,startTime:"",endTime:""}:{isActive:!0,startTime:"09:00",endTime:"18:00"},e),{})}function J(e){let r=new Date(e.createdAt),t=e.address||[e.street,e.number?`, ${e.number}`:""].join("").trim()||"‚Äî";return{id:e.id,name:e.name,phone:e.phone?.trim()?e.phone:"‚Äî",address:t||"‚Äî",isActive:!!e.isActive,createdAt:Number.isNaN(r.getTime())?new Date:r}}function Q(e){let r=new Date(e.createdAt);return{id:e.id,name:(e.name??"").trim()||"‚Äî",email:e.email,phone:(e.phone??"").trim()||"‚Äî",createdAt:Number.isNaN(r.getTime())?new Date:r,isOwner:!!e.isOwner,isActive:!!e.isActive,permissions:{canAccessDashboard:!!e.permissions?.canAccessDashboard,canAccessReports:!!e.permissions?.canAccessReports,canAccessCheckout:!!e.permissions?.canAccessCheckout,canAccessAppointments:!!e.permissions?.canAccessAppointments,canAccessProfessionals:!!e.permissions?.canAccessProfessionals,canAccessServices:!!e.permissions?.canAccessServices,canAccessReviews:!!e.permissions?.canAccessReviews,canAccessProducts:!!e.permissions?.canAccessProducts,canAccessPartners:!!e.permissions?.canAccessPartners,canAccessClients:!!e.permissions?.canAccessClients,canAccessClientLevels:!!e.permissions?.canAccessClientLevels,canAccessFinance:!!e.permissions?.canAccessFinance,canAccessSettings:!!e.permissions?.canAccessSettings}}}function Y(e){return e.replace(/\D/g,"")}function K(e){let r=Y(e).slice(0,8);return r.length<=5?r:`${r.slice(0,5)}-${r.slice(5)}`}function W(e){let r=Y(e).slice(0,11);if(0===r.length)return"";if(r.length<3)return`(${r}`;let t=r.slice(0,2),a=r.slice(2);if(r.length<=10){let e=a.slice(0,4),r=a.slice(4,8);return a.length<=4?`(${t}) ${e}`:`(${t}) ${e}-${r}`}let s=a.slice(0,5),n=a.slice(5,9);return a.length<=5?`(${t}) ${s}`:`(${t}) ${s}-${n}`}function X(e){return"string"!=typeof e?null:e.trim()||null}let Z={canAccessDashboard:"Dashboard",canAccessReports:"Relat√≥rios",canAccessCheckout:"Checkout",canAccessAppointments:"Agendamentos",canAccessProfessionals:"Profissionais",canAccessServices:"Servi√ßos",canAccessReviews:"Avalia√ß√µes",canAccessProducts:"Produtos",canAccessClients:"Clientes",canAccessClientLevels:"N√≠veis do Cliente",canAccessFinance:"Financeiro",canAccessSettings:"Configura√ß√µes"};function ee(e){return{canAccessDashboard:!!e.canAccessDashboard,canAccessReports:!!e.canAccessReports,canAccessCheckout:!!e.canAccessCheckout,canAccessAppointments:!!e.canAccessAppointments,canAccessProfessionals:!!e.canAccessProfessionals,canAccessServices:!!e.canAccessServices,canAccessReviews:!!e.canAccessReviews,canAccessProducts:!!e.canAccessProducts,canAccessPartners:!!e.canAccessPartners,canAccessClients:!!e.canAccessClients,canAccessClientLevels:!!e.canAccessClientLevels,canAccessFinance:!!e.canAccessFinance,canAccessSettings:!!e.canAccessSettings}}function er(e){let{label:t,value:a,disabled:s,onToggle:n}=e,i=a?"border-emerald-500/40 bg-emerald-500/10":"border-destructive/40 bg-destructive/10",o=s?"opacity-70 cursor-not-allowed":"cursor-pointer";return(0,r.jsxs)("button",{type:"button",onClick:s?void 0:n,disabled:s,className:`flex items-center justify-between gap-3 rounded-xl border px-3 py-2 transition select-none ${i} ${o}`,"aria-pressed":a,children:[(0,r.jsx)("span",{className:"text-[11px] text-content-secondary",children:t}),(0,r.jsx)("span",{className:`text-[11px] font-medium ${a?"text-emerald-500":"text-content-secondary"}`,children:a?"Liberado":"Bloqueado"})]})}function et(e){let{icon:t,iconClassName:a,inputClassName:s,wrapperClassName:n,disabledIcon:o,className:c,...l}=e;return(0,r.jsxs)("div",{className:`relative ${n??""}`,children:[(0,r.jsx)("div",{className:"absolute left-3 top-1/2 -translate-y-1/2 -mt-px pointer-events-none",children:(0,r.jsx)(t,{width:20,height:20,className:`${o?"text-content-secondary/50":"text-content-brand"} ${a??""}`})}),(0,r.jsx)(i.Input,{...l,className:`pl-10 ${s??""} ${c??""}`})]})}function ea(){let[e,d]=t.useState({id:"",name:"",segment:"BARBERSHOP",isActive:!0}),[g,y]=t.useState(!0),[j,N]=t.useState(!1),[A,w]=t.useState(null);t.useEffect(()=>{let e=!0,r=new AbortController;return async function(){y(!0),w(null);try{let t=await fetch("/api/admin/settings/company",{method:"GET",headers:{"Content-Type":"application/json"},signal:r.signal}),a=null;try{a=await t.json()}catch{a=null}if(!e)return;if(!t.ok||!a||!a.ok){let e=a?H(a):"internal_error";w(L(e));return}d({id:a.data.id,name:a.data.name,segment:a.data.segment,isActive:a.data.isActive})}catch(r){if(!e||r?.name==="AbortError")return;w("N√£o foi poss√≠vel carregar a empresa. Verifique sua conex√£o.")}finally{if(!e)return;y(!1)}}(),()=>{e=!1,r.abort()}},[]);let[T,C]=t.useState([]),[S,k]=t.useState(!0),[_,E]=t.useState(!1),[D,I]=t.useState({}),[$,P]=t.useState({}),[z,O]=t.useState({});t.useEffect(()=>{let e=!0,r=new AbortController;return async function(){k(!0);try{let t=await fetch("/api/admin/settings/units",{method:"GET",headers:{"Content-Type":"application/json"},signal:r.signal}),a=null;try{a=await t.json()}catch{a=null}if(!e)return;if(!t.ok||!a||!a.ok){let e=a?H(a):"internal_error",r=U(e);v.toast.error(r),C([]),I({});return}let s=a.data.reduce((e,r)=>(e[r.id]=r,e),{});I(s);let n=a.data.map(J);C(n),P(e=>{let r={...e};for(let e of n)r[e.id]||(r[e.id]=G());return r})}catch(r){if(!e||r?.name==="AbortError")return;v.toast.error("N√£o foi poss√≠vel carregar as unidades. Verifique sua conex√£o."),C([]),I({})}finally{if(!e)return;k(!1)}}(),()=>{e=!1,r.abort()}},[]);let[q,B]=t.useState([]),[ea,es]=t.useState(!0),[en,ei]=t.useState({}),[eo,ec]=t.useState({}),[el,ed]=t.useState({}),em=t.useCallback(async()=>{es(!0);try{let e=await fetch("/api/admin/settings/admins",{method:"GET",headers:{"Content-Type":"application/json"}}),r=null;try{r=await e.json()}catch{r=null}if(!e.ok||!r||!r.ok){let e=r?H(r):"internal_error";v.toast.error(M(e)),B([]);return}let t=(r.data||[]).map(Q);t.sort((e,r)=>e.isOwner!==r.isOwner?e.isOwner?-1:1:r.createdAt.getTime()-e.createdAt.getTime()),B(t),ei(e=>{let r={...e};for(let e of t)e.isOwner||(r[e.id]=ee(e.permissions));return r}),ec(e=>{let r={...e};for(let e of t)e.isOwner||(r[e.id]=!1);return r})}catch{v.toast.error("N√£o foi poss√≠vel carregar os administradores. Verifique sua conex√£o."),B([])}finally{es(!1)}},[]);async function eu(e){let r=q.find(r=>r.id===e)??null;if(!r||r.isOwner)return;let t=en[e];if(t&&eo[e]){ed(r=>({...r,[e]:!0}));try{let r=await fetch(`/api/admin/settings/admins/${e}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({permissions:t})}),a=null;try{a=await r.json()}catch{a=null}if(!r.ok||!a||!a.ok){let e=a?H(a):"internal_error";v.toast.error(M(e));return}v.toast.success("Permiss√µes salvas."),B(r=>r.map(r=>r.id===e?{...r,permissions:ee(t)}:r)),ec(r=>({...r,[e]:!1}))}catch{v.toast.error("N√£o foi poss√≠vel salvar as permiss√µes. Verifique sua conex√£o.")}finally{ed(r=>({...r,[e]:!1}))}}}t.useEffect(()=>{let e=!0,r=new AbortController;return(async()=>{try{es(!0);let t=await fetch("/api/admin/settings/admins",{method:"GET",headers:{"Content-Type":"application/json"},signal:r.signal}),a=null;try{a=await t.json()}catch{a=null}if(!e)return;if(!t.ok||!a||!a.ok){let e=a?H(a):"internal_error";v.toast.error(M(e)),B([]);return}let s=(a.data||[]).map(Q);s.sort((e,r)=>e.isOwner!==r.isOwner?e.isOwner?-1:1:r.createdAt.getTime()-e.createdAt.getTime()),B(s),ei(e=>{let r={...e};for(let e of s)e.isOwner||(r[e.id]=ee(e.permissions));return r}),ec(e=>{let r={...e};for(let e of s)e.isOwner||(r[e.id]=!1);return r})}catch(r){if(!e||r?.name==="AbortError")return;v.toast.error("N√£o foi poss√≠vel carregar os administradores. Verifique sua conex√£o."),B([])}finally{if(!e)return;es(!1)}})(),()=>{e=!1,r.abort()}},[]);let[ep,ex]=t.useState({name:"",phone:"",cep:"",number:"",complement:"",street:"",neighborhood:"",city:"",state:""}),[eb,eh]=t.useState("idle"),[ef,ev]=t.useState(null),eg=t.useRef(""),ey=t.useRef(null);t.useEffect(()=>{let e=Y(ep.cep).slice(0,8);if(e.length<8){ey.current&&ey.current.abort(),eh("idle"),ev(null),eg.current="",ex(e=>({...e,street:"",neighborhood:"",city:"",state:""}));return}eg.current!==e&&(async()=>{try{eh("loading"),ev(null),ey.current&&ey.current.abort();let r=new AbortController;ey.current=r;let t=await fetch(`https://viacep.com.br/ws/${e}/json/`,{method:"GET",headers:{"Content-Type":"application/json"},signal:r.signal}),a=await t.json();if(!t.ok)throw Error("FETCH_FAILED");if("erro"in a&&a.erro){eg.current="",eh("error"),ev("CEP n√£o encontrado."),ex(e=>({...e,street:"",neighborhood:"",city:"",state:""})),v.toast.error("CEP inv√°lido ou n√£o encontrado.");return}eg.current=e,eh("success"),ev(null),ex(e=>({...e,street:a.logradouro||"",neighborhood:a.bairro||"",city:a.localidade||"",state:a.uf||""}))}catch(e){if(e?.name==="AbortError")return;eg.current="",eh("error"),ev("N√£o foi poss√≠vel buscar o CEP. Tente novamente."),v.toast.error("N√£o foi poss√≠vel buscar o endere√ßo pelo CEP.")}})()},[ep.cep]);let[ej,eN]=t.useState(!1),[eA,ew]=t.useState(null),[eT,eC]=t.useState(!1),[eS,ek]=t.useState({name:"",phone:"",cep:"",number:"",complement:"",street:"",neighborhood:"",city:"",state:"",isActive:!0}),[e_,eE]=t.useState("idle"),[eD,eI]=t.useState(null),e$=t.useRef(""),eP=t.useRef(null);async function ez(e){if(D[e])return D[e];try{let r=await fetch(`/api/admin/settings/units/${e}`,{method:"GET",headers:{"Content-Type":"application/json"}}),t=null;try{t=await r.json()}catch{t=null}if(!r.ok||!t||!t.ok){let e=t?H(t):"internal_error";return v.toast.error(U(e)),null}return I(r=>({...r,[e]:t.data})),t.data}catch{return v.toast.error("N√£o foi poss√≠vel carregar a unidade. Verifique a conex√£o."),null}}async function eO(e){let r=await ez(e);if(!r)return void v.toast.error("N√£o foi poss√≠vel carregar os dados dessa unidade para edi√ß√£o.");let t=Y(r.cep||"").slice(0,8);e$.current=t||"",eE(8===t.length?"success":"idle"),eI(null),ew(e),ek({name:r.name||"",phone:W(r.phone||""),cep:t,number:r.number||"",complement:r.complement||"",street:r.street||"",neighborhood:r.neighborhood||"",city:r.city||"",state:r.state||"",isActive:!!r.isActive}),eN(!0)}function eq(){eN(!1),ew(null),eC(!1),eP.current&&eP.current.abort(),eE("idle"),eI(null),e$.current=""}async function eB(e){if(e.preventDefault(),!eA)return;let r=eS.name.trim();if(!r)return void v.toast.error("Informe o nome da unidade.");let t=Y(eS.phone);if(eS.phone.trim()&&t.length<10)return void v.toast.error("Informe um telefone v√°lido.");let a=Y(eS.cep).slice(0,8);if(eS.cep.trim()&&8!==a.length)return void v.toast.error("Informe um CEP v√°lido.");eC(!0);try{let e=await fetch(`/api/admin/settings/units/${eA}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:r,phone:eS.phone.trim()||null,cep:a||null,street:eS.street.trim()||null,number:eS.number.trim()||null,complement:eS.complement.trim()||null,neighborhood:eS.neighborhood.trim()||null,city:eS.city.trim()||null,state:eS.state.trim()||null,isActive:!!eS.isActive})}),t=null;try{t=await e.json()}catch{t=null}if(!e.ok||!t||!t.ok){let e=t?H(t):"internal_error";v.toast.error(U(e));return}let s=t.data;I(e=>({...e,[s.id]:s})),C(e=>e.map(e=>e.id===s.id?J(s):e)),v.toast.success("Unidade atualizada."),eq()}catch{v.toast.error("N√£o foi poss√≠vel salvar a unidade. Verifique sua conex√£o.")}finally{eC(!1)}}t.useEffect(()=>{if(!ej)return;let e=Y(eS.cep).slice(0,8);if(e.length<8){eP.current&&eP.current.abort(),eE("idle"),eI(null),e$.current="",ek(e=>({...e,street:"",neighborhood:"",city:"",state:""}));return}e$.current!==e&&(async()=>{try{eE("loading"),eI(null),eP.current&&eP.current.abort();let r=new AbortController;eP.current=r;let t=await fetch(`https://viacep.com.br/ws/${e}/json/`,{method:"GET",headers:{"Content-Type":"application/json"},signal:r.signal}),a=await t.json();if(!t.ok)throw Error("FETCH_FAILED");if("erro"in a&&a.erro){e$.current="",eE("error"),eI("CEP n√£o encontrado."),ek(e=>({...e,street:"",neighborhood:"",city:"",state:""})),v.toast.error("CEP inv√°lido ou n√£o encontrado.");return}e$.current=e,eE("success"),eI(null),ek(e=>({...e,street:a.logradouro||"",neighborhood:a.bairro||"",city:a.localidade||"",state:a.uf||""}))}catch(e){if(e?.name==="AbortError")return;e$.current="",eE("error"),eI("N√£o foi poss√≠vel buscar o CEP. Tente novamente."),v.toast.error("N√£o foi poss√≠vel buscar o endere√ßo pelo CEP.")}})()},[eS.cep,ej]);let[eV,eR]=t.useState({name:"",email:"",phone:"",password:""}),[eF,eL]=t.useState({canAccessDashboard:!0,canAccessReports:!1,canAccessCheckout:!1,canAccessAppointments:!0,canAccessProfessionals:!1,canAccessServices:!1,canAccessReviews:!1,canAccessProducts:!1,canAccessPartners:!1,canAccessClients:!0,canAccessClientLevels:!1,canAccessFinance:!1,canAccessSettings:!1}),[eU,eM]=t.useState(!1);async function eH(r){r.preventDefault(),w(null);let t=e.name.trim();if(!t)return void w("Informe o nome da empresa.");N(!0);try{let r=await fetch("/api/admin/settings/company",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:t,segment:e.segment,isActive:e.isActive})}),a=null;try{a=await r.json()}catch{a=null}if(!r.ok||!a||!a.ok){let e=a?H(a):"internal_error",r=L(e);w(r),v.toast.error(r);return}d({id:a.data.id,name:a.data.name,segment:a.data.segment,isActive:a.data.isActive}),v.toast.success("Empresa salva.")}catch{let e="N√£o foi poss√≠vel salvar. Verifique sua conex√£o.";w(e),v.toast.error(e)}finally{N(!1)}}async function eG(e){e.preventDefault();let r=ep.name.trim();if(!r)return void v.toast.error("Informe o nome da unidade.");let t=Y(ep.phone);if(ep.phone.trim()&&t.length<10)return void v.toast.error("Informe um telefone v√°lido.");let a=Y(ep.cep).slice(0,8);if(ep.cep.trim()&&8!==a.length)return void v.toast.error("Informe um CEP v√°lido.");E(!0);try{var s;let e,t,n,i,o,c,l,d,m,u,p=await fetch("/api/admin/settings/units",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:r,phone:ep.phone.trim()||null,cep:a||null,street:ep.street.trim()||null,number:ep.number.trim()||null,complement:ep.complement.trim()||null,neighborhood:ep.neighborhood.trim()||null,city:ep.city.trim()||null,state:ep.state.trim()||null,address:(s={street:ep.street,number:ep.number,complement:ep.complement,neighborhood:ep.neighborhood,city:ep.city,state:ep.state,cep:K(a)},e=[],t=X(s.street),n=X(s.number),i=X(s.neighborhood),o=X(s.city),c=X(s.state),l=X(s.cep),d=X(s.complement),(m=[t,n?`, ${n}`:""].join("").trim())&&e.push(m),d&&e.push(d),i&&e.push(i),(u=[o,c].filter(Boolean).join(" - "))&&e.push(u),l&&e.push(`CEP ${l}`),e.join(" ‚Ä¢ ")||"‚Äî")})}),x=null;try{x=await p.json()}catch{x=null}if(!p.ok||!x||!x.ok){let e=x?H(x):"internal_error",r=U(e);v.toast.error(r);return}I(e=>({...e,[x.data.id]:x.data}));let b=J(x.data);C(e=>[b,...e]),P(e=>({...e,[b.id]:e[b.id]||G()})),ex({name:"",phone:"",cep:"",number:"",complement:"",street:"",neighborhood:"",city:"",state:""}),eh("idle"),ev(null),eg.current="",v.toast.success("Unidade criada.")}catch{v.toast.error("N√£o foi poss√≠vel criar a unidade. Verifique sua conex√£o.")}finally{E(!1)}}async function eJ(e){e.preventDefault();let r=eV.name.trim(),t=eV.email.trim(),a=eV.phone.trim(),s=eV.password;if(!r)return void v.toast.error("Informe o nome do administrador.");if(!t)return void v.toast.error("Informe o e-mail do administrador.");if(!s||s.length<6)return void v.toast.error("A senha deve ter pelo menos 6 caracteres.");eM(!0);try{let e=await fetch("/api/admin/settings/admins",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:r,email:t,phone:a||null,password:s,permissions:eF})}),n=null;try{n=await e.json()}catch{n=null}if(!e.ok||!n||!n.ok){let e=n?H(n):"internal_error";v.toast.error(M(e));return}v.toast.success("Administrador criado."),eR({name:"",email:"",phone:"",password:""}),eL({canAccessDashboard:!0,canAccessReports:!1,canAccessCheckout:!1,canAccessAppointments:!0,canAccessProfessionals:!1,canAccessServices:!1,canAccessReviews:!1,canAccessProducts:!1,canAccessPartners:!1,canAccessClients:!0,canAccessClientLevels:!1,canAccessFinance:!1,canAccessSettings:!1}),await em()}catch{v.toast.error("N√£o foi poss√≠vel criar o administrador. Verifique sua conex√£o.")}finally{eM(!1)}}async function eQ(e,r){r.preventDefault();let t=$[e]??G();for(let e=0;e<7;e++){let r=t[e]??{isActive:!1,startTime:"",endTime:""};if(!r.isActive)continue;let a=String(r.startTime||"").trim(),s=String(r.endTime||"").trim();if(!a||!s)return void v.toast.error(`Informe hor\xe1rio completo em ${R[e]??`Dia ${e}`}.`);if(a>=s)return void v.toast.error(`Hor\xe1rio inv\xe1lido em ${R[e]??`Dia ${e}`}: "Das" deve ser menor que "At\xe9".`)}O(r=>({...r,[e]:!0}));try{let r={weekly:Array.from({length:7}).map((e,r)=>{let a=t[r]??{isActive:!1,startTime:"",endTime:""};return{weekday:r,isActive:!!a.isActive,startTime:String(a.startTime||"").trim()||null,endTime:String(a.endTime||"").trim()||null}})},a=await fetch(`/api/admin/settings/units/${e}/weekly`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)}),s=null;try{s=await a.json()}catch{s=null}if(!a.ok||!s||!s.ok){let e=s?H(s):"internal_error";v.toast.error(U(e));return}v.toast.success("Padr√£o semanal salvo.")}catch{v.toast.error("N√£o foi poss√≠vel salvar o padr√£o semanal.")}finally{O(r=>({...r,[e]:!1}))}}async function eY(e,r){let t=q.find(r=>r.id===e)??null;if(t){if(t.isOwner)return void v.toast.error("N√£o √© poss√≠vel alterar o status do dono.");B(t=>t.map(t=>t.id===e?{...t,isActive:r}:t));try{let a=await fetch(`/api/admin/settings/admins/${e}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({isActive:r})}),s=null;try{s=await a.json()}catch{s=null}if(!a.ok||!s||!s.ok){let r=s?H(s):"internal_error";v.toast.error(M(r)),B(r=>r.map(r=>r.id===e?{...r,isActive:t.isActive}:r));return}v.toast.success(r?"Admin ativado.":"Admin desativado."),await em()}catch{v.toast.error("N√£o foi poss√≠vel alterar o status do admin."),B(r=>r.map(r=>r.id===e?{...r,isActive:t.isActive}:r))}}}let eK=K(ep.cep),eW=K(eS.cep);return(0,r.jsxs)("div",{className:"max-w-7xl mx-auto space-y-6",children:[(0,r.jsx)(o.Dialog,{open:ej,onOpenChange:e=>e?eN(!0):eq(),children:(0,r.jsxs)(o.DialogContent,{variant:"appointment",overlayVariant:"blurred",showCloseButton:!0,className:"sm:max-w-[720px]",children:[(0,r.jsxs)(o.DialogHeader,{children:[(0,r.jsx)(o.DialogTitle,{size:"modal",children:"Editar unidade"}),(0,r.jsx)(o.DialogDescription,{size:"modal",children:"Atualize as informa√ß√µes da unidade. O endere√ßo √© preenchido pelo CEP."})]}),(0,r.jsxs)("form",{onSubmit:eB,className:"space-y-4",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("label",{className:"text-label-medium-size text-content-primary",children:"Nome da unidade"}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)(c.Building2,{className:"absolute left-3 top-1/2 -translate-y-1/2 transform text-content-brand",size:20}),(0,r.jsx)(i.Input,{placeholder:"Nome",value:eS.name,onChange:e=>ek(r=>({...r,name:e.target.value})),className:"pl-10 bg-background-tertiary border-border-primary text-content-primary hover:border-border-secondary focus:border-border-brand focus-visible:ring-1 focus-visible:ring-border-brand focus-visible:ring-offset-0"})]})]}),(0,r.jsxs)("div",{className:"grid gap-4 md:grid-cols-2",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("label",{className:"text-label-medium-size text-content-primary",children:"Telefone"}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)(l.Phone,{className:"absolute left-3 top-1/2 -translate-y-1/2 transform text-content-brand",size:20}),(0,r.jsx)(i.Input,{placeholder:"(00) 00000-0000",inputMode:"tel",value:eS.phone,onChange:e=>{let r=W(e.target.value);ek(e=>({...e,phone:r}))},className:"pl-10 bg-background-tertiary border-border-primary text-content-primary hover:border-border-secondary focus:border-border-brand focus-visible:ring-1 focus-visible:ring-border-brand focus-visible:ring-offset-0"})]})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("label",{className:"text-label-medium-size text-content-primary",children:"CEP"}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)(m,{className:"absolute left-3 top-1/2 -translate-y-1/2 transform text-content-brand",size:20}),(0,r.jsx)(i.Input,{placeholder:"00000-000",inputMode:"numeric",value:eW,onChange:e=>{let r=Y(e.target.value).slice(0,8);r!==e$.current&&(e$.current=""),ek(e=>({...e,cep:r}))},className:"pl-10 bg-background-tertiary border-border-primary text-content-primary hover:border-border-secondary focus:border-border-brand focus-visible:ring-1 focus-visible:ring-border-brand focus-visible:ring-offset-0"})]}),"loading"===e_?(0,r.jsxs)("p",{className:"text-[11px] text-content-secondary flex items-center gap-2",children:[(0,r.jsx)(p.Loader2,{className:"h-3.5 w-3.5 animate-spin"}),"Buscando endere√ßo‚Ä¶"]}):eD?(0,r.jsx)("p",{className:"text-[11px] text-destructive",children:eD}):null]})]}),(0,r.jsxs)("div",{className:"grid gap-4 md:grid-cols-3",children:[(0,r.jsxs)("div",{className:"space-y-2 md:col-span-2",children:[(0,r.jsx)("label",{className:"text-label-medium-size text-content-primary",children:"Endere√ßo"}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)(m,{className:"absolute left-3 top-1/2 -translate-y-1/2 transform text-content-brand",size:20}),(0,r.jsx)(i.Input,{placeholder:"Endere√ßo",value:eS.street,disabled:!0,className:"pl-10 bg-background-tertiary border-border-primary text-content-primary disabled:opacity-60"})]})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("label",{className:"text-label-medium-size text-content-primary",children:"N√∫mero"}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)(u,{className:"absolute left-3 top-1/2 -translate-y-1/2 transform text-content-brand",size:20}),(0,r.jsx)(i.Input,{placeholder:"N√∫mero",value:eS.number,onChange:e=>ek(r=>({...r,number:e.target.value})),className:"pl-10 bg-background-tertiary border-border-primary text-content-primary hover:border-border-secondary focus:border-border-brand focus-visible:ring-1 focus-visible:ring-border-brand focus-visible:ring-offset-0"})]})]}),(0,r.jsxs)("div",{className:"space-y-2 md:col-span-2",children:[(0,r.jsx)("label",{className:"text-label-medium-size text-content-primary",children:"Complemento"}),(0,r.jsx)(i.Input,{placeholder:"Complemento",value:eS.complement,onChange:e=>ek(r=>({...r,complement:e.target.value})),className:"bg-background-tertiary border-border-primary text-content-primary hover:border-border-secondary focus:border-border-brand focus-visible:ring-1 focus-visible:ring-border-brand focus-visible:ring-offset-0"})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("label",{className:"text-label-medium-size text-content-primary",children:"Bairro"}),(0,r.jsx)(i.Input,{placeholder:"Bairro",value:eS.neighborhood,disabled:!0,className:"bg-background-tertiary border-border-primary text-content-primary disabled:opacity-60"})]}),(0,r.jsxs)("div",{className:"space-y-2 md:col-span-2",children:[(0,r.jsx)("label",{className:"text-label-medium-size text-content-primary",children:"Cidade"}),(0,r.jsx)(i.Input,{placeholder:"Cidade",value:eS.city,disabled:!0,className:"bg-background-tertiary border-border-primary text-content-primary disabled:opacity-60"})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("label",{className:"text-label-medium-size text-content-primary",children:"Estado"}),(0,r.jsx)(i.Input,{placeholder:"Estado",value:eS.state,disabled:!0,className:"bg-background-tertiary border-border-primary text-content-primary disabled:opacity-60"})]})]}),(0,r.jsxs)(o.DialogFooter,{className:"gap-2 sm:gap-3",children:[(0,r.jsxs)(s.Button,{type:"submit",variant:"edit2",size:"sm",disabled:eT||!eS.name.trim()||"loading"===e_,children:[eT&&(0,r.jsx)(p.Loader2,{className:"mr-2 h-4 w-4 animate-spin"}),"Salvar"]}),(0,r.jsx)(s.Button,{type:"button",variant:"outline",size:"sm",onClick:eq,disabled:eT,children:"Cancelar"})]})]})]})}),(0,r.jsx)("header",{className:"flex items-center justify-between gap-4",children:(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{className:"text-title text-content-primary",children:"Configura√ß√µes"}),(0,r.jsx)("p",{className:"text-paragraph-medium text-content-secondary",children:"Gerencie unidades e controle quais administradores t√™m acesso a cada m√≥dulo do painel."})]})}),(0,r.jsxs)("section",{className:"space-y-3",children:[(0,r.jsx)("div",{className:"flex items-center justify-between gap-3",children:(0,r.jsx)("div",{children:(0,r.jsx)("h2",{className:"text-paragraph-medium font-semibold text-content-primary",children:"Empresa"})})}),(0,r.jsx)("div",{className:"grid gap-3",children:(0,r.jsx)("div",{className:"rounded-xl border border-border-primary bg-background-tertiary p-4 space-y-3",children:g?(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("div",{className:"h-10 w-full rounded-lg bg-background-secondary/60"}),(0,r.jsx)("div",{className:"h-9 w-40 rounded-lg bg-background-secondary/60 ml-auto"}),(0,r.jsx)("p",{className:"text-[11px] text-content-secondary",children:"Carregando empresa‚Ä¶"})]}):(0,r.jsxs)("form",{onSubmit:eH,className:"space-y-3",children:[(0,r.jsx)("div",{className:"space-y-1",children:(0,r.jsx)(et,{icon:c.Building2,name:"companyName",value:e.name,onChange:e=>{w(null),d(r=>({...r,name:e.target.value}))},placeholder:"Nome da empresa",className:"bg-background-secondary border-border-primary text-content-primary hover:border-border-secondary focus:border-border-brand focus-visible:ring-1 focus-visible:ring-border-brand focus-visible:ring-offset-0"})}),A&&(0,r.jsx)("div",{className:"rounded-xl border p-3 border-destructive/40 bg-destructive/5",children:(0,r.jsx)("p",{className:"text-[11px] text-destructive",children:A})}),(0,r.jsx)("div",{className:"flex items-center justify-end gap-3 flex-wrap",children:(0,r.jsx)(s.Button,{type:"submit",variant:"edit2",size:"sm",disabled:j||g||!e.name.trim(),children:j?"Salvando‚Ä¶":"Salvar empresa"})})]})})})]}),(0,r.jsxs)("section",{className:"space-y-3",children:[(0,r.jsx)("div",{className:"flex items-center justify-between gap-3",children:(0,r.jsx)("div",{children:(0,r.jsx)("h2",{className:"text-paragraph-medium font-semibold text-content-primary",children:"Unidades"})})}),(0,r.jsx)("div",{className:"rounded-xl border border-border-primary bg-background-tertiary p-4 space-y-3",children:(0,r.jsxs)("form",{onSubmit:eG,className:"space-y-3",children:[(0,r.jsxs)("div",{className:"grid gap-3 md:grid-cols-3",children:[(0,r.jsx)(et,{icon:c.Building2,placeholder:"Nome",value:ep.name,onChange:e=>ex(r=>({...r,name:e.target.value})),className:"bg-background-secondary border-border-primary text-content-primary hover:border-border-secondary focus:border-border-brand focus-visible:ring-1 focus-visible:ring-border-brand focus-visible:ring-offset-0"}),(0,r.jsx)(et,{icon:l.Phone,placeholder:"Telefone (00) 00000-0000",inputMode:"tel",value:ep.phone,onChange:e=>{let r=W(e.target.value);ex(e=>({...e,phone:r}))},className:"bg-background-secondary border-border-primary text-content-primary hover:border-border-secondary focus:border-border-brand focus-visible:ring-1 focus-visible:ring-border-brand focus-visible:ring-offset-0"}),(0,r.jsxs)("div",{className:"space-y-1",children:[(0,r.jsx)(et,{icon:m,placeholder:"CEP",inputMode:"numeric",value:eK,onChange:e=>{let r=Y(e.target.value).slice(0,8);r!==eg.current&&(eg.current=""),ex(e=>({...e,cep:r}))},className:"bg-background-secondary border-border-primary text-content-primary hover:border-border-secondary focus:border-border-brand focus-visible:ring-1 focus-visible:ring-border-brand focus-visible:ring-offset-0"}),"loading"===eb?(0,r.jsxs)("p",{className:"text-[11px] text-content-secondary flex items-center gap-2",children:[(0,r.jsx)(p.Loader2,{className:"h-3.5 w-3.5 animate-spin"}),"Buscando endere√ßo‚Ä¶"]}):ef?(0,r.jsx)("p",{className:"text-[11px] text-destructive",children:ef}):null]})]}),(0,r.jsxs)("div",{className:"grid gap-3 md:grid-cols-3",children:[(0,r.jsx)(et,{icon:m,placeholder:"Endere√ßo",value:ep.street,disabled:!0,disabledIcon:!0,className:"bg-background-secondary border-border-primary text-content-primary md:col-span-2 disabled:opacity-70"}),(0,r.jsx)(et,{icon:u,placeholder:"N√∫mero",value:ep.number,onChange:e=>ex(r=>({...r,number:e.target.value})),className:"bg-background-secondary border-border-primary text-content-primary hover:border-border-secondary focus:border-border-brand focus-visible:ring-1 focus-visible:ring-border-brand focus-visible:ring-offset-0"}),(0,r.jsx)(et,{icon:x,placeholder:"Complemento",value:ep.complement,onChange:e=>ex(r=>({...r,complement:e.target.value})),className:"bg-background-secondary border-border-primary text-content-primary hover:border-border-secondary focus:border-border-brand focus-visible:ring-1 focus-visible:ring-border-brand focus-visible:ring-offset-0"}),(0,r.jsx)(et,{icon:m,placeholder:"Bairro",value:ep.neighborhood,disabled:!0,disabledIcon:!0,className:"bg-background-secondary border-border-primary text-content-primary md:col-span-2 disabled:opacity-70"}),(0,r.jsx)(et,{icon:m,placeholder:"Cidade",value:ep.city,disabled:!0,disabledIcon:!0,className:"bg-background-secondary border-border-primary text-content-primary md:col-span-2 disabled:opacity-70"}),(0,r.jsx)(et,{icon:m,placeholder:"Estado",value:ep.state,disabled:!0,disabledIcon:!0,className:"bg-background-secondary border-border-primary text-content-primary disabled:opacity-70"})]}),(0,r.jsx)("div",{className:"flex items-center justify-end gap-3 flex-wrap",children:(0,r.jsx)(s.Button,{type:"submit",variant:"edit2",size:"sm",disabled:_||!ep.name.trim()||"loading"===eb,children:_?"Criando‚Ä¶":"Criar unidade"})})]})}),S?(0,r.jsxs)("div",{className:"rounded-xl border border-border-primary bg-background-tertiary p-5 space-y-2",children:[(0,r.jsx)("div",{className:"h-10 w-full rounded-lg bg-background-secondary/60"}),(0,r.jsx)("div",{className:"h-10 w-full rounded-lg bg-background-secondary/60"}),(0,r.jsx)("p",{className:"text-[11px] text-content-secondary",children:"Carregando unidades‚Ä¶"})]}):0===T.length?(0,r.jsxs)("div",{className:"rounded-xl border border-border-primary bg-background-tertiary p-5",children:[(0,r.jsx)("p",{className:"text-paragraph-medium text-content-primary font-semibold",children:"Voc√™ ainda n√£o tem nenhuma unidade cadastrada."}),(0,r.jsx)("p",{className:"text-paragraph-small text-content-secondary mt-1",children:"Use o formul√°rio acima para criar a primeira."})]}):(0,r.jsx)(a.Accordion,{type:"single",collapsible:!0,className:"space-y-2",children:T.map(e=>{let t=Object.values($[e.id]||{}).filter(e=>e.isActive&&e.startTime&&e.endTime).length,i=!!z[e.id];return(0,r.jsxs)(a.AccordionItem,{value:e.id,className:"border border-border-primary rounded-xl bg-background-tertiary",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between gap-4 px-4 py-3",children:[(0,r.jsxs)(a.AccordionTrigger,{className:"flex flex-1 items-center gap-6 hover:no-underline px-0 py-0",children:[(0,r.jsxs)("div",{className:"flex flex-col text-left min-w-60 flex-1",children:[(0,r.jsx)("p",{className:"text-paragraph-medium font-semibold text-content-primary",children:e.name}),(0,r.jsxs)("p",{className:"text-xs text-content-secondary truncate max-w-155",children:["Telefone:"," ",(0,r.jsx)("span",{className:"text-content-primary",children:e.phone||"‚Äî"})," ","‚Ä¢ Endere√ßo:"," ",(0,r.jsx)("span",{className:"text-content-primary",children:e.address||"‚Äî"})," ","‚Ä¢ Status:"," ",(0,r.jsx)("span",{className:"text-content-primary",children:e.isActive?"Ativa":"Inativa"})]}),(0,r.jsxs)("p",{className:"mt-1 text-[11px] text-content-secondary",children:["Criada em"," ",F(e.createdAt)]})]}),(0,r.jsxs)("div",{className:"hidden md:flex items-center gap-2",children:[(0,r.jsx)(n.Badge,{variant:"outline",children:0===t?"Sem hor√°rio":1===t?"1 dia com hor√°rio":`${t} dias com hor\xe1rio`}),(0,r.jsx)(n.Badge,{variant:"outline",children:e.isActive?"Unidade ativa":"Unidade inativa"})]})]}),(0,r.jsx)("div",{className:"pt-2",children:(0,r.jsx)(s.Button,{type:"button",variant:"edit2",size:"sm",onClick:()=>eO(e.id),children:"Editar unidade"})})]}),(0,r.jsx)(a.AccordionContent,{className:"border-t border-border-primary px-4 py-4",children:(0,r.jsx)(V,{unitId:e.id,weekly:$[e.id]??G(),setWeeklyByUnitId:P,onSubmitWeekly:(e,r)=>{if(!i)return eQ(e,r)},onCreateException:()=>alert("UI only: criar exce√ß√£o/folga")})})]},e.id)})})]}),(0,r.jsxs)("section",{className:"space-y-3",children:[(0,r.jsx)("div",{className:"flex items-center justify-between gap-3",children:(0,r.jsx)("div",{children:(0,r.jsx)("h2",{className:"text-paragraph-medium font-semibold text-content-primary",children:"Administradores"})})}),(0,r.jsx)("div",{className:"rounded-xl border border-border-primary bg-background-tertiary p-4 space-y-3",children:(0,r.jsxs)("form",{onSubmit:eJ,className:"space-y-3",children:[(0,r.jsxs)("div",{className:"grid gap-3 md:grid-cols-4",children:[(0,r.jsx)(et,{icon:b.User,placeholder:"Nome",value:eV.name,onChange:e=>eR(r=>({...r,name:e.target.value})),className:"bg-background-secondary border-border-primary text-content-primary hover:border-border-secondary focus:border-border-brand focus-visible:ring-1 focus-visible:ring-border-brand focus-visible:ring-offset-0"}),(0,r.jsx)(et,{icon:h.Mail,placeholder:"E-mail",value:eV.email,onChange:e=>eR(r=>({...r,email:e.target.value})),className:"bg-background-secondary border-border-primary text-content-primary hover:border-border-secondary focus:border-border-brand focus-visible:ring-1 focus-visible:ring-border-brand focus-visible:ring-offset-0"}),(0,r.jsx)(et,{icon:l.Phone,placeholder:"Telefone (00) 00000-0000",inputMode:"tel",value:eV.phone,onChange:e=>{let r=W(e.target.value);eR(e=>({...e,phone:r}))},className:"bg-background-secondary border-border-primary text-content-primary hover:border-border-secondary focus:border-border-brand focus-visible:ring-1 focus-visible:ring-border-brand focus-visible:ring-offset-0"}),(0,r.jsx)(et,{icon:f.KeyRound,placeholder:"Senha",type:"password",value:eV.password,onChange:e=>eR(r=>({...r,password:e.target.value})),className:"bg-background-secondary border-border-primary text-content-primary hover:border-border-secondary focus:border-border-brand focus-visible:ring-1 focus-visible:ring-border-brand focus-visible:ring-offset-0"})]}),(0,r.jsx)("div",{className:"flex items-center justify-end",children:(0,r.jsx)("p",{className:"text-[11px] text-content-secondary",children:"A senha deve ter pelo menos 6 caracteres."})}),(0,r.jsx)("div",{className:"flex items-center justify-end gap-3 flex-wrap",children:(0,r.jsx)(s.Button,{type:"submit",variant:"edit2",size:"sm",disabled:eU||!eV.name.trim()||!eV.email.trim()||eV.password.length<6,children:eU?"Criando‚Ä¶":"Criar administrador"})})]})}),ea?(0,r.jsxs)("div",{className:"rounded-xl border border-border-primary bg-background-tertiary p-5 space-y-2",children:[(0,r.jsx)("div",{className:"h-10 w-full rounded-lg bg-background-secondary/60"}),(0,r.jsx)("div",{className:"h-10 w-full rounded-lg bg-background-secondary/60"}),(0,r.jsx)("p",{className:"text-[11px] text-content-secondary",children:"Carregando administradores‚Ä¶"})]}):0===q.length?(0,r.jsxs)("div",{className:"rounded-xl border border-border-primary bg-background-tertiary p-5",children:[(0,r.jsx)("p",{className:"text-paragraph-medium text-content-primary font-semibold",children:"Nenhum administrador cadastrado ainda."}),(0,r.jsx)("p",{className:"text-paragraph-small text-content-secondary mt-1",children:"Crie um admin para delegar acessos do painel."})]}):(0,r.jsx)(a.Accordion,{type:"single",collapsible:!0,className:"space-y-2",children:q.map(e=>{let t=en[e.id]??ee(e.permissions),n=!!eo[e.id],i=!!el[e.id];return(0,r.jsxs)(a.AccordionItem,{value:e.id,className:"border border-border-primary rounded-xl bg-background-tertiary",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between gap-4 px-4 py-3",children:[(0,r.jsxs)(a.AccordionTrigger,{className:"flex flex-1 items-center gap-6 hover:no-underline px-0 py-0",children:[(0,r.jsxs)("div",{className:"flex flex-col text-left min-w-60 flex-1",children:[(0,r.jsx)("p",{className:"text-paragraph-medium font-semibold text-content-primary",children:e.name}),(0,r.jsx)("p",{className:"text-xs text-content-secondary truncate max-w-65",children:e.email||"Sem e-mail"})]}),(0,r.jsxs)("div",{className:"hidden md:flex flex-col text-left w-35",children:[(0,r.jsx)("span",{className:"text-[11px] text-content-secondary",children:"Telefone"}),(0,r.jsx)("span",{className:"text-xs text-content-primary",children:e.phone})]}),(0,r.jsxs)("div",{className:"hidden sm:flex flex-col text-left w-45",children:[(0,r.jsx)("span",{className:"text-[11px] text-content-secondary",children:"Tipo"}),(0,r.jsx)("span",{className:"text-xs text-content-primary",children:e.isOwner?"Dono (acesso total)":"Admin configur√°vel"})]})]}),!e.isOwner&&(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)(s.Button,{type:"button",variant:"edit2",size:"sm",disabled:!n||i,onClick:()=>eu(e.id),children:i?"Salvando‚Ä¶":"Salvar permiss√µes"}),(0,r.jsx)(s.Button,{type:"button",variant:e.isActive?"destructive":"active",size:"sm",onClick:()=>eY(e.id,!e.isActive),children:e.isActive?"Desativar":"Ativar"})]})]}),(0,r.jsx)(a.AccordionContent,{className:"border-t border-border-primary px-4 py-4",children:(0,r.jsxs)("div",{className:"grid gap-4 md:grid-cols-2",children:[(0,r.jsxs)("div",{className:"rounded-xl border border-border-primary bg-background-secondary p-4 space-y-2",children:[(0,r.jsx)("p",{className:"text-label-small text-content-primary",children:"Dados do admin"}),(0,r.jsxs)("div",{className:"space-y-1 text-paragraph-small",children:[(0,r.jsxs)("p",{children:[(0,r.jsxs)("span",{className:"text-content-secondary",children:["Nome:"," "]}),(0,r.jsx)("span",{className:"text-content-primary font-medium",children:e.name})]}),(0,r.jsxs)("p",{children:[(0,r.jsxs)("span",{className:"text-content-secondary",children:["E-mail:"," "]}),(0,r.jsx)("span",{className:"text-content-primary",children:e.email||"‚Äî"})]}),(0,r.jsxs)("p",{children:[(0,r.jsxs)("span",{className:"text-content-secondary",children:["Telefone:"," "]}),(0,r.jsx)("span",{className:"text-content-primary",children:e.phone})]}),(0,r.jsxs)("p",{children:[(0,r.jsxs)("span",{className:"text-content-secondary",children:["Cadastrado em:"," "]}),(0,r.jsx)("span",{className:"text-content-primary",children:F(e.createdAt)})]}),(0,r.jsxs)("p",{children:[(0,r.jsxs)("span",{className:"text-content-secondary",children:["Status:"," "]}),(0,r.jsx)("span",{className:"text-content-primary font-medium",children:e.isActive?"Ativo":"Inativo"})]})]}),!e.isOwner&&n&&(0,r.jsx)("div",{className:"mt-3 rounded-xl border border-amber-500/30 bg-amber-500/10 p-3",children:(0,r.jsxs)("p",{className:"text-[11px] text-content-secondary",children:["Voc√™ tem altera√ß√µes pendentes. Clique em"," ",(0,r.jsx)("strong",{className:"text-content-primary",children:"‚ÄúSalvar permiss√µes‚Äù"})," ","para aplicar."]})})]}),(0,r.jsxs)("div",{className:"rounded-xl border border-border-primary bg-background-secondary p-4 space-y-3",children:[(0,r.jsx)("p",{className:"text-label-small text-content-primary",children:"Permiss√µes de acesso"}),e.isOwner?(0,r.jsxs)("p",{className:"text-paragraph-small text-content-secondary",children:["Este usu√°rio √© o"," ",(0,r.jsx)("strong",{children:"dono"})," do estabelecimento e possui acesso total a todos os m√≥dulos."]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"grid gap-2 sm:grid-cols-2",children:Object.keys(Z).filter(e=>Z[e]).map(a=>(0,r.jsx)(er,{label:Z[a],value:!!t[a],disabled:i,onToggle:()=>(function(e,r){let t=q.find(r=>r.id===e)??null;if(!t||t.isOwner)return;let a=en[e]?ee(en[e]):ee(t.permissions),s={...a,[r]:!a[r]};ei(r=>({...r,[e]:s}));let n=!function(e,r){for(let t of Object.keys(Z))if(!!e[t]!=!!r[t])return!1;return!0}(s,t.permissions);ec(r=>({...r,[e]:n}))})(e.id,a)},a))}),(0,r.jsx)("p",{className:"text-[11px] text-content-secondary",children:"Clique nos boxes para liberar/bloquear. Verde = liberado, vermelho = bloqueado."})]})]})]})})]},e.id)})})]})]})}e.s(["default",()=>ea],216157)}]);