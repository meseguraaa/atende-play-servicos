module.exports=[238589,a=>{"use strict";var b=a.i(623127),c=a.i(766518),d=a.i(110329),e=a.i(975127),f=a.i(678978),g=a.i(254413),h=a.i(607957),i=a.i(709207),j=a.i(816443);a.i(960905);var k=a.i(645321);function l(a){return String(a??"").trim()}async function m({searchParams:a}){let m,n=await a;await (0,d.requirePlatformForModule)("DASHBOARD");let o=(m=l(n?.companyId))&&"all"!==m?m:null,p=function(a){let b=l(a);if(!b)return new Date;let[c,d,e]=b.split("-").map(Number);return c&&d&&e?new Date(c,d-1,e):new Date}(n?.date),q=(0,h.startOfDay)(p),r=(0,e.endOfDay)(p),s=(0,i.startOfMonth)(p),t=(0,f.endOfMonth)(p);(0,g.format)(p,"dd 'de' MMMM 'de' yyyy",{locale:j.ptBR}),(0,g.format)(p,"MMMM 'de' yyyy",{locale:j.ptBR});let u=await c.prisma.company.findMany({orderBy:[{name:"asc"},{id:"asc"}],select:{id:!0,name:!0,isActive:!0}}),v=o?{companyId:o}:void 0,[w,x]=await Promise.all([c.prisma.company.count({where:{isActive:!0}}),c.prisma.company.count({where:{isActive:!1}})]),[y,z]=await Promise.all([c.prisma.unit.count({where:{...v??{},isActive:!0}}),c.prisma.unit.count({where:{...v??{},isActive:!1}})]),[A,B]=await Promise.all([c.prisma.professional.count({where:{...v??{},isActive:!0}}),c.prisma.professional.count({where:{...v??{},isActive:!1}})]),C=await c.prisma.service.count({where:{...v??{}}}),[D,E,F]=await Promise.all([c.prisma.product.count({where:{...v??{},isActive:!0}}),c.prisma.product.count({where:{...v??{},isActive:!1}}),c.prisma.product.count({where:{...v??{},stockQuantity:{lte:0}}})]),G=o?await c.prisma.companyMember.count({where:{companyId:o,role:"CLIENT",isActive:!0}}):await c.prisma.companyMember.count({where:{role:"CLIENT",isActive:!0}}),[H,I,J,K]=await Promise.all([c.prisma.appointment.count({where:{...v??{},status:"PENDING",scheduleAt:{gte:q,lte:r}}}),c.prisma.appointment.count({where:{...v??{},status:"DONE",doneAt:{gte:q,lte:r}}}),c.prisma.appointment.count({where:{...v??{},status:"CANCELED",cancelledAt:{gte:q,lte:r}}}),c.prisma.order.count({where:{...v??{},status:"COMPLETED",updatedAt:{gte:q,lte:r}}})]),L=(await c.prisma.orderItem.aggregate({where:{...v??{},productId:{not:null},order:{status:"COMPLETED",updatedAt:{gte:q,lte:r}}},_sum:{quantity:!0}}))._sum.quantity??0,[M,N,O,P]=await Promise.all([c.prisma.appointment.count({where:{...v??{},status:"PENDING",scheduleAt:{gte:s,lte:t}}}),c.prisma.appointment.count({where:{...v??{},status:"DONE",doneAt:{gte:s,lte:t}}}),c.prisma.appointment.count({where:{...v??{},status:"CANCELED",cancelledAt:{gte:s,lte:t}}}),c.prisma.order.count({where:{...v??{},status:"COMPLETED",updatedAt:{gte:s,lte:t}}})]),Q=(await c.prisma.orderItem.aggregate({where:{...v??{},productId:{not:null},order:{status:"COMPLETED",updatedAt:{gte:s,lte:t}}},_sum:{quantity:!0}}))._sum.quantity??0,R=o?u.find(a=>a.id===o)?.name??"Empresa":"Todas as empresas";return(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)("div",{className:"flex flex-col gap-4 md:flex-row md:items-center md:justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-title text-content-primary",children:"Dashboard"}),(0,b.jsx)("p",{className:"text-paragraph-medium-size text-content-secondary",children:"Visão geral da plataforma, com filtros por empresa e evolução diária."})]}),(0,b.jsx)(k.DatePicker,{})]}),(0,b.jsx)("section",{className:"space-y-3 rounded-xl border border-border-primary bg-background-tertiary p-4",children:(0,b.jsxs)("div",{className:"flex flex-col gap-2 md:flex-row md:items-center md:justify-between",children:[(0,b.jsx)("div",{children:(0,b.jsx)("p",{className:"text-title text-content-primary",children:R})}),(0,b.jsxs)("form",{method:"GET",className:"flex w-full flex-col gap-2 md:w-auto md:flex-row md:items-center",children:[(0,b.jsx)("input",{type:"hidden",name:"date",value:(0,g.format)(p,"yyyy-MM-dd")}),(0,b.jsx)("label",{className:"sr-only",htmlFor:"companyId",children:"Empresa"}),(0,b.jsxs)("select",{id:"companyId",name:"companyId",defaultValue:o??"all",className:"h-10 w-full max-w-[200px] rounded-xl border border-border-primary bg-background-secondary px-3 text-paragraph-small text-content-primary outline-none focus:ring-2 focus:ring-border-primary md:w-[360px]",children:[(0,b.jsx)("option",{value:"all",children:"Todas as empresas"}),u.map(a=>(0,b.jsxs)("option",{value:a.id,children:[a.name,a.isActive?"":" (inativa)"]},a.id))]}),(0,b.jsx)("button",{type:"submit",className:"h-10 rounded-xl border border-border-primary bg-background-tertiary px-4 text-paragraph-small font-semibold text-content-primary hover:bg-background-secondary",children:"Aplicar"})]})]})}),(0,b.jsxs)("div",{className:"grid gap-4 md:grid-cols-2",children:[(0,b.jsxs)("section",{className:"space-y-4 rounded-xl border border-border-primary bg-background-tertiary p-4",children:[(0,b.jsx)("div",{children:(0,b.jsx)("p",{className:"text-title text-content-primary",children:"Estrutura e cadastros"})}),(0,b.jsxs)("div",{className:"grid gap-3",children:[(0,b.jsxs)("div",{className:"rounded-xl border border-border-primary bg-background-secondary p-3",children:[(0,b.jsx)("p",{className:"text-paragraph text-content-primary",children:"Empresas"}),(0,b.jsxs)("div",{className:"mt-2 space-y-2 text-paragraph-small",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsx)("span",{className:"text-content-secondary",children:"Ativas"}),(0,b.jsx)("span",{className:"font-semibold text-content-primary",children:w})]}),(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsx)("span",{className:"text-content-secondary",children:"Inativas"}),(0,b.jsx)("span",{className:"font-semibold text-content-primary",children:x})]})]})]}),(0,b.jsxs)("div",{className:"rounded-xl border border-border-primary bg-background-secondary p-3",children:[(0,b.jsx)("p",{className:"text-paragraph text-content-primary",children:"Unidades"}),(0,b.jsxs)("div",{className:"mt-2 space-y-2 text-paragraph-small",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsx)("span",{className:"text-content-secondary",children:"Ativas"}),(0,b.jsx)("span",{className:"font-semibold text-content-primary",children:y})]}),(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsx)("span",{className:"text-content-secondary",children:"Inativas"}),(0,b.jsx)("span",{className:"font-semibold text-content-primary",children:z})]})]})]}),(0,b.jsxs)("div",{className:"rounded-xl border border-border-primary bg-background-secondary p-3",children:[(0,b.jsx)("p",{className:"text-paragraph text-content-primary",children:"Profissionais"}),(0,b.jsxs)("div",{className:"mt-2 space-y-2 text-paragraph-small",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsx)("span",{className:"text-content-secondary",children:"Ativos"}),(0,b.jsx)("span",{className:"font-semibold text-content-primary",children:A})]}),(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsx)("span",{className:"text-content-secondary",children:"Inativos"}),(0,b.jsx)("span",{className:"font-semibold text-content-primary",children:B})]})]})]}),(0,b.jsxs)("div",{className:"rounded-xl border border-border-primary bg-background-secondary p-3",children:[(0,b.jsx)("p",{className:"text-paragraph text-content-primary",children:"Serviços"}),(0,b.jsxs)("div",{className:"mt-2 flex items-center justify-between text-paragraph-small",children:[(0,b.jsx)("span",{className:"text-content-secondary",children:"Quantidade"}),(0,b.jsx)("span",{className:"font-semibold text-content-primary",children:C})]})]}),(0,b.jsxs)("div",{className:"rounded-xl border border-border-primary bg-background-secondary p-3",children:[(0,b.jsx)("p",{className:"text-paragraph text-content-primary",children:"Produtos"}),(0,b.jsxs)("div",{className:"mt-2 space-y-2 text-paragraph-small",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsx)("span",{className:"text-content-secondary",children:"Ativos"}),(0,b.jsx)("span",{className:"font-semibold text-content-primary",children:D})]}),(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsx)("span",{className:"text-content-secondary",children:"Inativos"}),(0,b.jsx)("span",{className:"font-semibold text-content-primary",children:E})]}),(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsx)("span",{className:"text-content-secondary",children:"Sem estoque"}),(0,b.jsx)("span",{className:"font-semibold text-content-primary",children:F})]})]})]}),(0,b.jsxs)("div",{className:"rounded-xl border border-border-primary bg-background-secondary p-3",children:[(0,b.jsx)("p",{className:"text-paragraph text-content-primary",children:"Clientes"}),(0,b.jsxs)("div",{className:"mt-2 flex items-center justify-between text-paragraph-small",children:[(0,b.jsx)("span",{className:"text-content-secondary",children:"Cadastrados"}),(0,b.jsx)("span",{className:"font-semibold text-content-primary",children:G})]})]})]})]}),(0,b.jsxs)("section",{className:"space-y-4 rounded-xl border border-border-primary bg-background-tertiary p-4",children:[(0,b.jsx)("div",{children:(0,b.jsx)("p",{className:"text-title text-content-primary",children:"Movimento do dia"})}),(0,b.jsxs)("div",{className:"rounded-xl border border-border-primary bg-background-secondary p-4",children:[(0,b.jsx)("p",{className:"text-paragraph text-content-primary",children:"Agendamentos"}),(0,b.jsxs)("div",{className:"mt-3 grid gap-6 md:grid-cols-2",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("p",{className:"text-paragraph-small text-content-secondary",children:"Dia"}),(0,b.jsxs)("p",{className:"text-title font-semibold text-content-primary",children:["Total:"," ",(0,b.jsx)("span",{className:"font-semibold",children:H+I+J})]}),(0,b.jsxs)("div",{className:"mt-2 space-y-2 text-paragraph-small",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsx)("span",{className:"text-content-secondary",children:"Pendentes"}),(0,b.jsx)("span",{className:"font-semibold text-content-primary",children:H})]}),(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsx)("span",{className:"text-content-secondary",children:"Concluídos"}),(0,b.jsx)("span",{className:"font-semibold text-content-primary",children:I})]}),(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsx)("span",{className:"text-content-secondary",children:"Cancelados"}),(0,b.jsx)("span",{className:"font-semibold text-content-primary",children:J})]})]})]}),(0,b.jsxs)("div",{className:"space-y-2 border-t border-border-primary/60 pt-4 md:border-l md:border-t-0 md:pl-6 md:pt-0",children:[(0,b.jsx)("p",{className:"text-paragraph-small text-content-secondary",children:"Mês"}),(0,b.jsxs)("p",{className:"text-title font-semibold text-content-primary",children:["Total:"," ",(0,b.jsx)("span",{className:"font-semibold",children:M+N+O})]}),(0,b.jsxs)("div",{className:"mt-2 space-y-2 text-paragraph-small",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsx)("span",{className:"text-content-secondary",children:"Pendentes"}),(0,b.jsx)("span",{className:"font-semibold text-content-primary",children:M})]}),(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsx)("span",{className:"text-content-secondary",children:"Concluídos"}),(0,b.jsx)("span",{className:"font-semibold text-content-primary",children:N})]}),(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsx)("span",{className:"text-content-secondary",children:"Cancelados"}),(0,b.jsx)("span",{className:"font-semibold text-content-primary",children:O})]})]})]})]})]}),(0,b.jsxs)("div",{className:"rounded-xl border border-border-primary bg-background-secondary p-4",children:[(0,b.jsx)("p",{className:"text-paragraph text-content-primary",children:"Checkouts"}),(0,b.jsxs)("div",{className:"mt-3 grid gap-6 md:grid-cols-2",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("p",{className:"text-paragraph-small text-content-secondary",children:"Dia"}),(0,b.jsxs)("p",{className:"text-title font-semibold text-content-primary",children:["Concluídos:"," ",(0,b.jsx)("span",{className:"font-semibold",children:K})]})]}),(0,b.jsxs)("div",{className:"space-y-2 border-t border-border-primary/60 pt-4 md:border-l md:border-t-0 md:pl-6 md:pt-0",children:[(0,b.jsx)("p",{className:"text-paragraph-small text-content-secondary",children:"Mês"}),(0,b.jsxs)("p",{className:"text-title font-semibold text-content-primary",children:["Concluídos:"," ",(0,b.jsx)("span",{className:"font-semibold",children:P})]})]})]})]}),(0,b.jsxs)("div",{className:"rounded-xl border border-border-primary bg-background-secondary p-4",children:[(0,b.jsx)("p",{className:"text-paragraph text-content-primary",children:"Produtos"}),(0,b.jsxs)("div",{className:"mt-3 grid gap-6 md:grid-cols-2",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("p",{className:"text-paragraph-small text-content-secondary",children:"Dia"}),(0,b.jsxs)("p",{className:"text-title font-semibold text-content-primary",children:["Vendidos:"," ",(0,b.jsx)("span",{className:"font-semibold",children:L})]})]}),(0,b.jsxs)("div",{className:"space-y-2 border-t border-border-primary/60 pt-4 md:border-l md:border-t-0 md:pl-6 md:pt-0",children:[(0,b.jsx)("p",{className:"text-paragraph-small text-content-secondary",children:"Mês"}),(0,b.jsxs)("p",{className:"text-title font-semibold text-content-primary",children:["Vendidos:"," ",(0,b.jsx)("span",{className:"font-semibold",children:Q})]})]})]})]})]})]})]})}a.s(["default",()=>m,"dynamic",0,"force-dynamic","metadata",0,{title:"Plataforma | Dashboard"}])}];

//# sourceMappingURL=src_app_plataform_dashboard_page_tsx_259805b7._.js.map